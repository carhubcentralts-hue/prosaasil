# ProSaaS AI Call Center - SIP/Asterisk Configuration
# Complete environment variables for Asterisk + DID + OpenAI Realtime setup

# =============================================================================
# TELEPHONY PROVIDER SELECTION
# =============================================================================
# Options: "asterisk" or "twilio"
# Switch between providers for gradual migration
TELEPHONY_PROVIDER=asterisk

# =============================================================================
# ASTERISK CONFIGURATION
# =============================================================================

# ARI (Asterisk REST Interface) Settings
ASTERISK_ARI_URL=http://asterisk:8088/ari
ASTERISK_ARI_USER=prosaas
ASTERISK_ARI_PASSWORD=change_this_password_in_production

# SIP Trunk Name (must match pjsip.conf)
ASTERISK_SIP_TRUNK=provider

# External IP (your server's public IP address)
# Required for RTP media to work correctly through NAT
EXTERNAL_IP=1.2.3.4

# =============================================================================
# SIP TRUNK CONFIGURATION (DID Provider)
# =============================================================================
# Get these from your DID provider (DIDWW, Bandwidth, etc.)

SIP_TRUNK_HOST=sip.yourprovider.com
SIP_TRUNK_PORT=5060
SIP_TRUNK_USERNAME=your_username_here
SIP_TRUNK_PASSWORD=your_password_here
SIP_TRUNK_IP=5.6.7.8  # Provider's IP for ACL (optional)

# =============================================================================
# MEDIA GATEWAY CONFIGURATION
# =============================================================================

# Media Gateway Host (internal Docker network name)
MEDIA_GATEWAY_HOST=media-gateway

# RTP Port Configuration
RTP_PORT_START=10000
RTP_PORT_END=10100  # Adjust based on concurrent call needs

# Debug Options
DUMP_AUDIO=0  # Set to 1 to enable audio dumps for debugging

# =============================================================================
# OPENAI CONFIGURATION
# =============================================================================

OPENAI_API_KEY=sk-your-openai-api-key-here

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

DATABASE_URL=postgresql://username:password@hostname:5432/database_name

# =============================================================================
# PUBLIC URLs & HOSTING
# =============================================================================

PUBLIC_BASE_URL=https://yourdomain.com
PUBLIC_HOST=yourdomain.com

# =============================================================================
# TENANT/BUSINESS CONFIGURATION
# =============================================================================

# Default tenant ID for single-tenant setup
# All calls will be attributed to this tenant
DEFAULT_TENANT_ID=1

# =============================================================================
# RECORDING CONFIGURATION
# =============================================================================

# Recording Format
RECORDING_FORMAT=wav  # Options: wav, mp3

# S3/MinIO Upload (Optional)
# Leave blank to store recordings locally only
S3_BUCKET=
S3_REGION=us-east-1
S3_ACCESS_KEY=
S3_SECRET_KEY=
S3_ENDPOINT=  # For MinIO: http://minio:9000

# =============================================================================
# LEGACY TWILIO CONFIGURATION (Optional - for gradual migration)
# =============================================================================
# Keep these during migration period for fallback
# Remove once fully migrated to Asterisk

TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Logging
DEBUG=0  # Set to 1 for verbose logging
LOG_LEVEL=INFO  # Options: DEBUG, INFO, WARNING, ERROR

# Backend API
BACKEND_URL=http://backend:5000

# Flask Secret
SECRET_KEY=your-random-secret-key-here

# =============================================================================
# CALL LIMITS & CONCURRENCY
# =============================================================================

# Maximum concurrent calls per tenant (adjust per business in DB)
MAX_CONCURRENT_INBOUND=10
MAX_CONCURRENT_OUTBOUND=5

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Enable/disable specific features
ENABLE_TRANSCRIPTION=1
ENABLE_VOICEMAIL_DETECTION=1
ENABLE_SILENCE_DETECTION=1

# Timeouts
VOICEMAIL_DETECT_TIMEOUT=15  # seconds
SILENCE_TIMEOUT=20  # seconds

# =============================================================================
# MONITORING & METRICS
# =============================================================================

# Health check endpoints
HEALTH_CHECK_ENABLED=1

# Metrics export (optional)
METRICS_ENABLED=0
PROMETHEUS_PORT=9090

# =============================================================================
# SECURITY
# =============================================================================

# API Authentication
JWT_SECRET_KEY=your-jwt-secret-key-here

# CORS (adjust for production)
CORS_ORIGINS=*

# =============================================================================
# WHATSAPP (existing - unchanged)
# =============================================================================

FLASK_BASE_URL=http://backend:5000

# =============================================================================
# N8N (existing - unchanged)
# =============================================================================

N8N_BASE_URL=${PUBLIC_BASE_URL}/n8n/
N8N_PUBLIC_URL=${PUBLIC_BASE_URL}/n8n/

# =============================================================================
# ADDITIONAL SERVICES (existing - unchanged)
# =============================================================================

# Add any other environment variables your application needs
