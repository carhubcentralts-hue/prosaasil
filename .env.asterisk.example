# ProSaaS AI Call Center - SIP/Asterisk Configuration
# Complete environment variables for Asterisk + DID + OpenAI Realtime setup

# =============================================================================
# TELEPHONY PROVIDER SELECTION
# =============================================================================
# DEFAULT: "asterisk" (production)
# Options: "asterisk" or "twilio" (legacy fallback only)
# 
# ⚠️ IMPORTANT: System defaults to Asterisk automatically
# Set to "twilio" ONLY if you need legacy fallback during migration
TELEPHONY_PROVIDER=asterisk

# =============================================================================
# ASTERISK CONFIGURATION
# =============================================================================

# ARI (Asterisk REST Interface) Settings
ASTERISK_ARI_URL=http://asterisk:8088/ari
ASTERISK_ARI_USER=prosaas
ASTERISK_ARI_PASSWORD=your_secure_ari_password_here

# ARI Application Name (Stasis app name)
ARI_APP_NAME=prosaas_ai

# SIP Trunk Name (must match pjsip.conf endpoint name)
ASTERISK_SIP_TRUNK=didww

# External IP (your server's public IP address)
# Required for RTP media to work correctly through NAT
EXTERNAL_IP=1.2.3.4

# =============================================================================
# SIP TRUNK CONFIGURATION (DIDWW - IP-based authentication)
# =============================================================================
# DIDWW uses IP-based authentication ONLY (no username/password)
# Get these IPs from your DIDWW account

DIDWW_SIP_HOST=sip.didww.com
DIDWW_SIP_PORT=5060
# DIDWW source IPs for ACL (supports up to 3 IPs)
DIDWW_IP_1=89.105.196.76
DIDWW_IP_2=80.93.48.76
DIDWW_IP_3=89.105.205.76

# =============================================================================
# MEDIA GATEWAY CONFIGURATION
# =============================================================================

# Media Gateway Host (internal Docker network name)
MEDIA_GATEWAY_HOST=media-gateway

# RTP Port Configuration
RTP_PORT_START=10000
RTP_PORT_END=10100  # Adjust based on concurrent call needs

# Debug Options
DUMP_AUDIO=0  # Set to 1 to enable audio dumps for debugging

# =============================================================================
# OPENAI CONFIGURATION
# =============================================================================

OPENAI_API_KEY=sk-your-openai-api-key-here

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

DATABASE_URL=postgresql://username:password@hostname:5432/database_name

# =============================================================================
# PUBLIC URLs & HOSTING
# =============================================================================

PUBLIC_BASE_URL=https://yourdomain.com
PUBLIC_HOST=yourdomain.com

# =============================================================================
# TENANT/BUSINESS CONFIGURATION
# =============================================================================

# Default tenant ID for single-tenant setup
# All calls will be attributed to this tenant
DEFAULT_TENANT_ID=1

# =============================================================================
# RECORDING CONFIGURATION
# =============================================================================

# Recording Format
RECORDING_FORMAT=wav  # Options: wav, mp3

# S3/MinIO Upload (Optional)
# Leave blank to store recordings locally only
S3_BUCKET=
S3_REGION=us-east-1
S3_ACCESS_KEY=
S3_SECRET_KEY=
S3_ENDPOINT=  # For MinIO: http://minio:9000

# =============================================================================
# LEGACY TWILIO CONFIGURATION (DEPRECATED - DO NOT USE)
# =============================================================================
# ⚠️ DEPRECATED: Twilio is replaced by Asterisk
# These variables are kept ONLY for emergency fallback during migration
# DO NOT SET THESE unless explicitly required for rollback
# System will use Asterisk by default

# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

# Logging
DEBUG=0  # Set to 1 for verbose logging
LOG_LEVEL=INFO  # Options: DEBUG, INFO, WARNING, ERROR

# Backend API
BACKEND_URL=http://backend:5000

# Flask Secret
SECRET_KEY=your-random-secret-key-here

# =============================================================================
# CALL LIMITS & CONCURRENCY
# =============================================================================

# Maximum concurrent calls per tenant (adjust per business in DB)
MAX_CONCURRENT_INBOUND=10
MAX_CONCURRENT_OUTBOUND=5

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Enable/disable specific features
ENABLE_TRANSCRIPTION=1
ENABLE_VOICEMAIL_DETECTION=1
ENABLE_SILENCE_DETECTION=1

# Timeouts
VOICEMAIL_DETECT_TIMEOUT=15  # seconds
SILENCE_TIMEOUT=20  # seconds

# =============================================================================
# MONITORING & METRICS
# =============================================================================

# Health check endpoints
HEALTH_CHECK_ENABLED=1

# Metrics export (optional)
METRICS_ENABLED=0
PROMETHEUS_PORT=9090

# =============================================================================
# SECURITY
# =============================================================================

# API Authentication
JWT_SECRET_KEY=your-jwt-secret-key-here

# CORS (adjust for production)
CORS_ORIGINS=*

# =============================================================================
# WHATSAPP (existing - unchanged)
# =============================================================================

FLASK_BASE_URL=http://backend:5000

# =============================================================================
# N8N (existing - unchanged)
# =============================================================================

N8N_BASE_URL=${PUBLIC_BASE_URL}/n8n/
N8N_PUBLIC_URL=${PUBLIC_BASE_URL}/n8n/

# =============================================================================
# ADDITIONAL SERVICES (existing - unchanged)
# =============================================================================

# Add any other environment variables your application needs
