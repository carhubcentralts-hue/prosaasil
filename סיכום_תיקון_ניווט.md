# סיכום תיקון ניווט בחצים - שיחות יוצאות

## הבעיה שדווחה
ניווט בחצים (למעלה/למטה) לא עבד באופן עקבי כאשר נכנסים לפרטי ליד מעמוד 3 בלשונית "שיחות אחרונות" בדף שיחות יוצאות. לפעמים עבד מעמוד 2, לפעמים לא.

## הסיבה השורשית
השירות `leadNavigation.ts` השתמש ב-endpoint `/api/calls` כדי לשלוף נתוני ניווט כשהמשתמש הגיע מהלשונית "recent" בדף OutboundCallsPage, אבל הדף עצמו מציג נתונים מ-`/api/outbound/recent-calls`. ה-endpoints האלה מסננים באופן שונה ומחזירים תוצאות שונות, מה שגרם למערכת הניווט לכשל במציאת הליד הנוכחי ברשימה.

## הפתרון שיושם
1. **עדכון endpoint**: השירות עכשיו משתמש ב-`/api/outbound/recent-calls` - אותו endpoint שהדף מציג
2. **עדכון parsing**: התאמה לפורמט התשובה (`items` במקום `calls`)
3. **עקביות נתונים**: הניווט עכשיו רואה בדיוק את אותה רשימת לידים שהמשתמש רואה

## מה תוקן
✅ ניווט עובד באופן עקבי מכל עמוד (1, 2, 3+)
✅ חצים מזהים נכון את המיקום של הליד ברשימה
✅ סינונים נשמרים בניווט
✅ cache עובד נכון לכל עמוד

## איך לבדוק
1. עבור לדף **שיחות יוצאות** → לשונית **שיחות אחרונות**
2. עבור ל**עמוד 3** (או כל עמוד אחר)
3. לחץ על ליד לפתיחת דף פרטי הליד
4. ✅ **חצים למעלה/למטה צריכים להופיע ולעבוד**
5. לחץ על חץ חזרה
6. ✅ **צריך לחזור לעמוד 3 עם כל הסינונים**

## בדיקות נוספות מומלצות
- [ ] נווט מעמוד 1 → בדוק שחצים עובדים
- [ ] נווט מעמוד 2 → בדוק שחצים עובדים  
- [ ] נווט מעמוד 3 → בדוק שחצים עובדים
- [ ] הוסף סינון חיפוש → נווט לליד → בדוק שהחצים מתחשבים בסינון
- [ ] לחץ על החצים למעלה/למטה → בדוק שהניווט חלק
- [ ] לחץ על חץ חזרה → בדוק שחוזר לעמוד הנכון עם הסינון

## קבצים ששונו
- `client/src/services/leadNavigation.ts` - תיקון בחירת endpoint וטיפול בתשובה
- `NAVIGATION_ARROW_FIX.md` - תיעוד מפורט באנגלית

## אבטחה
✅ סריקת אבטחה (CodeQL) הושלמה: **0 פרצות אבטחה**

## מצב הפרויקט
🎯 **מוכן לבדיקה ידנית**

אנא בדוק את התיקון לפי ההנחיות למעלה ודווח אם הכל עובד כמצופה.
