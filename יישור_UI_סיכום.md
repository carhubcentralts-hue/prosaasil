# âœ… ×™×™×©×•×¨ UI - ×¡×™×›×•× ×™×™×©×•×

## ğŸ¯ ×¡×˜×˜×•×¡: ×™×™×©×•× ×”×•×©×œ×, ×××ª×™×Ÿ ×œ×‘×“×™×§×•×ª

×›×œ ×”×“×¨×™×©×•×ª ××”× ×—×™×™×ª ×”×¢×œ ×™×•×©××• ×‘×”×¦×œ×—×”.

---

## âœ… ××” ×™×•×©×

### 1ï¸âƒ£ ×”×’×“×¨×ª ××§×•×¨ ×œ×™×“ (Backend) âœ… ×”×•×©×œ×

**×§×•×‘×¥**: `server/tasks_recording.py` (×©×•×¨×” 606)

```python
# ×›×™×•×•×Ÿ × ×§×‘×¢ ×¤×¢× ××—×ª ×‘×©×™×—×” ×”×¨××©×•× ×”, ×œ×¢×•×œ× ×œ× ××©×ª× ×”
if lead.last_call_direction is None:
    lead.last_call_direction = call_direction
```

**×ª×•×¦××”**:
- âœ… ×©×™×—×” ×™×•×¦××ª â†’ ×”×œ×™×“ × ×©××¨ ×™×•×¦× ×œ× ×¦×—
- âœ… ×©×™×—×” × ×›× ×¡×ª â†’ ×”×œ×™×“ × ×©××¨ × ×›× ×¡ ×œ× ×¦×—
- âœ… ×©×™×—×•×ª ×¢×ª×™×“×™×•×ª ×œ× ××©× ×•×ª ××ª ×”××§×•×¨

---

### 2ï¸âƒ£ ×“×£ "×©×™×—×•×ª × ×›× ×¡×•×ª" âœ… ×”×•×©×œ×

**×§×•×‘×¥**: `client/src/pages/calls/InboundCallsPage.tsx`

**×©×™× ×•×™×™×**:
- âœ… Lead-centric (×œ× Call-centric)
- âœ… Kanban / List toggle
- âœ… ×©×™× ×•×™ ×¡×˜×˜×•×¡ (drag & drop ×‘Kanban)
- âœ… ×›× ×™×¡×” ×œ×“×£ ×œ×™×“
- âœ… ×‘×—×™×¨×ª ×œ×™×“×™× (multi-select)
- âœ… ×¤×™×œ×˜×¨ ×—×™×¤×•×©
- âœ… ×©×™××•×© ×‘×§×•××¤×•× × ×˜×•×ª ××©×•×ª×¤×•×ª:
  - `LeadCard`
  - `LeadKanbanView`

**API**:
```typescript
GET /api/leads?direction=inbound&page=1&pageSize=25
```

---

### 3ï¸âƒ£ ×“×£ "×©×™×—×•×ª ×™×•×¦××•×ª" âœ… ×”×•×©×œ×

**×§×•×‘×¥**: `client/src/pages/calls/OutboundCallsPage.tsx`

**×©×™× ×•×™×™×**:
- âœ… ××¦×™×’ ×¨×§ ×œ×™×“×™× ×¢× `direction=outbound`
- âœ… Kanban / List toggle (×›×‘×¨ ×”×™×”)
- âœ… ×©×™× ×•×™ ×¡×˜×˜×•×¡ (×›×‘×¨ ×”×™×”)
- âœ… ×›× ×™×¡×” ×œ×“×£ ×œ×™×“
- âœ… ×©×™××•×© ×‘-`OutboundKanbanView` (×§×•××¤×•× × ×˜×” ×™×™×¢×•×“×™×ª)
- âœ… 2 ×˜××‘×™×:
  1. **×œ×™×“×™× ×™×•×¦××™×** - ×œ×™×“×™× ×¢× ×›×™×•×•×Ÿ ×™×•×¦×
  2. **×¨×©×™××ª ×™×™×‘×•×** - × ×™×”×•×œ CSV uploads

**API**:
```typescript
GET /api/leads?direction=outbound&page=1&pageSize=100
```

---

### 4ï¸âƒ£ ×¨×©×™××•×ª ×™×™×‘×•× âœ… ××™×•×©× ×‘×“×£ ×œ×™×“×™×

**×§×•×‘×¥**: `client/src/pages/Leads/LeadsPage.tsx`

×”×“×£ ×œ×™×“×™× ×›×‘×¨ ×›×•×œ×œ:
- âœ… ×¤×™×œ×˜×¨ ×œ×¤×™ ×¨×©×™××ª ×™×™×‘×•× (`outbound_list_id`)
- âœ… ×¤×™×œ×˜×¨ ×œ×¤×™ ×›×™×•×•×Ÿ (`direction`)
- âœ… Kanban / List toggle
- âœ… ×©×™× ×•×™ ×¡×˜×˜×•×¡×™×
- âœ… ×›×œ ×”×¤×•× ×§×¦×™×•× ×œ×™×•×ª ×©×œ × ×™×”×•×œ ×œ×™×“×™×

**×©×™××•×©**:
1. ×›× ×¡ ×œ×“×£ **×œ×™×“×™×**
2. ×‘×—×¨ ×¨×©×™××ª ×™×™×‘×•× ××”×¤×™×œ×˜×¨
3. ×”×œ×™×“×™× ×××•×ª×” ×¨×©×™××” ××•×¦×’×™× ×‘××œ×•×× ×¢× ×›×œ ×”×¤×•× ×§×¦×™×•× ×œ×™×•×ª

---

### 5ï¸âƒ£ ×“×£ ×œ×™×“×™× - ×¤×™×œ×˜×¨×™× âœ… ×›×‘×¨ ×§×™×™××™×

**×§×•×‘×¥**: `client/src/pages/Leads/LeadsPage.tsx` (×©×•×¨×•×ª 413-438)

**×¤×™×œ×˜×¨×™× ×–××™× ×™×**:
- âœ… **×¡×˜×˜×•×¡** - ×›×œ ×”×¡×˜×˜×•×¡×™× ×”×“×™× ××™×™×
- âœ… **××§×•×¨** - ×˜×œ×¤×•×Ÿ / ×•×•××˜×¡××¤
- âœ… **×›×™×•×•×Ÿ** - ×”×›×œ / × ×›× ×¡×•×ª / ×™×•×¦××•×ª (×©×•×¨×•×ª 413-422)
- âœ… **×¨×©×™××ª ×™×™×‘×•×** - ×›×œ ×”×¨×©×™××•×ª (×©×•×¨×•×ª 424-438)
- âœ… **×ª××¨×™×›×™×** - ××ª××¨×™×š ×¢×“ ×ª××¨×™×š
- âœ… **×—×™×¤×•×©** - ×©× / ×˜×œ×¤×•×Ÿ

**×©×™×œ×•×‘ ×¤×™×œ×˜×¨×™×**:
```typescript
// ×“×•×’××”: ×œ×™×“×™× ×™×•×¦××™× ××¨×©×™××ª ×™×™×‘×•× ××¡×¤×¨ 5 ×‘×¡×˜×˜×•×¡ "qualified"
direction=outbound&outbound_list_id=5&status=qualified
```

---

### 6ï¸âƒ£ ××—×™×“×•×ª UX âœ… ×”×•×©×œ××”

**×§×•××¤×•× × ×˜×•×ª ××©×•×ª×¤×•×ª**:
- âœ… `LeadCard` - ×›×¨×˜×™×¡ ×œ×™×“ ××—×™×“
- âœ… `LeadKanbanView` - ×ª×¦×•×’×ª Kanban ××©×•×ª×¤×ª
- âœ… `LeadKanbanCard` - ×›×¨×˜×™×¡ ×œ×™×“ ×‘-Kanban
- âœ… `LeadKanbanColumn` - ×¢××•×“×ª ×¡×˜×˜×•×¡ ×‘-Kanban

**×“×¤×™× ××©×ª××©×™× ×‘×§×•××¤×•× × ×˜×•×ª**:
- âœ… LeadsPage - ×›×•×œ×œ ×”×›×œ
- âœ… InboundCallsPage - ××©×ª××© ×‘-LeadCard + LeadKanbanView
- âœ… OutboundCallsPage - ××©×ª××© ×‘-OutboundKanbanView (×“×•××”)

---

## ğŸ“‹ ×‘×“×™×§×•×ª × ×“×¨×©×•×ª (×œ×¤× ×™ Production)

### âœ… ×‘×“×™×§×•×ª Backend (Database)

```sql
-- 1. ×‘×“×•×§ ×©×”×¢××•×“×” ×§×™×™××ª
SELECT column_name FROM information_schema.columns 
WHERE table_name='leads' AND column_name='last_call_direction';

-- 2. ×‘×“×•×§ ×©×”××™× ×“×§×¡ ×§×™×™×
SELECT indexname FROM pg_indexes 
WHERE indexname='idx_leads_last_call_direction';

-- 3. ×‘×“×•×§ ×”×ª×¤×œ×’×•×ª ×›×™×•×•× ×™×
SELECT 
    last_call_direction,
    COUNT(*) as count
FROM leads
GROUP BY last_call_direction;
```

### âœ… ×‘×“×™×§×•×ª API

```bash
# 1. ×œ×™×“×™× ×›×œ ×”×›×™×•×•× ×™×
curl "https://domain.com/api/leads?page=1&pageSize=25"

# 2. ×¨×§ × ×›× ×¡×™×
curl "https://domain.com/api/leads?direction=inbound&page=1"

# 3. ×¨×§ ×™×•×¦××™×
curl "https://domain.com/api/leads?direction=outbound&page=1"

# 4. ×©×™×œ×•×‘: ×™×•×¦××™× ××¨×©×™××” 1
curl "https://domain.com/api/leads?direction=outbound&outbound_list_id=1"

# 5. ×”×ª×¨××•×ª (×œ× ×××•×¨ ×œ×”×ª×¨×¡×§)
curl "https://domain.com/api/notifications"
```

### âœ… ×‘×“×™×§×•×ª UI

#### ×“×£ ×œ×™×“×™× (`/app/leads`)
- [ ] ×¢××•×“ × ×˜×¢×Ÿ ×œ×œ× ×©×’×™××•×ª
- [ ] ×¡×¤×™×¨×ª ×œ×™×“×™× ××•×¦×’×ª
- [ ] ×¤×™×œ×˜×¨ ×›×™×•×•×Ÿ ×¢×•×‘×“ (×”×›×œ / × ×›× ×¡×•×ª / ×™×•×¦××•×ª)
- [ ] ×¤×™×œ×˜×¨ ×¨×©×™××ª ×™×™×‘×•× ××•×¦×’ (×× ×™×© ×¨×©×™××•×ª)
- [ ] ×©×™× ×•×™ ×¡×˜×˜×•×¡ ×¢×•×‘×“ (drag & drop + select)
- [ ] Kanban / List toggle ×¢×•×‘×“
- [ ] ×›× ×™×¡×” ×œ×“×£ ×œ×™×“ ×¢×•×‘×“×ª

#### ×“×£ ×©×™×—×•×ª × ×›× ×¡×•×ª (`/app/inbound-calls`)
- [ ] ××¦×™×’ ×¨×§ ×œ×™×“×™× ×¢× `last_call_direction=inbound`
- [ ] Kanban / List toggle ×¢×•×‘×“
- [ ] ×©×™× ×•×™ ×¡×˜×˜×•×¡ ×¢×•×‘×“
- [ ] ×›× ×™×¡×” ×œ×“×£ ×œ×™×“ ×¢×•×‘×“×ª
- [ ] ×—×™×¤×•×© ×¢×•×‘×“
- [ ] pagination ×¢×•×‘×“

#### ×“×£ ×©×™×—×•×ª ×™×•×¦××•×ª (`/app/outbound-calls`)
- [ ] ×˜××‘ "×œ×™×“×™× ×™×•×¦××™×" ××¦×™×’ ×¨×§ `direction=outbound`
- [ ] Kanban / List toggle ×¢×•×‘×“
- [ ] ×©×™× ×•×™ ×¡×˜×˜×•×¡ ×¢×•×‘×“ (drag & drop)
- [ ] ×›× ×™×¡×” ×œ×“×£ ×œ×™×“ ×¢×•×‘×“×ª
- [ ] ×—×™×¤×•×© ×¢×•×‘×“
- [ ] ×˜××‘ "×¨×©×™××ª ×™×™×‘×•×" ×¢×•×‘×“ (upload CSV)

---

## ğŸ¯ ×ª×¨×—×™×©×™ ×‘×“×™×§×” ×§×¨×™×˜×™×™×

### ×ª×¨×—×™×© 1: ×œ×™×“ × ×›× ×¡ ×¢× follow-up ×™×•×¦×
```
1. ×œ×§×•×— ××ª×§×©×¨ (×©×™×—×” × ×›× ×¡×ª) â†’ ×œ×™×“ × ×•×¦×¨
2. ×‘×“×•×§: `last_call_direction = 'inbound'`
3. ×‘×“×•×§: ×”×œ×™×“ ××•×¤×™×¢ ×‘×“×£ "×©×™×—×•×ª × ×›× ×¡×•×ª"
4. ×¢×©×” ×©×™×—×” ×™×•×¦××ª ×œ××•×ª×• ×œ×™×“
5. ×‘×“×•×§: `last_call_direction` ×¢×“×™×™×Ÿ 'inbound' â—
6. ×‘×“×•×§: ×”×œ×™×“ ×¢×“×™×™×Ÿ ×‘×“×£ "×©×™×—×•×ª × ×›× ×¡×•×ª" â—
```

### ×ª×¨×—×™×© 2: ×œ×™×“ ×™×•×¦× ×¢× callback
```
1. ×¢×©×” ×©×™×—×” ×™×•×¦××ª (××¨×©×™××ª ×™×™×‘×•×)
2. ×‘×“×•×§: `last_call_direction = 'outbound'`
3. ×‘×“×•×§: ×”×œ×™×“ ××•×¤×™×¢ ×‘×“×£ "×©×™×—×•×ª ×™×•×¦××•×ª"
4. ×”×œ×§×•×— ××ª×§×©×¨ ×—×–×¨×” (× ×›× ×¡×ª)
5. ×‘×“×•×§: `last_call_direction` ×¢×“×™×™×Ÿ 'outbound' â—
6. ×‘×“×•×§: ×”×œ×™×“ ×¢×“×™×™×Ÿ ×‘×“×£ "×©×™×—×•×ª ×™×•×¦××•×ª" â—
```

### ×ª×¨×—×™×© 3: ×©×™× ×•×™ ×¡×˜×˜×•×¡ ××›×œ ××§×•×
```
1. ×©× ×” ×¡×˜×˜×•×¡ ××“×£ "×œ×™×“×™×" â†’ âœ… ×¢×•×‘×“
2. ×©× ×” ×¡×˜×˜×•×¡ ××“×£ "×©×™×—×•×ª × ×›× ×¡×•×ª" â†’ âœ… ×¢×•×‘×“
3. ×©× ×” ×¡×˜×˜×•×¡ ××“×£ "×©×™×—×•×ª ×™×•×¦××•×ª" â†’ âœ… ×¢×•×‘×“
4. ×©× ×” ×¡×˜×˜×•×¡ ×‘-Kanban (drag & drop) â†’ âœ… ×¢×•×‘×“
5. ×‘×“×•×§ ×©×”×©×™× ×•×™ ××©×ª×§×£ ×‘×›×œ ×”×“×¤×™×
```

### ×ª×¨×—×™×© 4: ×¨×©×™××ª ×™×™×‘×•×
```
1. ×›× ×¡ ×œ×“×£ "×©×™×—×•×ª ×™×•×¦××•×ª" â†’ ×˜××‘ "×¨×©×™××ª ×™×™×‘×•×"
2. ×”×¢×œ×” CSV ×¢× ×œ×™×“×™×
3. ×›× ×¡ ×œ×“×£ "×œ×™×“×™×"
4. ×‘×—×¨ ××ª ×¨×©×™××ª ×”×™×™×‘×•× ××”×¤×™×œ×˜×¨
5. ×‘×“×•×§: ×”×œ×™×“×™× ××•×¦×’×™× ×¢× ×›×œ ×”×¤×•× ×§×¦×™×•× ×œ×™×•×ª
6. ×‘×“×•×§: ××¤×©×¨ ×œ×©× ×•×ª ×¡×˜×˜×•×¡, ×œ×¨××•×ª Kanban, ×•×›×•'
```

---

## ğŸ” ×©××œ×•×ª × ×¤×•×¦×•×ª (FAQ)

### ×©: ×œ××” ×œ×™×“ × ×›× ×¡ ×œ× ×¢×•×‘×¨ ×œ×™×•×¦× ××—×¨×™ ×©×™×—×” ×™×•×¦××ª?
**×ª**: ×–×” ×‘×“×™×•×§ ×”×ª×›× ×•×Ÿ! ×”×›×™×•×•×Ÿ ××™×™×¦×’ ××ª **×”××§×•×¨** ×©×œ ×”×œ×™×“, ×œ× ××ª ×”×©×™×—×” ×”××—×¨×•× ×”. ×œ×™×“ ×©×”×œ×§×•×— ×™×¦×¨ ×§×©×¨ ×¨××©×•×Ÿ × ×©××¨ "× ×›× ×¡" ×œ× ×¦×—.

### ×©: ××™×¤×” ×¨×•××™× ××ª ×¨×©×™××•×ª ×”×™×™×‘×•×?
**×ª**: ×™×© 2 ××§×•××•×ª:
1. **×“×£ ×œ×™×“×™×** - ×¤×™×œ×˜×¨ "×¨×©×™××•×ª ×™×™×‘×•×" (××¦×™×’ ××ª ×”×œ×™×“×™×)
2. **×“×£ ×©×™×—×•×ª ×™×•×¦××•×ª > ×¨×©×™××ª ×™×™×‘×•×** - × ×™×”×•×œ ×”-CSV (upload/delete)

### ×©: ××™×š ××©× ×™× ×¡×˜×˜×•×¡ ×œ×œ×™×“?
**×ª**: 4 ×“×¨×›×™×:
1. Drag & drop ×‘-Kanban
2. Select lead + bulk action
3. ×¤×ª×™×—×ª ×“×£ ×œ×™×“
4. API: `PATCH /api/leads/{id}/status`

### ×©: ×œ××” ×™×© 2 ×“×¤×™× × ×¤×¨×“×™× (× ×›× ×¡×•×ª/×™×•×¦××•×ª)?
**×ª**: ×›×“×™ ×©×”××©×ª××© ×™×•×›×œ ×œ×”×ª××§×“:
- **× ×›× ×¡×•×ª** = ×œ×§×•×—×•×ª ×©×™×¦×¨×• ×§×©×¨ (×—××™× ×™×•×ª×¨)
- **×™×•×¦××•×ª** = ×œ×™×“×™× ×©× ×™×¦×¨×• ××§××¤×™×™×Ÿ (×¦×¨×™×š follow-up)

---

## ğŸ“Š ×¡×™×›×•× ×˜×›× ×™

### Backend
- âœ… Migration 36 - ×”×•×¡×¤×ª `last_call_direction`
- âœ… Index ×œ×‘×™×¦×•×¢×™×
- âœ… Backfill ××”×©×™×—×” ×”×¨××©×•× ×”
- âœ… Logic - set once, never override
- âœ… Error handling - graceful degradation

### Frontend
- âœ… InboundCallsPage - lead-centric, Kanban/List
- âœ… OutboundCallsPage - filter outbound, Kanban/List
- âœ… LeadsPage - ×›×œ ×”×¤×™×œ×˜×¨×™× ×›×‘×¨ ×§×™×™××™×
- âœ… ×§×•××¤×•× × ×˜×•×ª ××©×•×ª×¤×•×ª - LeadCard, LeadKanbanView
- âœ… UI ××—×™×“ ×‘×›×œ ×”×“×¤×™×

### API
- âœ… `/api/leads?direction=inbound` - × ×›× ×¡×™×
- âœ… `/api/leads?direction=outbound` - ×™×•×¦××™×
- âœ… `/api/leads?outbound_list_id=X` - ×œ×¤×™ ×¨×©×™××”
- âœ… ×©×™×œ×•×‘ ×¤×™×œ×˜×¨×™× ×¢×•×‘×“

---

## âœ… ××•×›×Ÿ ×œ×¤×¨×™×¡×”

**×›×œ ×”×§×•×“ ××•×›×Ÿ. × ×“×¨×© ×¨×§ ×œ×”×¨×™×¥ ××ª ×”××™×’×¨×¦×™×” ×•×œ×‘×“×•×§.**

**×¤×§×•×“×” ×œ×”×¨×¦×ª ××™×’×¨×¦×™×”**:
```bash
# Docker
docker exec -it <backend-container> /app/run_migrations.sh

# ××• ×™×©×™×¨×•×ª
python -m server.db_migrate
```

**××—×¨×™ ×”××™×’×¨×¦×™×”**:
1. ××ª×—×œ backend
2. ×‘×“×•×§ API endpoints
3. ×‘×“×•×§ UI pages
4. ×”×¨×¥ ××ª ×ª×¨×—×™×©×™ ×”×‘×“×™×§×”
5. âœ… Done!
