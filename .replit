# .replit — FIXED

# כפתור Run בסביבה (אל תתקין כאן npm/baileys)
run = """
bash -lc '
  export EVENTLET_NO_GREENDNS=1
  export EVENTLET_HUB=select
  python3 -m gunicorn wsgi:app -k eventlet -w 1 -b 0.0.0.0:$PORT \
    --timeout 120 --keep-alive 75 --log-level info \
    --access-logfile - --error-logfile -
'
"""
modules = ["python-3.11"]

[deployment]
deploymentTarget = "autoscale"
build = [
  "bash", "-lc", "python3 -m pip install -U pip && pip install -r requirements.txt"
]
run = """
bash -lc '
  export EVENTLET_NO_GREENDNS=1
  export EVENTLET_HUB=select
  python3 -m gunicorn wsgi:app -k eventlet -w 1 -b 0.0.0.0:$PORT \
    --timeout 120 --keep-alive 75 --log-level info \
    --access-logfile - --error-logfile -
'
"""

# אל תקבע PORT ידנית! Replit מזריקה אותו.
[env]
PYTHONUNBUFFERED = "1"
PYTHONPATH = "."

# Nix (ה־OS) — מוסיפים Python 3.11 ו-Node 20, כדי שלא תקבל "python3: command not found"
[nix]
channel = "stable-25_05"
packages = ["ffmpeg-full", "iana-etc", "iproute2", "nettools", "nodejs_20", "openssl", "pkg-config", "postgresql_16", "python311Full", "zlib"]

# אין צורך במקטע [[ports]] בסביבת autoscale של Replit — מחק אם היה.