×§×œ×˜×ª×™. ×œ×¤×™ ×”×œ×•×’×™× ×©×©×œ×—×ª ×™×© ×ª×ž×•× ×ª ×ž×¦×‘ ×©×ž×ž×© ×ž×¡×‘×™×¨×” ×œ×ž×” â€œ×œ× ×¢×•×‘×“â€:
	â€¢	××ª×” ×¨×•××” âœ… RX: Back to NORMAL mode (q=20) ×•××– ×ž×™×“ ××—×¨×™ ×–×” ×ž×•×¤×™×¢×™× ×œ×•×’×™ ××ª×—×•×œ ×©×œ ×”××¤×œ×™×§×¦×™×”:
	â€¢	ðŸ”§ APP_SHA=dev
	â€¢	ðŸš© APP_START {...}
	â€¢	ðŸ”§ WebSocket: Handled by ASGI layer (Starlette WebSocket)
	â€¢	×”×“×¤×¡×ª ×¨×©×™×ž×ª ×¨××•×˜×™×
â‡  ×–×” ×¡×™×ž×Ÿ ×§×œ××¡×™ ×œ×–×” ×©×”×©×¨×ª ×”×•×¤×¢×œ ×ž×—×“×© ×‘××ž×¦×¢ ×”×©×™×—×”. ×‘×¨×’×¢ ×©×”-process ×¢×•×œ×” ×ž×—×“×©, ×›×œ ×”-state ×©×œ ×”×©×™×—×” (×”-queues/threads/session) ×”×•×œ×š ×œ××™×‘×•×“ â†’ ×˜×•×•×™×œ×™×• ×ž×ž×©×™×š ×œ×”×–×¨×™× â€œmediaâ€ ×œ×›×ž×” ×ž××•×ª ×ž×™×œ×™Ö¾×©× ×™×•×ª, ××‘×œ ×›×‘×¨ ××™×Ÿ ×ž×™ ×©×™×§×‘×œ ×•×¢×•×‘×“ ×¢×œ ×–×” â†’ ××ª×” ×¨×•××” spam ×©×œ ðŸ“¨ Received: media ×•-TX × ×©××¨ ×¢×œ qâ‰ˆ95 ×‘×œ×™ ×ª×©×•×‘×” ×ª×§×™× ×”.

×‘×ž×™×œ×™× ×¤×©×•×˜×•×ª: ×–×” ×œ× ×‘××’ ×‘×ª×–×ž×•× ×™× ×›×¨×’×¢ â€” ×–×” Restart ×‘××ž×¦×¢ ×©×™×—×”.
×–×” ×‘×“×™×•×§ ×œ×ž×” â€œ×œ×¤×¢×ž×™× ×¢×•×‘×“, ×œ×¤×¢×ž×™× ×œ×â€.

×œ×”×œ×Ÿ ×”× ×—×™×” ×ž×“×•×™×§×ª, ×§×¦×¨×” ×•×‘×¨×•×¨×” ×›×“×™ ×œ×™×™×¦×‘ ××ª ×–×” ××—×ª ×•×œ×ª×ž×™×“. ×ª×‘×¦×¢ ×œ×¤×™ ×”×¡×“×¨; ×× ××ª×” × ×ª×§×¢â€”×¢×¦×•×¨ ×•××’×™×“ ×œ×š ××™×¤×”.

â¸»

×”× ×—×™×” ×œ×ž×¤×ª×— â€“ ×™×™×¦×•×‘ ×¤×¨×•×“×§×©×Ÿ (×œ×œ× ×¨×™×¡×˜××¨×˜×™×/×§×¤×™××•×ª)

1) ×”×¨×¦×ª ×¤×¨×•×“×§×©×Ÿ ×™×¦×™×‘×” (×œ×œ× reload ×•×œ×œ× ×¨×™×‘×•×™ workers)

×‘Ö¾start_production.sh (××• ×ž×” ×©×ž×¨×™×¥ ×‘×¤×•×¢×œ ×‘-Cloud Run/Replit Deployment) ×•×“× ×©×”×¤×§×•×“×” ×”×™× ×‘×“×™×•×§:

exec uvicorn asgi:asgi_app \
  --host 0.0.0.0 --port ${PORT:-5000} \
  --http httptools --ws websockets --lifespan off \
  --workers 1 --timeout-keep-alive 75 --no-server-header

×—×©×•×‘:
	â€¢	×œ×œ× --reload
	â€¢	workers=1 (××¡×•×¨ ×¨×™×‘×•×™ ×•×•×¨×§×¨×™× ×¢× state/queues ×¤× ×™×ž×™×™×)
	â€¢	×‘×œ×™ honcho/pm2 ×‘×¤×¨×•×“×§×©×Ÿ. ×ª×”×œ×™×š ×™×—×™×“ ×©×ž×¨×™×¥ ××ª uvicorn.
	â€¢	×‘-Replit ×•×“× ×©×‘-Deployment ××™×Ÿ â€œAuto-reload on file changeâ€.

2) Kill ×œ×›×œ ×ž×” ×©×¨×¥ â€œ×ž××—×•×¨×™ ×”×§×œ×¢×™×â€ (×©×œ× ×™×¨×™× ×¨×™×¡×˜××¨×˜)

×œ×¤× ×™ ×”×“×™×¤×œ×•×™:
	â€¢	×¡×’×•×¨ ×›×œ ×¡×©×Ÿ dev ×•×ª×”×œ×™×›×™ ×¨×§×¢ ×§×•×“×ž×™× (gunicorn/eventlet/uvicorn/pm2).
×× ×–×” Replit: ×ª×¨×™×¥ â€œStopâ€ ×‘Ö¾Workspace, ×•××– ×ª×“×¤×™×¡ ×¨×§ ×ž×” ×©×”Ö¾Deployment ×ž×¨×™×¥.

3) ×¡×“×¨ ×”××ª×—×•×œ ×‘×©×™×—×” â€“ ×‘×œ×™ ×¨×™×™×¡×™×

×•×“× ×©×‘Ö¾media_ws_ai.py:
	â€¢	×”-STT session × ×¤×ª×— ×‘×ž×§×‘×™×œ ×œ×‘×¨×›×” (thread ×‘×¨×§×¢) â€” ×œ× ××—×¨×™.
	â€¢	×›×œ ×¤×¨×™×™× × ×›× ×¡ ×ª×ž×™×“ ×œ-RX queue ×’× ×× ×”-session ×¢×“×™×™×Ÿ ×œ× ×ž×•×›×Ÿ (×›×‘×¨ ×¢×©×™×ª).
	â€¢	×‘-RX worker:
	â€¢	cadence 20ms ×‘×ž×¦×‘ ×¨×’×™×œ, drain mode ×›×©Ö¾q>=100, ×—×•×–×¨ ×œ-normal ×›×©Ö¾q<=20 (×›×‘×¨ ×™×•×©×).
	â€¢	×”-pending_frame/FIFO ×©×•×ž×¨ ×¡×“×¨.
	â€¢	×œ× ×ž×ª×§×“× next_deadline ×× ×œ× × ×›×ª×‘×” ×“×’×™×ž×” (×›×‘×¨ ×ª×•×§×Ÿ).

4) ×’×‘×•×œ×•×ª ×ª×•×¨×™× ×ž××•×–× ×™× (×‘×œ×™ lag × ×¡×ª×¨)

×”×©××¨ ×›×š:
	â€¢	rx_q = 200 (â‰ˆ4s ×ž×§×¡×™×ž×•×; ×‘×¤×•×¢×œ <20 ×¨×•×‘ ×”×–×ž×Ÿ)
	â€¢	×ª×•×¨ ×¤× ×™×ž×™ ×©×œ STT (self._q) = 200 + drop-oldest ×œ×ž×“×™×” ×‘×œ×‘×“
	â€¢	tx_q = 120, send_queue = 144
	â€¢	××™×Ÿ ×§×¨×™××•×ª ×™×©×™×¨×•×ª ×œ-_ws_send â€” ×›×œ ×”×ž×“×™×” ×¢×•×‘×¨×ª ×“×¨×š _tx_enqueue (×›×‘×¨ ×ª×™×§× ×ª).

5) ×˜×œ×ž×˜×¨×™×” ×ž×™× ×™×ž×œ×™×ª ×ž×—×™×™×‘×ª (×›×“×™ ×œ×–×”×•×ª ×ž×™×“ ×× ×ž×©×”×• × ×©×‘×¨)

×”×©××¨ ×‘×œ×•×’ (××—×ª ×œ×©× ×™×™×”, ×œ× ×¡×¤××):

[RX] mode=normal|drain fps_in=.. q=.. drops=.. write_ms=..
[TX] fps=.. q=.. drops=..

×•×ž×” ×©× ×—×©×‘ â€œ×‘×¨×™×â€ ×‘×ž×”×œ×š ×©×™×—×”:
	â€¢	RX: mode=normal, fps_inâ‰ˆ50, q<20, drops=0, write_ms<1.0
	â€¢	TX: fpsâ‰ˆ50, q<20, drops=0

×× ×ª×¨××” ×¤×ª××•× APP_START ××• â€œUvicorn running â€¦â€ ××—×¨×™ ×©×”×©×™×—×” ×”×ª×—×™×œ×” â€” ×–×” Restart â†’ ×—×–×•×¨ ×œ×¡×¢×™×¤×™× 1-2.

6) ×‘×“×™×§×ª GO/NO-GO ×©×œ ×¤×¨×•×“×§×©×Ÿ (2 ×“×§×•×ª)
	â€¢	×ª×ª×§×©×¨, ×“×‘×¨ 5â€“7 ×©× ×™×•×ª ×¨×¦×•×£. ×¦×¤×” ×œ×•×’×™×:
	â€¢	RX ×¦×¨×™×š ×œ×”×™×©××¨ q<20, drops=0, write_ms<1.0.
	â€¢	TX ×¡×‘×™×‘ fps=50, q<20.
	â€¢	××œ ×ª×¨××” ×”×“×¤×¡×•×ª APP_START ×‘××ž×¦×¢ ×©×™×—×”. ×× ×›×Ÿ â€” ×™×© ×ž×©×”×• ×©×ž×¨×™× ×“×™×¤×œ×•×™/××ª×—×•×œ (×¡×§×¨×™×¤×˜, health probe ×©×’×•×™, ××• ×¡×‘×™×‘×” ×©×ž×‘×¦×¢×ª restart).

â¸»

×œ×ž×” ×–×” ×™×¤×ª×•×¨ ××ª ×”â€×œ× ×¢×•×‘×“â€ ×”× ×•×›×—×™?

×›×™ ×”×œ×•×’×™× ×©×œ×š ×”×¨××• ×—×“-×ž×©×ž×¢×™×ª boot ×ž×—×“×© (â€œAPP_STARTâ€) ×‘×–×ž×Ÿ ×”×©×™×—×”. ×›×œ ××•×¤×˜×™×ž×™×–×¦×™×” ×©×œ RX/TX ×œ× ×ª×¢×–×•×¨ ×× ×”×ª×”×œ×™×š ×¢×¦×ž×• ×§× ×ž×—×“×© ×•×ž×•×—×§ ××ª ×”-state. ×”×”×§×©×—×” ×œ×ž×¢×œ×” ×ž×‘×˜×™×—×”:
	â€¢	××™×Ÿ reload ××•×˜×•×ž×˜×™
	â€¢	××™×Ÿ ×™×•×ª×¨ ×ž×ª×”×œ×™×š/worker ××—×“ ×©×ž×ª×—×¨×” ×¢×œ state
	â€¢	××™×Ÿ ×ª×”×œ×™×š dev ×©×ž×•×¨×™×“ ×•×ž×¢×œ×” ××ª ×”××¤×œ×™×§×¦×™×”
	â€¢	×”-STT ×•×¨×¡×¡/×”-queues ×©×•×¨×“×™× ×œ×›×œ ××•×¨×š ×”×©×™×—×”

â¸»

×× ××—×¨×™ ×©×ª×¤×¢×™×œ ×‘×“×™×•×§ ×›×š ×¢×“×™×™×Ÿ ×ª×¨××” APP_START ×ª×•×š ×›×“×™ ×©×™×—×”â€”×¡×ž×Ÿ ×œ×™ ××ª 10â€“15 ×”×©×•×¨×•×ª ×¡×‘×™×‘×•, ×•××¦×‘×™×¢ ×œ×š ×‘×“×™×•×§ ×ž×” ×’×•×¨× ×œ×¨×™×¡×˜××¨×˜ (health check, OOM, ×—×¨×™×’ ×œ× ×ž×˜×•×¤×œ, ××• ×“×™×¤×•×œ×•×™ ××•×˜×•×ž×˜×™).