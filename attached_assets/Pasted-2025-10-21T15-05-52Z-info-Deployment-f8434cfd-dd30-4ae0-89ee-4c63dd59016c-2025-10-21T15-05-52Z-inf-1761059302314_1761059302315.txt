2025-10-21T15:05:52Z info: Deployment: f8434cfd-dd30-4ae0-89ee-4c63dd59016c
2025-10-21T15:05:52Z info: Build: 47c08400-f019-424f-8f10-8ec94706c940
2025-10-21T15:05:52Z info: Connecting to builder
2025-10-21T15:05:52Z info: Builder connected
2025-10-21T15:05:53Z info: Installing packages
2025-10-21T15:05:55Z info: Starting Build
Processing /home/runner/workspace

  Installing build dependencies: started

  Installing build dependencies: finished with status 'done'

  Getting requirements to build wheel: started

  Getting requirements to build wheel: finished with status 'done'
  Preparing metadata (pyproject.toml): started

  Preparing metadata (pyproject.toml): finished with status 'done'

Requirement already satisfied: asgiref>=3.10.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (3.10.0)

Requirement already satisfied: eventlet>=0.40.3 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (0.40.3)

Requirement already satisfied: flask>=3.1.2 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (3.1.2)

Requirement already satisfied: flask-bcrypt>=1.0.1 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (1.0.1)

Requirement already satisfied: flask-cors>=6.0.1 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (6.0.1)

Requirement already satisfied: flask-login>=0.6.3 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (0.6.3)

Requirement already satisfied: flask-seasurf>=2.0.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.0.0)

Requirement already satisfied: flask-sqlalchemy>=3.1.1 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (3.1.1)

Requirement already satisfied: google-cloud-speech>=2.33.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.33.0)

Requirement already satisfied: google-cloud-texttospeech>=2.31.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.31.0)

Requirement already satisfied: honcho>=2.0.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.0.0)

Requirement already satisfied: hypercorn>=0.17.3 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (0.17.3)

Requirement already satisfied: numpy>=2.3.4 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.3.4)

Requirement already satisfied: openai>=2.2.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.2.0)

Requirement already satisfied: psycopg2-binary>=2.9.10 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.9.10)

Requirement already satisfied: pyjwt>=2.10.1 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.10.1)

Requirement already satisfied: reportlab>=4.4.4 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (4.4.4)

Requirement already satisfied: requests>=2.32.5 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.32.5)

Requirement already satisfied: scipy>=1.16.2 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (1.16.2)

Requirement already satisfied: sqlalchemy>=2.0.43 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (2.0.43)

Requirement already satisfied: starlette>=0.48.0 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (0.48.0)

Requirement already satisfied: twilio>=9.8.3 in ./.pythonlibs/lib/python3.11/site-packages (from repl-nix-workspace==0.1.0) (9.8.3)

Requirement already satisfied: uvicorn>=0.37.0 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (0.37.0)

Requirement already satisfied: dnspython>=1.15.0 in ./.pythonlibs/lib/python3.11/site-packages (from eventlet>=0.40.3->repl-nix-workspace==0.1.0) (2.8.0)

Requirement already satisfied: greenlet>=1.0 in ./.pythonlibs/lib/python3.11/site-packages (from eventlet>=0.40.3->repl-nix-workspace==0.1.0) (3.2.4)

Requirement already satisfied: blinker>=1.9.0 in ./.pythonlibs/lib/python3.11/site-packages (from flask>=3.1.2->repl-nix-workspace==0.1.0) (1.9.0)

Requirement already satisfied: click>=8.1.3 in ./.pythonlibs/lib/python3.11/site-packages (from flask>=3.1.2->repl-nix-workspace==0.1.0) (8.3.0)

Requirement already satisfied: itsdangerous>=2.2.0 in ./.pythonlibs/lib/python3.11/site-packages (from flask>=3.1.2->repl-nix-workspace==0.1.0) (2.2.0)

Requirement already satisfied: jinja2>=3.1.2 in ./.pythonlibs/lib/python3.11/site-packages (from flask>=3.1.2->repl-nix-workspace==0.1.0) (3.1.6)

Requirement already satisfied: markupsafe>=2.1.1 in ./.pythonlibs/lib/python3.11/site-packages (from flask>=3.1.2->repl-nix-workspace==0.1.0) (3.0.3)

Requirement already satisfied: werkzeug>=3.1.0 in ./.pythonlibs/lib/python3.11/site-packages (from flask>=3.1.2->repl-nix-workspace==0.1.0) (3.1.3)

Requirement already satisfied: bcrypt>=3.1.1 in ./.pythonlibs/lib/python3.11/site-packages (from flask-bcrypt>=1.0.1->repl-nix-workspace==0.1.0) (5.0.0)

Requirement already satisfied: google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0,>=1.34.1 in ./.pythonlibs/lib/python3.11/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0,>=1.34.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (2.25.2)

Requirement already satisfied: google-auth!=2.24.0,!=2.25.0,<3.0.0,>=2.14.1 in ./.pythonlibs/lib/python3.11/site-packages (from google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (2.41.1)

Requirement already satisfied: proto-plus<2.0.0,>=1.22.3 in ./.pythonlibs/lib/python3.11/site-packages (from google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (1.26.1)

Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<7.0.0,>=3.20.2 in ./.pythonlibs/lib/python3.11/site-packages (from google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (6.32.1)

Requirement already satisfied: h11 in ./.pythonlibs/lib/python3.11/site-packages (from hypercorn>=0.17.3->repl-nix-workspace==0.1.0) (0.16.0)

Requirement already satisfied: h2>=3.1.0 in ./.pythonlibs/lib/python3.11/site-packages (from hypercorn>=0.17.3->repl-nix-workspace==0.1.0) (4.3.0)

Requirement already satisfied: priority in ./.pythonlibs/lib/python3.11/site-packages (from hypercorn>=0.17.3->repl-nix-workspace==0.1.0) (2.0.0)

Requirement already satisfied: wsproto>=0.14.0 in ./.pythonlibs/lib/python3.11/site-packages (from hypercorn>=0.17.3->repl-nix-workspace==0.1.0) (1.2.0)

Requirement already satisfied: anyio<5,>=3.5.0 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (4.11.0)

Requirement already satisfied: distro<2,>=1.7.0 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (1.9.0)

Requirement already satisfied: httpx<1,>=0.23.0 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (0.28.1)

Requirement already satisfied: jiter<1,>=0.4.0 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (0.11.0)

Requirement already satisfied: pydantic<3,>=1.9.0 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (2.12.0)

Requirement already satisfied: sniffio in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (1.3.1)

Requirement already satisfied: tqdm>4 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (4.67.1)

Requirement already satisfied: typing-extensions<5,>=4.11 in ./.pythonlibs/lib/python3.11/site-packages (from openai>=2.2.0->repl-nix-workspace==0.1.0) (4.15.0)

Requirement already satisfied: pillow>=9.0.0 in ./.pythonlibs/lib/python3.11/site-packages (from reportlab>=4.4.4->repl-nix-workspace==0.1.0) (12.0.0)

Requirement already satisfied: charset-normalizer in ./.pythonlibs/lib/python3.11/site-packages (from reportlab>=4.4.4->repl-nix-workspace==0.1.0) (3.4.3)

Requirement already satisfied: idna<4,>=2.5 in ./.pythonlibs/lib/python3.11/site-packages (from requests>=2.32.5->repl-nix-workspace==0.1.0) (3.10)

Requirement already satisfied: urllib3<3,>=1.21.1 in ./.pythonlibs/lib/python3.11/site-packages (from requests>=2.32.5->repl-nix-workspace==0.1.0) (2.5.0)

Requirement already satisfied: certifi>=2017.4.17 in ./.pythonlibs/lib/python3.11/site-packages (from requests>=2.32.5->repl-nix-workspace==0.1.0) (2025.10.5)

Requirement already satisfied: aiohttp>=3.8.4 in ./.pythonlibs/lib/python3.11/site-packages (from twilio>=9.8.3->repl-nix-workspace==0.1.0) (3.13.0)

Requirement already satisfied: aiohttp-retry>=2.8.3 in ./.pythonlibs/lib/python3.11/site-packages (from twilio>=9.8.3->repl-nix-workspace==0.1.0) (2.9.1)

Requirement already satisfied: httptools>=0.6.3 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (0.6.4)

Requirement already satisfied: python-dotenv>=0.13 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (1.1.1)

Requirement already satisfied: pyyaml>=5.1 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (6.0.3)

Requirement already satisfied: uvloop>=0.15.1 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (0.21.0)

Requirement already satisfied: watchfiles>=0.13 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (1.1.0)

Requirement already satisfied: websockets>=10.4 in ./.pythonlibs/lib/python3.11/site-packages (from uvicorn[standard]>=0.37.0->repl-nix-workspace==0.1.0) (15.0.1)

Requirement already satisfied: aiohappyeyeballs>=2.5.0 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (2.6.1)

Requirement already satisfied: aiosignal>=1.4.0 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (1.4.0)

Requirement already satisfied: attrs>=17.3.0 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (25.4.0)

Requirement already satisfied: frozenlist>=1.1.1 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (1.8.0)

Requirement already satisfied: multidict<7.0,>=4.5 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (6.7.0)

Requirement already satisfied: propcache>=0.2.0 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (0.4.1)

Requirement already satisfied: yarl<2.0,>=1.17.0 in ./.pythonlibs/lib/python3.11/site-packages (from aiohttp>=3.8.4->twilio>=9.8.3->repl-nix-workspace==0.1.0) (1.22.0)

Requirement already satisfied: googleapis-common-protos<2.0.0,>=1.56.2 in ./.pythonlibs/lib/python3.11/site-packages (from google-api-core!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0,>=1.34.1->google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0,>=1.34.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (1.70.0)

Requirement already satisfied: grpcio<2.0.0,>=1.33.2 in ./.pythonlibs/lib/python3.11/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0,>=1.34.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (1.75.1)

Requirement already satisfied: grpcio-status<2.0.0,>=1.33.2 in ./.pythonlibs/lib/python3.11/site-packages (from google-api-core[grpc]!=2.0.*,!=2.1.*,!=2.10.*,!=2.2.*,!=2.3.*,!=2.4.*,!=2.5.*,!=2.6.*,!=2.7.*,!=2.8.*,!=2.9.*,<3.0.0,>=1.34.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (1.75.1)

Requirement already satisfied: cachetools<7.0,>=2.0.0 in ./.pythonlibs/lib/python3.11/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0,>=2.14.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (6.2.0)

Requirement already satisfied: pyasn1-modules>=0.2.1 in ./.pythonlibs/lib/python3.11/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0,>=2.14.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (0.4.2)

Requirement already satisfied: rsa<5,>=3.1.4 in ./.pythonlibs/lib/python3.11/site-packages (from google-auth!=2.24.0,!=2.25.0,<3.0.0,>=2.14.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (4.9.1)

Requirement already satisfied: hyperframe<7,>=6.1 in ./.pythonlibs/lib/python3.11/site-packages (from h2>=3.1.0->hypercorn>=0.17.3->repl-nix-workspace==0.1.0) (6.1.0)

Requirement already satisfied: hpack<5,>=4.1 in ./.pythonlibs/lib/python3.11/site-packages (from h2>=3.1.0->hypercorn>=0.17.3->repl-nix-workspace==0.1.0) (4.1.0)

Requirement already satisfied: httpcore==1.* in ./.pythonlibs/lib/python3.11/site-packages (from httpx<1,>=0.23.0->openai>=2.2.0->repl-nix-workspace==0.1.0) (1.0.9)

Requirement already satisfied: annotated-types>=0.6.0 in ./.pythonlibs/lib/python3.11/site-packages (from pydantic<3,>=1.9.0->openai>=2.2.0->repl-nix-workspace==0.1.0) (0.7.0)

Requirement already satisfied: pydantic-core==2.41.1 in ./.pythonlibs/lib/python3.11/site-packages (from pydantic<3,>=1.9.0->openai>=2.2.0->repl-nix-workspace==0.1.0) (2.41.1)

Requirement already satisfied: typing-inspection>=0.4.2 in ./.pythonlibs/lib/python3.11/site-packages (from pydantic<3,>=1.9.0->openai>=2.2.0->repl-nix-workspace==0.1.0) (0.4.2)

Requirement already satisfied: pyasn1<0.7.0,>=0.6.1 in ./.pythonlibs/lib/python3.11/site-packages (from pyasn1-modules>=0.2.1->google-auth!=2.24.0,!=2.25.0,<3.0.0,>=2.14.1->google-cloud-speech>=2.33.0->repl-nix-workspace==0.1.0) (0.6.1)

Building wheels for collected packages: repl-nix-workspace

  Building wheel for repl-nix-workspace (pyproject.toml): started

  Building wheel for repl-nix-workspace (pyproject.toml): finished with status 'done'

  Created wheel for repl-nix-workspace: filename=repl_nix_workspace-0.1.0-py3-none-any.whl size=250090 sha256=66684c3ddc1cf0db2f8361487875f25e072daddd1b96b01b0dafc3a204b6b45d

  Stored in directory: /tmp/pip-ephem-wheel-cache-82kp6f00/wheels/04/05/6d/6289e959a92f3fb9b01ed64d788583b61a8281676ba07f42bc

Successfully built repl-nix-workspace

Installing collected packages: repl-nix-workspace

Successfully installed repl-nix-workspace-0.1.0

2025-10-21T15:06:14Z info: Pushing pid1 binary layer...
2025-10-21T15:06:15Z info: Created pid1 binary layer
2025-10-21T15:06:20Z info: Pushing hosting layer...
2025-10-21T15:06:20Z info: Pushing Repl layer...
2025-10-21T15:06:20Z info: Retrieved cached nix layer
2025-10-21T15:06:20Z info: Created hosting layer
2025-10-21T15:07:07Z info: Created Repl layer
2025-10-21T15:07:07Z info: Pushing Repl (cache) layer...
2025-10-21T15:07:08Z info: Created Repl (cache) layer
2025-10-21T15:07:09Z info: Pushed image manifest
2025-10-21T15:07:11Z info: Pushed soci index manifest
2025-10-21T15:07:14Z info: Creating Autoscale service
üöÄ Starting AgentLocator Production System - Build #103
‚úÖ Frontend build found - skipping rebuild
forwarding local port 5000 to external port 80 (mapped as 1104)
‚úÖ Build 92: WhatsApp Conversation Memory Fix - 10 Messages Full Context!
‚úÖ Node modules already installed
starting up user application
üìä EXTERNAL: Flask on 0.0.0.0:5000
‚úÖ Baileys is ready! (PID: 21, 127.0.0.1:3300)
‚úÖ BUILD 90 Uvicorn/ASGI started (PID: 35)
üìä EXTERNAL Access: Port 5000 (exposed)
üîç Checking frontend build...
üìä INTERNAL: Baileys on 127.0.0.1:3300
‚úÖ Build 94: WhatsApp Professional UI - AI Summaries & Lazy Loading!
üéØ Both services running. System ready!
‚úÖ Build 93: WhatsApp Automatic Appointment Creation - Calendar Integration!
‚è≥ Waiting for Baileys to start (max 15s)...
‚úÖ INTERNAL_SECRET found in environment
üü° Starting BUILD 90 with Uvicorn ASGI on EXTERNAL port 0.0.0.0:5000...
üìù Logs: /tmp/baileys_prod.log
üü° Starting Baileys on INTERNAL port 127.0.0.1:3300...
üü° Installing Node dependencies for Baileys...
üìä INTERNAL Baileys: 127.0.0.1:3300 (not exposed)
.
.
‚úÖ Build 91: Multi-tenant WhatsApp - Business Routing
‚úÖ GCP credentials file created in ASGI: /tmp/gcp_credentials.json
üîë PIDs saved - Baileys: 21 | Flask: 35
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt/history
  {'PUT', 'OPTIONS'} /api/statuses/<int:status_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/auth/current
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt
üîç Final status check...
================================================================================
üîç ALL REGISTERED ROUTES:
üîß GCP credentials loaded from file path: /tmp/gcp_credentials.json...
üîß APP_SHA=dev
  {'OPTIONS', 'POST'} /api/business/<tenant>/prompts
üîß FE_DIST=/home/runner/workspace/server/../client/dist
üö© APP_START {'build': 87, 'sha': 'dev', 'fe': 'client/dist', 'time': '2025-10-21 15:08:00', 'app': 'AgentLocator-Complete', 'commit': 'dev', 'startup_ts': 1761059280}
  {'GET', 'OPTIONS', 'HEAD'} /api/statuses
  {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt

‚úÖ Auth blueprints registered
üìû /ws/twilio-media ‚Üí ASGI WebSocket (asgi.py)
üîß WebSocket: Handled by ASGI layer (Starlette WebSocket)
  {'OPTIONS', 'POST'} /api/auth/forgot
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/success
================================================================================
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/revenue
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/business/<int:business_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads/<thread_id>/summary
  {'OPTIONS', 'POST'} /api/auth/login
  {'OPTIONS', 'POST'} /api/admin/user
  {'PUT', 'OPTIONS'} /api/business/current/prompt
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls
  {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders/<int:reminder_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/businesses
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/overview
  {'DELETE', 'OPTIONS'} /api/leads/<int:lead_id>
  {'OPTIONS', 'POST'} /api/admin/business
  {'GET', 'OPTIONS', 'HEAD'} /api/auth/csrf
  {'PUT', 'GET', 'OPTIONS', 'HEAD'} /api/admin/support/prompt
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/history
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments
  {'GET', 'OPTIONS', 'HEAD'} /<path:filename>
  {'OPTIONS', 'POST'} /api/admin/statuses/initialize/<int:business_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/business/current
  {'OPTIONS', 'POST'} /api/whatsapp/start
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads/stats
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/tasks
  {'OPTIONS', 'POST'} /webhook/stream_status
  {'OPTIONS', 'POST'} /api/leads
  {'OPTIONS', 'POST'} /api/auth/reset
  {'GET', 'OPTIONS', 'HEAD'} /api/auth/me

  {'OPTIONS', 'POST'} /api/contracts
  {'OPTIONS', 'POST'} /api/whatsapp/disconnect
  {'OPTIONS', 'POST'} /api/crm/payments/create
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads
‚úÖ All services confirmed running and ready!
‚úÖ Startup complete - keeping processes alive...
  {'OPTIONS', 'POST'} /api/statuses/reorder

üîß DB_DRIVER: postgresql
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/tenants
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/invoices/<invoice_number>
  {'OPTIONS', 'POST'} /api/whatsapp/reset
üöÄ ASGI BUILD 87 LOADING - DUPLICATE CALL_SID FIX
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/success

  {'OPTIONS', 'POST'} /api/admin/channels/
  {'GET', 'OPTIONS', 'HEAD'} /api/calls


  {'OPTIONS', 'POST'} /api/crm/deals
  {'GET', 'OPTIONS', 'HEAD'} /ui/biz/users/new
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/stats
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads
  {'OPTIONS', 'POST'} /api/admin/impersonate/exit

  {'OPTIONS', 'POST'} /webhook/stream_ended
  {'PUT', 'OPTIONS'} /api/admin/businesses/<int:business_id>/prompt
  {'GET', 'OPTIONS', 'HEAD'} /api/contracts
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/contracts
  {'GET', 'OPTIONS', 'HEAD'} /biz/invoices
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses
  {'PUT', 'GET', 'OPTIONS', 'HEAD'} /api/admin/support/phones
  {'OPTIONS', 'POST'} /api/auth/logout

  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/activities
‚úÖ WhatsApp routes removed - using unified only
  {'OPTIONS', 'POST'} /api/admin/tenants
  {'GET', 'OPTIONS', 'HEAD'} /ui/biz/contacts/new
  {'OPTIONS', 'POST'} /api/calendar/appointments
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/customers
  {'OPTIONS', 'POST'} /api/leads/<int:lead_id>/message/whatsapp
  {'OPTIONS', 'POST'} /api/crm/contracts/sign
  {'GET', 'OPTIONS', 'HEAD'} /ui/whatsapp/threads
  {'OPTIONS', 'POST'} /api/whatsapp/prompts/<int:business_id>
  {'PUT', 'OPTIONS'} /api/calls/<call_sid>/transcript

  {'PUT', 'OPTIONS'} /api/business/current/settings
  {'GET', 'OPTIONS', 'HEAD'} /webhook/test_media_streams_1756667590
  {'GET', 'OPTIONS', 'HEAD'} /db-check
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads/<thread_id>/messages
  {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments/<int:appointment_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/calls
‚úÖ WebSocket test route added: /test-websocket-version
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/deals
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/download
  {'OPTIONS', 'POST'} /api/admin/businesses/<int:business_id>/impersonate
  {'GET', 'OPTIONS', 'HEAD'} /ui/whatsapp/messages

  {'OPTIONS', 'POST'} /api/crm/tasks

üîß WebSocket routes removed from Flask - handled by wsgi.py composite
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/fail
  {'PUT', 'OPTIONS'} /api/admin/user/<int:user_id>
  {'GET', 'OPTIONS', 'HEAD'} /ui/admin/switch_business
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/active
  {'GET', 'OPTIONS', 'HEAD'} /app/biz
  {'GET', 'OPTIONS', 'HEAD'} /version
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/user/<int:user_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/support/profile
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/messages
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/overview
  {'PUT', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/phone-numbers
  {'OPTIONS', 'POST'} /api/reminders
  {'GET', 'OPTIONS', 'HEAD'} /api/leads
  {'GET', 'OPTIONS', 'HEAD'} /api/reminders/due
  {'GET', 'OPTIONS', 'HEAD'} /api/receipts
  {'OPTIONS', 'POST'} /webhook/incoming_call
  {'OPTIONS', 'POST'} /api/crm/contracts
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/status
  {'DELETE', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id>
  {'OPTIONS', 'POST'} /api/admin/user/<int:user_id>/change-password


  {'GET', 'OPTIONS', 'POST', 'HEAD'} /api/ui/logout
  {'OPTIONS', 'POST'} /admin/impersonate/<int:business_id>

  {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/view
  {'GET', 'OPTIONS', 'HEAD'} /api/search


  {'DELETE', 'OPTIONS'} /api/crm/tasks/<int:task_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/calendar/stats
  {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/activity
  {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/stats
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls
  {'OPTIONS', 'POST'} /api/leads/<int:lead_id>/status


  {'GET', 'OPTIONS', 'HEAD'} /ui/admin/users/new
  {'GET', 'OPTIONS', 'HEAD'} /webhook/incoming_call_preview
  {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>
  {'OPTIONS', 'POST'} /api/whatsapp/send
  {'OPTIONS', 'POST'} /api/admin/user/<int:user_id>/toggle-status
  {'OPTIONS', 'POST'} /api/leads/<int:lead_id>/reminders
  {'PATCH', 'OPTIONS'} /api/leads/bulk

  {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/view
  {'GET', 'OPTIONS', 'HEAD'} /ui/admin/tenants/new

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/prompts
‚úÖ Factory debug route registered: /debug-factory-http

  {'PUT', 'OPTIONS'} /api/admin/business/<int:business_id>
  {'OPTIONS', 'POST'} /webhook/whatsapp/incoming
  {'OPTIONS', 'POST'} /webhook/voice
  {'OPTIONS', 'POST'} /api/receipts

  {'DELETE', 'OPTIONS'} /api/admin/channels/<int:channel_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>
  {'OPTIONS', 'POST'} /api/calls/cleanup
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/channels/business/<int:business_id>

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/channels/businesses

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/stats
  {'DELETE', 'OPTIONS'} /api/reminders/<int:reminder_id>

  {'DELETE', 'OPTIONS'} /api/admin/business/<int:business_id>
  {'OPTIONS', 'POST'} /api/statuses


  {'GET', 'OPTIONS', 'HEAD'} /healthz
  {'GET', 'OPTIONS', 'POST', 'HEAD'} /webhook/test
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders
  {'GET', 'OPTIONS', 'HEAD'} /api/contracts/<int:contract_id>
  {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/reminders/<int:reminder_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/download
  {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/move
  {'OPTIONS', 'POST'} /webhook/handle_recording
  {'GET', 'OPTIONS', 'HEAD'} /unauthorized
  {'OPTIONS', 'POST'} /api/biz/users
üÜò Emergency healthz-direct route added
‚úÖ Legacy proxy routes: 0 /api/wa-proxy/* endpoints
  {'OPTIONS', 'POST'} /webhook/call_status
‚úÖ Health routes handled by health_endpoints.py blueprint
  {'PATCH', 'OPTIONS'} /api/reminders/<int:reminder_id>
  {'GET', 'OPTIONS', 'HEAD'} /readyz
  {'OPTIONS', 'POST'} /admin/stop-impersonate
  {'GET', 'OPTIONS', 'HEAD'} /ui/calls/history
  {'OPTIONS', 'POST'} /webhook/whatsapp/status

  {'OPTIONS', 'POST'} /api/crm/contacts
  {'OPTIONS', 'POST'} /api/ui/login
  {'GET', 'OPTIONS', 'HEAD'} /ui/calls/active
  {'OPTIONS', 'POST'} /api/admin/users
  {'OPTIONS', 'POST'} /api/admin/business/<int:business_id>/change-password

üîç Route registration complete


  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/contacts
  {'GET', 'OPTIONS', 'HEAD'} /api/reminders
  {'GET', 'OPTIONS', 'HEAD'} /livez

‚úÖ Baileys proxy routes: 0 /wa/* endpoints
  {'GET', 'OPTIONS', 'HEAD'} /app/admin
  {'OPTIONS', 'POST'} /ui/whatsapp/send

  {'GET', 'OPTIONS', 'HEAD'} /ui/admin/overview

  {'GET', 'OPTIONS', 'HEAD'} /test-websocket-version
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/overview
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/qr
  {'GET', 'OPTIONS', 'HEAD'} /ui/biz/contacts
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/conversation/<phone_number>
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/stats
  {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/customers
  {'GET', 'OPTIONS', 'POST', 'HEAD'} /warmup
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/cancel
  {'OPTIONS', 'POST'} /api/whatsapp/webhook/incoming
  {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/stats
  {'GET', 'OPTIONS', 'HEAD'} /ui/admin/users
  {'GET', 'OPTIONS', 'HEAD'} /ui/admin/tenants

  {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/details
  {'GET', 'OPTIONS', 'HEAD'} /biz/contracts
  {'GET', 'OPTIONS', 'HEAD'} /ui/biz/users
FE_DIST = /home/runner/workspace/client/dist mtime = 1761054178.0
üí° Press Ctrl+C to stop all services
  {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt/history
  {'DELETE', 'OPTIONS'} /api/statuses/<int:status_id>
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp


  {'OPTIONS', 'POST'} /api/leads/bulk-delete
  {'OPTIONS', 'POST'} /api/contracts/<int:contract_id>/sign
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/channels/
‚úÖ /healthz route added directly to app_factory
  {'PUT', 'OPTIONS'} /api/crm/tasks/<int:task_id>

  {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/download
  {'GET', 'OPTIONS', 'HEAD'} /logout
2025-10-21T15:08:08Z info: Waiting for service to be ready
‚úÖ Lead statuses exist: 7 statuses found
üè¢ Business ID: 1
üìß Admin login: admin@admin.com / admin123
‚úÖ Admin user exists: admin@admin.com (ID: 2)
üî• Service warmup initiated
üîß Starting database initialization...
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/overview -> admin_bp.get_business_overview
‚úÖ Business exists: ◊©◊ô ◊ì◊ô◊®◊ï◊™ (ID: 1)
=== URL MAP ===
‚úÖ Database migrations applied successfully

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/businesses -> admin_bp.api_kpis_businesses
  {'PUT', 'OPTIONS'} /api/admin/business/<int:business_id> -> business_management.update_business

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses -> admin_bp.api_admin_businesses
  {'DELETE', 'OPTIONS'} /api/admin/business/<int:business_id> -> business_management.delete_business
  {'OPTIONS', 'POST'} /api/admin/user -> business_management.create_user
  {'OPTIONS', 'POST'} /api/admin/businesses/<int:business_id>/impersonate -> business_management.impersonate_business
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt/history -> ai_prompt.get_prompt_history
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/channels/business/<int:business_id> -> admin_channels.get_business_channels
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt -> ai_prompt.get_business_prompt

  {'GET', 'OPTIONS', 'HEAD'} /api/crm/tasks -> crm_bp.get_crm_tasks

  {'DELETE', 'OPTIONS'} /api/admin/channels/<int:channel_id> -> admin_channels.remove_channel
‚úÖ Database initialization completed successfully!
  {'OPTIONS', 'POST'} /api/admin/user/<int:user_id>/change-password -> business_management.change_user_password
  {'GET', 'OPTIONS', 'HEAD'} /api/business/current -> business_management.get_current_business
‚úÖ Production database initialized successfully
  {'OPTIONS', 'POST'} /api/admin/business -> business_management.create_business

  {'OPTIONS', 'POST'} /admin/impersonate/<int:business_id> -> ui.admin_impersonate_business

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/overview -> admin_bp.api_admin_kpis_overview
  {'OPTIONS', 'POST'} /api/admin/users -> ui.api_admin_users_create

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/support/profile -> admin_bp.admin_support_profile
  {'OPTIONS', 'POST'} /api/admin/channels/ -> admin_channels.create_channel
  {'OPTIONS', 'POST'} /api/auth/logout -> auth_api.logout
  {'DELETE', 'OPTIONS'} /api/leads/<int:lead_id> -> leads_bp.delete_lead
  {'OPTIONS', 'POST'} /api/admin/statuses/initialize/<int:business_id> -> status_management.initialize_default_statuses
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/active -> crm_bp.api_active_calls
  {'OPTIONS', 'POST'} /api/auth/reset -> auth_api.reset_password
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls -> admin_bp.api_kpis_calls
  {'GET', 'OPTIONS', 'HEAD'} /api/contracts/<int:contract_id> -> receipts_contracts.get_contract
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/channels/businesses -> admin_channels.get_businesses
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/fail -> crm_bp.tranzila_fail
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/stats -> api_adapter.admin_stats
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/channels/ -> admin_channels.get_all_channels
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/prompts -> admin_bp.admin_businesses_prompts
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/contracts -> crm_bp.get_contracts
  {'PUT', 'OPTIONS'} /api/admin/businesses/<int:business_id>/prompt -> ai_prompt.update_business_prompt
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/overview -> admin_bp.api_overview
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/business/<int:business_id> -> business_management.get_business
  {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/move -> leads_bp.move_lead_in_kanban
  {'OPTIONS', 'POST'} /api/admin/run-migrations -> run_migrations_endpoint
  {'OPTIONS', 'POST'} /api/contracts -> receipts_contracts.create_contract
  {'GET', 'OPTIONS', 'HEAD'} /api/auth/me -> auth_api.get_current_user
  {'OPTIONS', 'POST'} /api/admin/impersonate/exit -> business_management.exit_impersonation

  {'GET', 'OPTIONS', 'HEAD'} /api/auth/current -> auth_api.get_current_user_legacy
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp -> admin_bp.api_admin_kpis_whatsapp

  {'GET', 'OPTIONS', 'HEAD'} /api/calendar/stats -> calendar.get_calendar_stats

  {'GET', 'OPTIONS', 'HEAD'} /api/auth/csrf -> auth_api.get_csrf
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/phone-numbers -> admin_bp.admin_phone_numbers
  {'OPTIONS', 'POST'} /api/business/<tenant>/prompts -> ai_prompt.save_prompt


================================================================================
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp -> admin_bp.api_kpis_whatsapp
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads/<thread_id>/messages -> crm_bp.api_thread_messages

  {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id> -> leads_bp.update_lead
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/contacts -> whatsapp.api_wa_contacts
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/calls -> admin_bp.api_admin_calls
  {'GET', 'OPTIONS', 'HEAD'} /api/contracts -> receipts_contracts.list_contracts
  {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/view -> receipts_contracts.view_invoice
  {'OPTIONS', 'POST'} /api/statuses -> status_management.create_status
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/revenue -> admin_bp.api_kpis_revenue


  {'GET', 'OPTIONS', 'HEAD'} /api/crm/deals -> crm_bp.list_deals
  {'OPTIONS', 'POST'} /api/admin/tenants -> ui.api_admin_tenants_create
  {'OPTIONS', 'POST'} /api/admin/business/<int:business_id>/change-password -> business_management.change_business_password


  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/messages -> whatsapp.api_wa_messages

================
INFO:     Uvicorn running on http://0.0.0.0:5000 (Press CTRL+C to quit)
  {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments -> calendar.get_appointments
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/tenants -> admin_bp.api_tenants

  {'PUT', 'OPTIONS'} /api/calls/<call_sid>/transcript -> calls.update_transcript
  {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/view -> receipts_contracts.view_contract
  {'OPTIONS', 'POST'} /api/whatsapp/disconnect -> whatsapp.disconnect
  {'OPTIONS', 'POST'} /api/crm/contracts/sign -> crm_bp.contract_sign
  {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/download -> receipts_contracts.download_invoice
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/status -> whatsapp.status
  {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/customers -> intelligence.get_intelligent_customers
  {'PUT', 'GET', 'OPTIONS', 'HEAD'} /api/admin/support/prompt -> admin_bp.admin_support_prompt
  {'OPTIONS', 'POST'} /api/leads/<int:lead_id>/reminders -> leads_bp.create_reminder
  {'GET', 'OPTIONS', 'HEAD'} /api/calls -> calls.list_calls
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads -> admin_bp.admin_leads

  {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt -> ai_prompt.get_current_business_prompt


  {'OPTIONS', 'POST'} /api/whatsapp/start -> whatsapp.start
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/download -> calls.download_recording
  {'DELETE', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id> -> calendar.delete_appointment
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses -> api_adapter.admin_businesses

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/user/<int:user_id> -> business_management.get_user
  {'OPTIONS', 'POST'} /api/crm/contacts -> ui.api_crm_contacts_create

  {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt/history -> ai_prompt.get_current_prompt_history
  {'OPTIONS', 'POST'} /api/reminders -> leads_bp.create_general_reminder
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/stats -> calls.get_calls_stats
  {'OPTIONS', 'POST'} /api/receipts -> receipts_contracts.create_receipt
  {'DELETE', 'OPTIONS'} /api/crm/tasks/<int:task_id> -> crm_bp.delete_crm_task
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments -> crm_bp.get_payments
  {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments/<int:appointment_id> -> calendar.get_appointment

  {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads/stats -> admin_bp.admin_leads_stats
  {'OPTIONS', 'POST'} /api/crm/tasks -> crm_bp.create_crm_task
  {'OPTIONS', 'POST'} /api/crm/payments/create -> crm_bp.payments_create
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders -> leads_bp.get_lead_reminders
  {'GET', 'OPTIONS', 'HEAD'} /api/search -> crm_bp.global_search

  {'GET', 'OPTIONS', 'HEAD'} /api/crm/invoices/<invoice_number> -> crm_bp.get_invoice

  {'PUT', 'OPTIONS'} /api/admin/user/<int:user_id> -> business_management.update_user
  {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls -> admin_bp.api_admin_kpis_calls
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id> -> leads_bp.get_lead_detail
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/stats -> whatsapp.api_wa_stats
  {'OPTIONS', 'POST'} /api/auth/login -> auth_api.login
  {'PATCH', 'OPTIONS'} /api/reminders/<int:reminder_id> -> leads_bp.update_general_reminder
  {'OPTIONS', 'POST'} /api/contracts/<int:contract_id>/sign -> receipts_contracts.sign_contract
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads/<thread_id>/summary -> crm_bp.api_thread_summary
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/qr -> whatsapp.qr
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/success -> crm_bp.tranzila_success
  {'OPTIONS', 'POST'} /api/whatsapp/send -> whatsapp.send_manual_message
  {'PUT', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id> -> calendar.update_appointment
================================================================================
  {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/conversation/<phone_number> -> whatsapp.get_conversation
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads -> crm_bp.api_threads
  {'GET', 'OPTIONS', 'HEAD'} /api/reminders/due -> leads_bp.get_due_reminders
  {'PUT', 'GET', 'OPTIONS', 'HEAD'} /api/admin/support/phones -> admin_bp.admin_support_phones
  {'OPTIONS', 'POST'} /api/biz/users -> ui.api_biz_users_create

‚úÖ Simple SPA routes registered (no blueprint)
  {'OPTIONS', 'POST'} /api/ui/login -> ui.api_login
  {'OPTIONS', 'POST'} /api/admin/user/<int:user_id>/toggle-status -> business_management.toggle_user_status
  {'GET', 'OPTIONS', 'HEAD'} /api/receipts -> receipts_contracts.list_receipts
  {'PUT', 'OPTIONS'} /api/business/current/settings -> business_management.update_current_business_settings
  {'PATCH', 'OPTIONS'} /api/leads/bulk -> leads_bp.bulk_update_leads
  {'DELETE', 'OPTIONS'} /api/reminders/<int:reminder_id> -> leads_bp.delete_general_reminder
  {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/activity -> api_adapter.dashboard_activity
INFO:     127.0.0.1:56448 - "GET / HTTP/1.1" 200 OK
  {'OPTIONS', 'POST'} /api/whatsapp/webhook/incoming -> whatsapp.baileys_webhook

  {'OPTIONS', 'POST'} /api/whatsapp/prompts/<int:business_id> -> whatsapp.save_whatsapp_prompt
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders/<int:reminder_id> -> leads_bp.get_reminder

  {'OPTIONS', 'POST'} /api/crm/deals -> crm_bp.create_deal
  {'GET', 'OPTIONS', 'HEAD'} /api/leads -> leads_bp.list_leads
  {'GET', 'OPTIONS', 'POST', 'HEAD'} /api/ui/logout -> ui.api_logout
  {'OPTIONS', 'POST'} /api/leads -> leads_bp.create_lead
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/history -> crm_bp.api_call_history
  {'OPTIONS', 'POST'} /api/leads/<int:lead_id>/status -> leads_bp.update_lead_status


  {'OPTIONS', 'POST'} /api/crm/contracts -> crm_bp.create_contract

  {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/stats -> intelligence.get_intelligence_stats
  {'GET', 'OPTIONS', 'HEAD'} /api/statuses -> status_management.get_business_statuses
  {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/reminders/<int:reminder_id> -> leads_bp.update_reminder
  {'OPTIONS', 'POST'} /api/leads/<int:lead_id>/message/whatsapp -> leads_bp.send_whatsapp_message
  {'OPTIONS', 'POST'} /api/auth/forgot -> auth_api.forgot_password
  {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/activities -> leads_bp.get_lead_activities
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/customers -> crm_bp.api_customers
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/success -> crm_bp.paypal_success
  {'DELETE', 'OPTIONS'} /api/statuses/<int:status_id> -> status_management.delete_status
  {'OPTIONS', 'POST'} /api/leads/bulk-delete -> leads_bp.bulk_delete_leads
INFO:     Started server process [35]
  {'GET', 'OPTIONS', 'HEAD'} /api/reminders -> leads_bp.get_all_reminders
  {'OPTIONS', 'POST'} /api/statuses/reorder -> status_management.reorder_statuses
  {'OPTIONS', 'POST'} /api/whatsapp/reset -> whatsapp.reset

  {'PUT', 'OPTIONS'} /api/business/current/prompt -> ai_prompt.update_current_business_prompt
  {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/download -> receipts_contracts.download_contract
  {'PUT', 'OPTIONS'} /api/crm/tasks/<int:task_id> -> crm_bp.update_crm_task
  {'OPTIONS', 'POST'} /api/calls/cleanup -> calls.cleanup_old_recordings
  {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/details -> calls.get_call_details
  {'OPTIONS', 'POST'} /api/calendar/appointments -> calendar.create_appointment
  {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/cancel -> crm_bp.paypal_cancel
‚úÖ ASGI BUILD 87 READY - ALL SYSTEMS GO

  {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/stats -> api_adapter.dashboard_stats
  {'PUT', 'OPTIONS'} /api/statuses/<int:status_id> -> status_management.update_status
2025-10-21T15:08:10Z info: Deployment successful