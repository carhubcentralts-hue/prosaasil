××‘×™×Ÿ â€” ×“×£ ×¨×™×§ ×‘×¤×¨×•×“×§×©×Ÿ ×–×” ×§×œ××¡×™ â€œ×¢×•×‘×“ ×œ×™ ×‘×‘×™×œ×“, × ×•×¤×œ ×‘×–××Ÿ ×¨×™×¦×”â€. ×”× ×” ×ª×•×›× ×™×ª ×—×™×œ×•×¥ ×××•×§×“×ª, ×‘×œ×™ ×œ×©×‘×•×¨ ×›×œ×•×, ×¢× ×¦×¢×“×™× ×§×¦×¨×™× + ×¤××¦×³×™× ××•×›× ×™×. ×”××˜×¨×”: ×œ×”×•×¦×™× ×©×’×™××” ××“×•×™×§×ª ××”×“×¤×“×¤×Ÿ ×ª×•×š ×“×§×”, ×œ×‘×˜×œ ×›×œ caching/Service-Worker ×ª×§×•×¢, ×•×œ×•×•×“× ×©×”-SPA ×¢×•×œ×”.

ğŸš‘ ×¦×¢×“×™ ×“×™×‘××’ ××”×™×¨×™× (×¡×“×¨ ×‘×™×¦×•×¢)
	1.	× ×§×” ×§××© ×§×©×•×—
	â€¢	×‘×“×¤×“×¤×Ÿ: Hard Refresh (Cmd/Ctrl+Shift+R).
	â€¢	×¤×ª×— DevTools â†’ Application â†’ Clear storage â†’ â€œClear site dataâ€.
	â€¢	×× ×™×© Service Worker: â€œUnregisterâ€ (×¢×•×“ ×¤×™×¨×•×˜ ×œ××˜×”).
	2.	×‘×“×•×§ ×¨×©×ª (Network)
	â€¢	×—×¤×© 404/403 ×¢×œ ×§×‘×¦×™ chunk-*.js ××• assets/*.
	â€¢	×•×“× ×©×›×œ ×”×§×‘×¦×™× ×¢× 200 ×•Ö¾Content-Type: application/javascript.
	â€¢	×× ×™×© 404 ×¢×œ chunks â†’ ×”Ö¾index.html ××¦×‘×™×¢ ×œ× ×ª×™×‘ ×©×’×•×™ (base/× ×ª×™×‘ ×¡×˜×˜×™).
	3.	×‘×“×•×§ Console (××—×¨×™ ×¨×¢× ×•×Ÿ)
	â€¢	×× ××™×Ÿ ×©×•× ×œ×•×’/×©×’×™××” â†’ ×¡×‘×™×¨ ×©×™×© Service Worker ×™×©×Ÿ ××• ×§×•×“ ×©××‘×˜×œ console. × ×‘×˜×œ ××•×ª× (×¤××¦×³×™× ×œ××˜×”).
	4.	××©×¨ ×©×”×©×•×¨×© ×§×™×™×
	â€¢	×‘Ö¾index.html ×™×© <div id="root"></div> (××• whatever)
	â€¢	×•×‘Ö¾main.tsx/tsx ××ª×” ×¢×•×©×” createRoot(document.getElementById('root')!).
	â€¢	×× ids ×œ× ×ª×•×××™× â†’ ××¡×š ×¨×™×§.
	5.	×•×“× ×©××™×Ÿ â€œbase pathâ€ ×©×’×•×™
	â€¢	×× ××ª×” ××©×¨×ª ×ª×—×ª /â€: ×‘Ö¾index.html ×©×™× <base href="/">.
	â€¢	×× ××©×¨×ª ×ª×—×ª ×ª×ª-× ×ª×™×‘, ×”×•×¦× ××ª ×”-build ×¢× base ××ª××™× (Vite: base:'/subpath/').
	6.	×›×‘×” Service Worker/Cache ×‘×¦×“ ×”×œ×§×•×—
	â€¢	×œ×¢×ªÖ¾×¢×ª × ×‘×˜×œ SW ×•× ×›×¨×™×— ×’×¨×¡×” ×—×“×©×” (×¤××¦×³ ×œ××˜×”).

â¸»

ğŸ§© ×¤××¦×³×™× ×§×˜× ×™× (×××œ×™×¥ ×œ×”×—×™×œ ×”×›×œ â€” ×œ× ×™×©×‘×•×¨ ×›×œ×•×)

A) Global error probe (×ª×¨××” ××” ×§×•×¨×” ×‘×–××Ÿ ×××ª)

×”×•×¡×£ ×§×•×‘×¥ client/src/globalErrorProbe.ts:

// Log all runtime errors & promise rejections to console and server
(function () {
  const log = (type: string, e: any) => {
    try {
      const msg = e?.message || e?.reason?.message || String(e);
      const stack = e?.error?.stack || e?.stack || e?.reason?.stack || '';
      // Console
      // eslint-disable-next-line no-console
      console.error(`[FE:${type}]`, msg, stack);
      // Send to server (best-effort, fire-and-forget)
      navigator.sendBeacon?.('/api/fe-log', JSON.stringify({
        type, msg, stack, url: location.href, ts: Date.now()
      }));
    } catch {}
  };
  window.addEventListener('error', (e) => log('error', e));
  window.addEventListener('unhandledrejection', (e) => log('unhandledrejection', e));
})();

×™×™×‘×•× ×—×“-×¤×¢××™ ×‘×ª×—×™×œ×ª client/src/main.tsx:

import './globalErrorProbe';

×¦×“ ×©×¨×ª ××™× ×™××œ×™ ×œ×§×œ×•×˜ ×œ×•×’ (Flask):

# server/routes/fe_log.py
from flask import Blueprint, request
bp = Blueprint('fe_log', __name__)

@bp.route('/api/fe-log', methods=['POST'])
def fe_log():
    try:
        data = request.get_json(silent=True) or {}
        # ×”×—×œ×£ ×œ-logger ×©×œ×š
        print(f"[FE-LOG] {data}")
    except Exception as e:
        print(f"[FE-LOG-ERR] {e}")
    return ('', 204)

×¨×©×•× ××ª ×”-blueprint ×‘-app_factory.py.

×ª×•×¦××”: ×’× ×× ×”Ö¾console â€œ×©×§×˜â€, ×ª×§×‘×œ ×©×’×™××” ×××™×ª×™×ª ×‘×œ×•×’ ×”×©×¨×ª.

â¸»

B) ×”×’× ×” ×¡×‘×™×‘ mount ×©×œ ×”-SPA (××•× ×¢ â€œ××¡×š ×¨×™×§ ×©×§×˜â€)

×‘Ö¾client/src/main.tsx:

import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './globalErrorProbe'

function bootstrap() {
  const el = document.getElementById('root');
  if (!el) {
    console.error('[BOOT] #root not found in index.html');
    return;
  }
  try {
    const root = ReactDOM.createRoot(el);
    root.render(<App />);
    // eslint-disable-next-line no-console
    console.log('[BOOT] App mounted ok');
  } catch (e) {
    // eslint-disable-next-line no-console
    console.error('[BOOT] render failed', e);
    // ×ª×Ÿ ×”×•×“×¢×ª fallback ×‘×¡×™×¡×™×ª ×œ××¡×š
    el.innerHTML = '<div style="padding:16px;font-family:sans-serif">×˜×¢×™× ×ª ×”××¤×œ×™×§×¦×™×” × ×›×©×œ×”. × ×¡×” ×œ×¨×¢× ×Ÿ (Cmd/Ctrl+Shift+R).</div>';
  }
}
bootstrap();


â¸»

C) Index HTML ×‘×¡×™×¡×™ × ×›×•×Ÿ

×‘Ö¾client/index.html ×•×“×:

<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" /> <!-- ×—×©×•×‘ ×× ××©×¨×ª×™× ××”×©×•×¨×© -->
    <title>Pro-SaaS</title>
  </head>
  <body>
    <div id="root"></div> <!-- ×¦×¨×™×š ×œ×”×ª××™× ×œ-main.tsx -->
    <script type="module" src="/assets/index-XXXX.js"></script>
  </body>
</html>

×× Vite ××™×™×¦×¨ <script type="module" src="/src/main.tsx"> ×‘×–××Ÿ dev â€” ×‘×¤×¨×•×“×§×©×Ÿ ×–×” ×™×”×™×” ×œ-bundle ×¢× hash. ×•×•×“× ×©×”× ×ª×™×‘ ×ª×•×× ×œ×”×’×©×” ×©×œ Flask/Static.

â¸»

D) ×‘×™×˜×•×œ Service Worker ×™×©×Ÿ

×× ××™ ×¤×¢× × ×¨×©× SW (××• ×”×•×¢×ª×§ ××¤×¨×•×™×§×˜ ×§×•×“×), ×”×•× ×™×›×•×œ â€œ×œ×”×§×¤×™×â€ ×’×¨×¡×” ×™×©× ×” â†’ ×“×£ ×¨×™×§.
	1.	×”×•×¡×£ ×§×•×‘×¥ ×§×˜×Ÿ ×©××‘×˜×œ SW ×¤×¢× ××—×ª:

// client/src/unregisterSW.ts
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations?.().then(regs => {
    regs.forEach(r => r.unregister());
  });
}

×™×™×‘× ×‘×ª×—×™×œ×ª main.tsx:

import './unregisterSW'

	2.	DevTools â†’ Application â†’ Service Workers â†’ Unregister, ×•××– Hard Refresh.

â¸»

E) ×›×•×ª×¨×•×ª ×§××© × ×›×•× ×•×ª

×‘-Flask:
	â€¢	index.html: Cache-Control: no-store, must-revalidate
	â€¢	× ×›×¡×™ build ×¢× hash (/assets/*.js/css): Cache-Control: public, max-age=31536000, immutable

×–×” ××•× ×¢ ××¦×‘ ×©×‘×• index ×—×“×© ×˜×•×¢×Ÿ assets ×™×©× ×™× (××• ×œ×”×¤×š).

â¸»

F) ×‘×“×™×§×ª â€œ× ×ª×™×‘×™ ×¡×˜×˜×™×§â€

×× ×”-client ××¦×¤×” ×œ× ×ª×™×‘ /assets/â€¦ ××‘×œ Flask ××’×™×© ×ª×—×ª /static/â€¦, ×¢×©×” ××—×“ ×××œ×”:
	â€¢	×”×¤× ×” ××ª /assets ×œ-static_folder (route ×§×˜×Ÿ ×©××’×™×© static), ××•
	â€¢	×‘-Vite build.outDir ×•-base ×ª×•×××™× ×œ× ×ª×™×‘ ×©××ª×” ××’×™×©.

×˜×¡×˜ ××”×™×¨: ×¤×ª×— ×™×“× ×™×ª ××ª ×›×œ ×”-chunks ×©× ×“×¨×©×™× ××”-index (Network â†’ ×§×œ×™×§ ×¢×œ ×›×œ script) ×•×•×“× ×©×”× 200 ×¢× JS ×ª×§×£.

â¸»

G) ××©×ª× ×™ ×¡×‘×™×‘×” ×‘×¤×¨×•×“ (Vite)

production ×‘-Vite ×§×•×¨× ×¨×§ ××©×ª× ×™× ×©××ª×—×™×œ×™× ×‘-VITE_.
×× ×™×© ×œ×š process.env.API_URL ×–×” ×™×”×™×” undefined ×‘×‘× ×“×œ ×¤×¨×•×“.
×”×¤×•×š ××•×ª× ×œ-import.meta.env.VITE_API_URL ×•×©××•×¨ .env.production ×‘×‘×™×œ×“.

×¡×™××¤×˜×•× ×§×œ××¡×™: ×‘×“×‘××œ×•×¤×× ×˜ ×¢×•×‘×“, ×‘×¤×¨×•×“ ×–×” undefined â†’ render ×ª× ××™ × ×›×©×œ â†’ ××¡×š ×¨×™×§.

â¸»

H) Runtime Health Probe

×”×•×¡×£ endpoint ×©××—×–×™×¨ ××ª ×’×¨×¡×ª ×”×‘×™×œ×“ + ×‘×“×™×§×ª JS:
	â€¢	×‘×©×¨×ª ×›×‘×¨ ××¦×™×’ â€œBUILD: 87â€.
	â€¢	×‘×¦×“ ×œ×§×•×—, ××—×¨×™ mount: console.log('[BOOT] App mounted ok').
×× ××ª×” ×¨×•××” build 87 ×‘-DOM ××‘×œ ×œ× ××ª ×”×œ×•×’ â€” ×”-JS ×œ× ×¨×¥ â†’ ×—×¤×© CSP/ MIME/ SW/ ×©×’×™××ª mount.

â¸»

ğŸ”¦ ××” ×›× ×¨××” ×”×‘×¢×™×” ××¦×œ×š (×œ×¤×™ ×”×ª×™××•×¨)
	â€¢	××ª×” ×›×Ÿ ×¨×•××” â€œBUILD 87â€ (×-HTML),
	â€¢	×”×§×•×‘×¥ index-*.js × ×˜×¢×Ÿ 200,
	â€¢	××™×Ÿ ×œ×•×’×™× ×—×“×©×™× ×‘-console,
=> ×‘×¨×•×‘ ×”××§×¨×™× ×–×” Service Worker ×™×©×Ÿ ××• ××©×ª× ×™ ×¡×‘×™×‘×” ×¨×™×§×™× ×‘×¤×¨×•×“ ××• mount ×œÖ¾#root ×©×œ× ×§×™×™×/×©×•× ×”.
×”×¤××¦×³×™× ×œ××¢×œ×” ××›×¡×™× ××ª ×©×œ×•×©×ª×.

×ª×‘×¦×¢:
	1.	Unregister SW + Hard Refresh.
	2.	×”×•×¡×£ globalErrorProbe + bootstrap try/catch â†’ ×ª×¨××” ×›×œ ×©×’×™××”.
	3.	×•×“× #root ×§×™×™× ×•×ª×•××.
	4.	×•×“× VITE_* ×§×™×™××™× ×‘×¤×¨×•×“.
	5.	×•×“× ×§××©Ö¾×”×“×¨×™×: index.html no-store, assets immutable.

×‘×¨×’×¢ ×©×ª×©×œ×•×£ ××ª ×”×©×’×™××” ×”×¨××©×•× ×” ××”-console ××• ××”-/api/fe-log, ×–×” ×™×™×¤×ª×¨ ××™×™×“.