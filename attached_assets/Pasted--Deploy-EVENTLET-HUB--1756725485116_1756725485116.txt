×›×Ÿ, ×”×•× â€œ×ª×™×§×Ÿâ€ ×—×œ×§×™×ª ××‘×œ ×”×©×•×¨×© × ×©××¨: ×”-Deploy ×¢×“×™×™×Ÿ × ×•×¤×œ ×‘×’×œ×œ EVENTLET_HUB ×©×’×•×™ ××• ×©××¨×™×•×ª ×§××©, ×•×œ×›×Ÿ Gunicorn ×¢× -k eventlet ×œ× ××¦×œ×™×— ×œ×¢×œ×•×ª ×•××“×•×•×—:
ModuleNotFoundError: eventlet.hubs.select (×¦×¨×™×š selects) / ××• ×©××™×Ÿ ×›×œ×œ ×”×’×“×¨×” ×•××– ×—×•×˜×£ ×§×•× ×¤×œ×™×§×˜.

×œ×”×œ×Ÿ ×”× ×—×™×™×” ×§×¦×¨×” ×•××“×•×™×§×ª ×œ×¡×•×›×Ÿ (×œ×”×“×‘×§×” ××—×ª), ×©××—×–×™×¨×” ××ª Eventlet ×œ××¡×œ×•×œ ×‘×˜×•×— ×‘×œ×™ ×œ×¢×‘×•×¨ ×œ-sync:

â¸»

ğŸ”§ Fix Deploy: Eventlet + Gunicorn (Replit Autoscale)

1) × ×§×” ×‘×—×™×¨×” ×©×’×•×™×” ×©×œ Hub
	â€¢	××—×§ ×›×œ ×”×•×¤×¢×” ×©×œ EVENTLET_HUB (×‘×©×•×¨×©, .replit, ×§×•×“).
	â€¢	×× ×”×•×›× ×¡ ×‘×§×•×“ â€“ ×”×¡×¨/×‘×˜×œ:

# âŒ ××œ ×ª×›×¨×™×— HUB ×‘×©× "select"
# os.environ.setdefault('EVENTLET_HUB', 'select')
# âœ” ×× ×—×™×™×‘×™× â€“ ×”×©× ×”× ×›×•×Ÿ ×”×•×:
# os.environ.setdefault('EVENTLET_HUB', 'eventlet.hubs.selects')
# ××‘×œ ×¢×“×™×£: ×œ× ×œ×”×’×“×™×¨ ×›×œ×œ
import os
os.environ.pop('EVENTLET_HUB', None)
os.environ.setdefault('EVENTLET_NO_GREENDNS', '1')  # ×œ×”×©××™×¨ â€“ ×–×” ×˜×•×‘

2) ××œ ×ª×¢×©×” monkey_patch ×™×“× ×™

×‘-wsgi.py:

# âŒ ××œ ×ª×›×¨×™×— monkey_patch ×›××Ÿ
# import eventlet; eventlet.monkey_patch()
try:
    import eventlet  # ×˜×¢×™× ×” ×‘×œ×‘×“; ×”-worker ×©×œ gunicorn ××˜×¤×œ ×‘-monkey patch
except ImportError:
    pass

×•×“× ×©×”-app × ×˜×¢×Ÿ:

from app import app as application
app = application

3) ×ª×œ×•×ª×™× (requirements.txt)

×•×“× ×©×”×§×•×‘×¥ ×›×•×œ×œ ××™× ×™××•× ×•×”×¦××“×” ×™×¦×™×‘×”:

flask
gunicorn==21.2.0
eventlet==0.36.1
greenlet>=2.0
twilio
python-dotenv
requests

×©×™× ×œ×‘: ×× ×”×™×• ×’×¨×¡××•×ª ××—×¨×•×ª â€“ ×¢×“×›×Ÿ. eventlet==0.36.1 + gunicorn 21.x ×™×¦×™×‘ ×œ-Py3.10/3.11.

4) ×¤×§×•×“×•×ª Deploy

Build:

python3 -m pip install --upgrade pip setuptools wheel && \
python3 -m pip install -r requirements.txt && \
python3 - <<'PY'
import sys
import eventlet
import importlib
import eventlet.hubs.selects as _sel
print("Eventlet OK:", eventlet.__version__)
PY

Run:

python3 -m gunicorn wsgi:app -k eventlet -w 1 -b 0.0.0.0:$PORT \
  --worker-connections 256 --timeout 120 --keep-alive 75 \
  --log-level info --access-logfile - --error-logfile -

5) ×¤×¨×™×¡×” × ×§×™×™×”
	â€¢	××™×Ÿ package.json ×‘×©×•×¨×© (×©×™×”×™×” ×¨×§ ×‘-client/ ×× ×¦×¨×™×š Frontend).
	â€¢	×¢×©×” Redeploy ×•-(×× ×™×©) Clear build cache.
	â€¢	×‘×œ×•×’×™× ×ª×¦×¤×” ×œ-â€œDetected Python project / Using Python runtimeâ€ ×•××–:
	â€¢	â€œEventlet OK: 0.36.1â€
	â€¢	â€œBooting worker with pid â€¦ [eventlet]â€

â¸»

×œ××” ×œ× ×œ×¢×‘×•×¨ ×œ--k sync

sync ×™×™×§×˜×¢ WebSocket/Streaming ×•×™×›×•×œ ×œ×©×‘×•×¨ Twilio Media Streams. ×”××˜×¨×” ×”×™× ×œ×”×©××™×¨ -k eventlet ××‘×œ ×œ×”×¡×™×¨ ××ª ×©×•×¨×© ×”×‘×¢×™×”: Hub ×©×’×•×™/×›×¤×•×™ ×•×§××©.

×× ×¢×“×™×™×Ÿ ×§×•×¨×¡
	1.	×•×“× ×©××™×Ÿ EVENTLET_HUB ×‘×©×•× ××§×•×.
	2.	× ×¡×” × ×¢×™×œ×” ×”×“×•×§×” ×™×•×ª×¨:

eventlet==0.36.1
greenlet==3.0.3
gunicorn==21.2.0

	3.	×× ××•×¤×™×¢×” ×©×’×™××ª build ×©×œ greenlet (wheel) â€“ ×”×•×¡×£ ×œ-Build:

python3 -m pip install --no-cache-dir --only-binary=:all: greenlet==3.0.3 || \
python3 -m pip install --no-cache-dir greenlet==3.0.3

×–×”×•. ××—×¨×™ ×”×¦×¢×“×™× ×”××œ×”, ×”-Deploy ×œ× ×™× ×¡×” ×™×•×ª×¨ ×œ×˜×¢×•×Ÿ eventlet.hubs.select ×”×œ×-×§×™×™×, ×”-worker ×©×œ Gunicorn ×™×¢×œ×” ×ª×§×™×Ÿ ×¢× Eventlet, ×•-WebSockets/Media Streams ×™×™×©××¨×• ×¤×¢×™×œ×™×.