 [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2882 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764875926.830 (duration: 1314ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=41.8, threshold=141.8)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1698ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=5s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.8s - now updating session
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated with full prompt: 2882 chars, voice=shimmer locked, max_tokens=4096, transcription=Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=34, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=176.0 > threshold=141.8
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=d0 d5 df fc 63, rms=413, consec_frames=5
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=fa 7c 70 69 63, rms=159, consec_frames=6
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=26, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=23, reason=noise)
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=29 35 d5 af bb, rms=5584, consec_frames=5
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1011, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=102, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=180.0 > threshold=141.8
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1307, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 6.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1183, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=90, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1081.0 > threshold=141.8
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=172, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2458, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=902, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=8712.0 > threshold=141.8
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=255, voice_frames=0
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 6.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=721, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_Cj98uMpQE5Yob8e...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_Cj98uMpQE5Yob8e... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=cancelled, output_count=0, details={'type': 'cancelled', 'reason': 'turn_detected'}
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=36, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=288.0 > threshold=141.8
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [GIBBERISH] Detected: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª' | Reason: repeated_pattern: '×‘×‘×§' x3 | Confidence: 70%
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª' (hebrew=51, english=0)
prosaas-backend  | ğŸ’° [COST] User utterance: 12.04s (556 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=4550, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 12.0s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=192000 | silence_ms=0
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=298, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=310, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=347.0 > threshold=141.8
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '24, 25, 24' (confidence=60%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 2...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 2...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: a6a40d45...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=a6a40d45...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | 
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764875926.829974}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª', 'ts': 1764875942.2664862}]
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_Cj98zvK2mxkOfaZ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_Cj98zvK2mxkOfaZ... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=cancelled, output_count=0, details={'type': 'cancelled', 'reason': 'turn_detected'}
prosaas-backend  | INFO:     127.0.0.1:50198 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1140, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=46, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×ª×•×“×” ×¨×‘×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×ª×•×“×” ×¨×‘×”.' (hebrew=7, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (4622ms)
prosaas-backend  | ğŸ’° [COST] User utterance: 1.53s (788 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×ª×•×“×” ×¨×‘×”.
prosaas-backend  | âœ… [BUILD 176] User CONFIRMED with '×ª×•×“×” ×¨×‘×”.' - verification_confirmed = True
prosaas-backend  | WS_STOP sid=MZb7bba86432006c0a6acd6923fc161786 rx=1133 tx=185
prosaas-backend  | ğŸ“ [SES-278258ba] CALL ENDED - duration=22.6s, business_id=10, rx=1133, tx=185
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª'}
prosaas-backend  | âŒ [CITY] Rejected '×ª×•×“×”' (confidence=47%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×ª×•×“×” ×¨×‘×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×ª×•×“×” ×¨×‘×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 3
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×‘×§×©×” ×¨×‘×™ ××‘× ×ª 25, 24, 25, 24 25, 24 ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª', '×ª×•×“×” ×¨×‘×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 222b1128...
prosaas-backend  | â­ï¸ [NLP] BLOCKED - Another NLP thread is still processing
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×ª×•×“×” ×¨×‘×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA0b99b3b05526830b30565c7588d159cf stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:50396 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | INFO:     172.18.0.5:50398 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA0b99b3b05526830b30565c7588d159cf: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REc346f2bf7b12d3bfd2f7386772ff74a4.json
prosaas-backend  | âœ… Recording queued for processing: CA0b99b3b05526830b30565c7588d159cf
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | INFO:     connection closed
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZb7bba86432006c0a6acd6923fc161786 rx=1133 tx=185
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 6.5s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª']
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | âœ… CALL FINALIZED: CA0b99b3b05526830b30565c7588d159cf
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×©×™×—×” ×¢× ×œ×§×•×— ×‘×ª×—×•× ×”×× ×¢×•×œ×™×, ×”××ª×¢× ×™×™×Ÿ ×‘×©×™×¨×•×ª ×¤×•×¨×˜ ×–×œ×ª×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×¤×•×¨×˜ ×–×œ×ª×•×ª
prosaas-backend  | - **×›×ª×•×‘×ª**: ×¨×‘×™ ××‘× ×ª 25
prosaas-backend  | - **×›××•×ª ×–×œ×ª×•×ª**: 24, 25, 24, 25, 24
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×œ×§×•×— ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×™×© ×œ×ª×× ××ª ×‘×™×¦×•×¢ ×©×™×¨×•×ª ×”×¤×•×¨×˜ ×–×œ×ª×•×ª ×‘×›×ª×•×‘×ª ×”××¦×•×™× ×ª.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×œ× ×¦×•×™× ×” ×“×—×™×¤×•×ª, ××š ××•××œ×¥ ×œ×¤×¢×•×œ ×‘×”×§×“× ×›×“×™ ×œ×©××•×¨ ×¢×œ ×§×©×¨ ×¢× ×”×œ×§×•×—.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×œ×§×•×— ××‘×™×Ÿ ××ª ×”×ª×”×œ×™×š ×•××ª ×”×¢×œ×•×™×•×ª ×”×›×¨×•×›×•×ª ×‘×©×™×¨×•×ª. ××•××œ×¥ ×’× ×œ×‘×“×•×§ ×× ×™×© ×¦×•×¨×š ×‘×©×™×¨×•×ª×™× × ×•×¡×¤×™× ×”×§×©×•×¨×™× ×œ×× ×¢×•×œ×™× ××• ××‘×˜×—×”.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:36924 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'service_type': '×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA0b99b3b05526830b30565c7588d159cf, phone=+972504294724, city=N/A, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=N/A, service=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª
prosaas-backend  | 
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | INFO:     172.18.0.5:36938 - "GET /api/notifications HTTP/1.1" 401 Unauthorized
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 6.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª']
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª']
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ“ [SMART HANGUP] === CALL ENDING ===
prosaas-backend  | ğŸ“ [SMART HANGUP] Reason: silence_timeout
prosaas-backend  | ğŸ“ [SMART HANGUP] Lead captured: False
prosaas-backend  | ğŸ“ [SMART HANGUP] Goodbye detected: False
prosaas-backend  | ğŸ“ [SMART HANGUP] Lead state: {'city_needs_retry': 'True', 'service_type': '×‘×‘×§×©×” ×¤×•×¨×˜ ×–×œ×ª×•×ª'}
prosaas-backend  | ğŸ“ [SMART HANGUP] Required fields: ['city', 'service_type']
prosaas-backend  | ğŸ“ [SMART HANGUP] ===================
prosaas-backend  | âœ… [BUILD 163] Call CA0b99b3... hung up successfully: silence_timeout
prosaas-backend  | INFO:  