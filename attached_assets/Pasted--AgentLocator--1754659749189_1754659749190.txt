××•×›×Ÿ. ×”× ×” **×”× ×—×™×” ××—×ª, ×¡×•×¤×™×ª ×•××“×•×™×§×ª** ×œ×¡×•×›×Ÿ ×©×œ×š ×›×“×™ ×œ×ª×§×Ÿ *×”×›×œ* ×•×œ×”×‘×™× ××ª AgentLocator ×œ×¤×¨×•×“×§×©×Ÿ ××œ× â€” ×©×™×—×•×ª ×˜×œ×¤×•×Ÿ (Twilio) ××•×§×œ×˜×•×ª ×•××ª×•××œ×œ×•×ª ×œ×¢×‘×¨×™×ª (Whisper), WhatsApp (Baileys), ×•Ö¾CRM ×©×œ×. ×”×”× ×—×™×” ×›×•×œ×œ×ª ××™×§×•××™ ×§×‘×¦×™×, ×§×•×“, ×‘×“×™×§×•×ª ×§×‘×œ×” ×•Ö¾CI.

---

# âœ… ×”×•×¨××ª ×‘×™×¦×•×¢ ×œ×¡×•×›×Ÿ â€“ ×ª×™×§×•×Ÿ ××œ× ×•×”×›× ×” ×œ×¤×¨×•×“×§×©×Ÿ

> ×¢×‘×“/×™ ×œ×¤×™ ×”×¡×“×¨, ×‘×¦×¢×™ *×©×™× ×•×™×™× ×‘×¤×•×¢×œ* ×¢× ×§×˜×¢×™ ×§×•×“ (diff ×œ×¤× ×™/××—×¨×™). ×‘×›×œ ×©×œ×‘ ×”×¨×¥ ×‘×“×™×§×•×ª ×§×‘×œ×” ×©××•×¤×™×¢×•×ª ×‘×¡×•×£ ×”×¡×¢×™×£.
> ××œ ×ª×¡×›× "×‘×•×¦×¢" ×‘×œ×™ ×©×”×‘×“×™×§×•×ª ×™×¨×•×§×•×ª.

## 0) ×”×›× ×•×ª

* ×¦×¨×• ×¢× ×£ ×¢×‘×•×“×”: `git checkout -b fix/full-prod`
* Python 3.11, Node 20.
* ×§×‘×¦×™ ×¡×•×“×•×ª (×œ×•×§××œ×™/CI):
  `TWILIO_ACCOUNT_SID`, `TWILIO_AUTH_TOKEN`, `OPENAI_API_KEY`,
  `GOOGLE_APPLICATION_CREDENTIALS`, `VAPID_PUBLIC_KEY`, `VAPID_PRIVATE_KEY`, `SECRET_KEY`.

---

## 1) App Factory + Blueprints

**×§×‘×¦×™×:** `server/app_factory.py`, `server/routes/__init__.py`

**server/app\_factory.py** (×× ×—×¡×¨ â€” ×¦×•×¨/×¢×“×›×Ÿ ×›×š):

```python
from flask import Flask
from .routes import register_blueprints
from .error_handlers import register_error_handlers
from .logging_setup import setup_logging

def create_app(config_object="server.config.ProdConfig"):
    app = Flask(__name__)
    app.config.from_object(config_object)
    setup_logging(app)
    register_blueprints(app)
    register_error_handlers(app)
    return app
```

**server/routes/**init**.py**:

```python
from .routes_twilio import twilio_bp
from .routes_crm import crm_bp
from .routes_signature import signature_bp
from .routes_calendar import calendar_bp
from .routes_proposal import proposal_bp
from .routes_reports import reports_bp

def register_blueprints(app):
    app.register_blueprint(twilio_bp,    url_prefix="/webhook")
    app.register_blueprint(crm_bp,       url_prefix="/api/crm")
    app.register_blueprint(signature_bp, url_prefix="/signature")
    app.register_blueprint(calendar_bp,  url_prefix="/calendar")
    app.register_blueprint(proposal_bp,  url_prefix="/proposal")
    app.register_blueprint(reports_bp,   url_prefix="/reports")
```

**×§×‘×œ×”:** `flask run` â†’ GET ×¢×œ `/crm`/`/signature`/â€¦ ××—×–×™×¨ 200 (××• React index).

---

## 2) Twilio Voice â€” 3 × ×ª×™×‘×™× + TwiML ×ª×§×™×Ÿ

**×§×•×‘×¥:** `server/routes_twilio.py`

```python
from flask import Blueprint, request, Response, current_app
from twilio.twiml.voice_response import VoiceResponse
from .whisper_handler import transcribe_hebrew
from .ai_service import generate_reply_tts

twilio_bp = Blueprint("twilio", __name__)

@twilio_bp.route("/incoming_call", methods=["POST"])
def incoming_call():
    host = current_app.config.get("HOST", request.host_url.rstrip("/"))
    vr = VoiceResponse()
    # ×‘×¨×›×” (×‘×—×¨: Play ×§×•×‘×¥ ××• Say)
    # vr.say("×‘×¨×•×š ×”×‘×, ××™×š ××¤×©×¨ ×œ×¢×–×•×¨?", language="he-IL")
    vr.play(f"{host}/static/greeting.mp3")
    vr.record(
        finish_on_key="*",
        timeout=5,
        max_length=30,
        play_beep=True,
        action="/webhook/handle_recording"
    )
    return Response(str(vr), mimetype="text/xml")

@twilio_bp.route("/handle_recording", methods=["POST"])
def handle_recording():
    rec_url = request.form.get("RecordingUrl", "")
    text = transcribe_hebrew(rec_url)  # Whisper ×¢×‘×¨×™×ª
    audio_url = generate_reply_tts(text)  # ××—×–×™×¨ URL ×œ-MP3
    vr = VoiceResponse()
    vr.play(audio_url)
    return Response(str(vr), mimetype="text/xml")

@twilio_bp.route("/call_status", methods=["POST"])
def call_status():
    return ("", 200)
```

**×§×‘×œ×” (curl):**

* `POST /webhook/incoming_call` ××—×–×™×¨ `<Record ... finishOnKey="*" timeout="5" maxLength="30" ...>`.
* `POST /webhook/handle_recording` â†’ 200 (×“×•×¨×© ×”×§×œ×˜×” ×××™×ª×™×ª ×‘×˜×¡×˜ ××™× ×˜×’×¨×¦×™×”).
* `POST /webhook/call_status` â†’ 200.

---

## 3) Whisper ×¢×‘×¨×™×ª â€” ×”×•×¨×“×” ×××•×‘×˜×—×ª ×-Twilio + ×ª××œ×•×œ

**×§×•×‘×¥:** `server/whisper_handler.py`

```python
import io, requests, os
from pydub import AudioSegment

TW_SID  = os.getenv("TWILIO_ACCOUNT_SID")
TW_TOKEN= os.getenv("TWILIO_AUTH_TOKEN")
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")

def _download_recording(url: str) -> bytes:
    # Twilio ××•×¡×™×¤×” URL ×œ×œ× ×¡×™×•××ª â€” × ×¡×” .mp3 ×•××– .wav
    for ext in (".mp3", ".wav"):
        r = requests.get(url + ext, auth=(TW_SID, TW_TOKEN), timeout=30)
        if r.ok and r.content:
            return r.content
    # fallback: × ×¡×” ×›××• ×©×”×•×
    r = requests.get(url, auth=(TW_SID, TW_TOKEN), timeout=30)
    r.raise_for_status()
    return r.content

def transcribe_hebrew(recording_url: str) -> str:
    raw = _download_recording(recording_url)
    # ×™×™×¦×•×‘ ×œ×¤×•×¨××˜ WAV 16k
    audio = AudioSegment.from_file(io.BytesIO(raw))
    wav_bytes = io.BytesIO()
    audio.set_channels(1).set_frame_rate(16000).export(wav_bytes, format="wav")
    wav_bytes.seek(0)

    # Whisper (OpenAI) â€“ ×”×’×“×¨ ×©×¤×” ×œ×¢×‘×¨×™×ª ×œ×”×¢×“×¤×”
    import requests
    headers = {"Authorization": f"Bearer {OPENAI_API_KEY}"}
    files = {"file": ("audio.wav", wav_bytes, "audio/wav")}
    data  = {"model": "whisper-1", "language": "he"}  # ×¢×“×›×Ÿ ×œ××•×“×œ ×–××™×Ÿ ××¦×œ×š
    resp = requests.post("https://api.openai.com/v1/audio/transcriptions",
                         headers=headers, files=files, data=data, timeout=120)
    resp.raise_for_status()
    text = resp.json().get("text","").strip()
    # ×¡×™× ×•×Ÿ ×’'×™×‘×¨×™×© ×§×¦×¨
    return text if len(text) >= 2 else "×œ× × ×©××¢ ×‘×‘×™×¨×•×¨, × ×¡×” ×©×•×‘."
```

**×§×‘×œ×”:** ×§×¨× `transcribe_hebrew()` ×¢×œ ×§×•×‘×¥ ×“××• â†’ ××—×–×™×¨ ×˜×§×¡×˜ ×¢×‘×¨×™ ×¡×‘×™×¨.

---

## 4) AI/TTS â€” ×ª×©×•×‘×” ×§×•×’× ×™×˜×™×‘×™×ª + TTS (Wavenet) ×¢× Fallback ×™×—×™×“

**×§×•×‘×¥:** `server/ai_service.py`

```python
import os, uuid
from google.cloud import texttospeech
import requests

OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
AUDIO_DIR = "server/static/tts"

def _ensure_dir():
    os.makedirs(AUDIO_DIR, exist_ok=True)

def _ask_llm_hebrew(prompt: str) -> str:
    # ×”×—×œ×£ ×œ×§×¨×™××” ×œ××•×“×œ ×”×˜×§×¡×˜ ×©×œ×š (GPT ×•×›×•')
    headers = {"Authorization": f"Bearer {OPENAI_API_KEY}", "Content-Type":"application/json"}
    body = {"model":"gpt-4o-mini", "messages":[{"role":"user","content":prompt}]}
    r = requests.post("https://api.openai.com/v1/chat/completions", json=body, headers=headers, timeout=60)
    r.raise_for_status()
    return r.json()["choices"][0]["message"]["content"].strip()

def _tts_google_wavenet_he(text: str) -> str:
    client = texttospeech.TextToSpeechClient()
    synthesis_input = texttospeech.SynthesisInput(text=text)
    voice = texttospeech.VoiceSelectionParams(language_code="he-IL", name="he-IL-Wavenet-A")
    audio_config = texttospeech.AudioConfig(audio_encoding=texttospeech.AudioEncoding.MP3)
    _ensure_dir()
    fn = f"{uuid.uuid4().hex}.mp3"
    out_path = os.path.join(AUDIO_DIR, fn)
    resp = client.synthesize_speech(input=synthesis_input, voice=voice, audio_config=audio_config)
    with open(out_path, "wb") as f:
        f.write(resp.audio_content)
    return f"/static/tts/{fn}"

def generate_reply_tts(user_text: str) -> str:
    answer = _ask_llm_hebrew(user_text)
    try:
        return _tts_google_wavenet_he(answer)
    except Exception:
        # Fallback ×™×—×™×“ (××™×Ÿ ×œ×•×œ××”)
        return _tts_google_wavenet_he("×¡×œ×™×—×”, ×”×™×™×ª×” ×ª×§×œ×” ×¨×’×¢×™×ª. ×›×™×¦×“ ××•×›×œ ×œ×¢×–×•×¨?")
```

**×§×‘×œ×”:** ×§×¨×™××” ×œÖ¾`generate_reply_tts("××” ×©×¢×•×ª ×”×¤×¢×™×œ×•×ª?")` â†’ URL ×œÖ¾MP3 ×§×™×™×.

---

## 5) WhatsApp â€” Baileys Service + Webhook ×œÖ¾Flask

**××‘× ×”:**

```
services/whatsapp/
  package.json
  index.ts
server/routes_whatsapp.py
```

**services/whatsapp/package.json:**

```json
{
  "name": "wa-service",
  "private": true,
  "type": "module",
  "scripts": { "start": "tsx index.ts" },
  "dependencies": {
    "@adiwajshing/baileys": "^6.7.8",
    "pino": "^9.0.0",
    "express": "^4.19.0",
    "tsx": "^4.7.0",
    "node-fetch": "^3.3.2"
  }
}
```

**services/whatsapp/index.ts** (×¤×©×˜× ×™):

```ts
import makeWASocket, { useMultiFileAuthState, Browsers } from "@adiwajshing/baileys"
import express from "express"

const app = express()
app.use(express.json())

let sock: any

async function start() {
  const { state, saveCreds } = await useMultiFileAuthState("auth")
  sock = makeWASocket({
    auth: state,
    browser: Browsers.macOS("AgentLocator")
  })
  sock.ev.on("creds.update", saveCreds)
  sock.ev.on("messages.upsert", async (m) => {
    const msg = m.messages?.[0]
    if (!msg?.message || msg.key.fromMe) return
    // ×”×¢×‘×¨ ×œ-Flask
    await fetch(process.env.FLASK_WEBHOOK || "http://localhost:5000/webhook/whatsapp_incoming", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ from: msg.key.remoteJid, message: msg })
    })
  })
}

app.post("/send", async (req, res) => {
  const { to, text } = req.body
  await sock.sendMessage(to, { text })
  res.json({ ok: true })
})

app.listen(4001, () => console.log("WA service on :4001"))
start().catch(console.error)
```

**server/routes\_whatsapp.py:**

```python
from flask import Blueprint, request, jsonify
import requests, os

whatsapp_bp = Blueprint("whatsapp", __name__)
WA_SERVICE = os.getenv("WA_SERVICE_URL", "http://localhost:4001")

@whatsapp_bp.route("/send", methods=["POST"])
def wa_send():
    data = request.get_json(force=True)
    r = requests.post(f"{WA_SERVICE}/send", json=data, timeout=15)
    return (r.text, r.status_code, r.headers.items())

@whatsapp_bp.route("/webhook/whatsapp_incoming", methods=["POST"])
def wa_incoming():
    payload = request.get_json(force=True)
    # TODO: ×©××™×¨×” ×œ-DB, ×¦×™×¨×•×£ ×œ×˜×™×™××œ×™×™×Ÿ, ×˜×¨×™×’×¨×™×
    return jsonify({"ok": True})
```

**×§×‘×œ×”:** ×”×¤×¢×œ Node service â†’ POST ×œÖ¾`/api/whatsapp/send` ×©×•×œ×— ×”×•×“×¢×”; ×”×•×“×¢×ª × ×›× ×¡×ª â†’ × ×¨×©××ª ×‘Ö¾Flask webhook.

---

## 6) CRM â€” ××•×“×œ×™× + ×¤××’â€™×™× ×¦×™×” ×ª×§×™× ×”

**×§×•×‘×¥:** `server/models.py` (×•×“× ××—×œ×§×•×ª: Business, User, Customer, Invoice, Contract, Task, Call ×¢× `to_dict()`).

**×§×•×‘×¥:** `server/api_crm_advanced.py` â€” ×œ×”×¡×™×¨ `customers_paginate` ×•×œ×”×—×œ×™×£:

```python
from flask import Blueprint, request, jsonify
from .models import Customer, db

crm_bp = Blueprint("crm", __name__)

@crm_bp.route("/customers", methods=["GET"])
def customers_list():
    page = int(request.args.get("page", 1))
    limit = min(int(request.args.get("limit", 25)), 100)
    q = Customer.query.order_by(Customer.created_at.desc())
    total = q.count()
    items = q.offset((page-1)*limit).limit(limit).all()
    return jsonify({
        "page": page, "limit": limit, "total": total,
        "items": [c.to_dict() for c in items]
    })
```

**×§×‘×œ×”:** `GET /api/crm/customers?page=1&limit=25` â†’ 200 + `{items,total...}`.

---

## 7) Timeline â€” ××™×—×•×“ ×™×©×•×™×•×ª

**×§×•×‘×¥:** `server/api_timeline.py`

```python
from flask import Blueprint, jsonify
from .models import Call, WhatsAppMessage, Task, Contract, Invoice

timeline_bp = Blueprint("timeline", __name__)

@timeline_bp.route("/api/customers/<int:cid>/timeline", methods=["GET"])
def customer_timeline(cid):
    def wrap(rows, typ, ts="created_at"):
        return [{"type": typ, "ts": getattr(r, ts), **r.to_dict()} for r in rows]
    events = []
    events += wrap(Call.query.filter_by(customer_id=cid).all(), "call", "started_at")
    events += wrap(WhatsAppMessage.query.filter_by(customer_id=cid).all(), "whatsapp")
    events += wrap(Task.query.filter_by(customer_id=cid).all(), "task", "due_at")
    events += wrap(Contract.query.filter_by(customer_id=cid).all(), "contract")
    events += wrap(Invoice.query.filter_by(customer_id=cid).all(), "invoice")
    events.sort(key=lambda e: e["ts"] or 0, reverse=True)
    return jsonify(events), 200
```

**×§×‘×œ×”:** `GET /api/customers/1/timeline` â†’ 200 ×•××¢×¨×š ×××•×—×“.

---

## 8) ×”×¨×©××•×ª ×œ×¤×™ ×¢×¡×§ (Feature Flags)

**×§×•×‘×¥:** `server/models.py` (××—×œ×§×ª Business):

```python
class Business(db.Model):
    # ...
    signature_enabled = db.Column(db.Boolean, default=False)
    whatsapp_enabled  = db.Column(db.Boolean, default=False)
    crm_enabled       = db.Column(db.Boolean, default=True)
    invoices_enabled  = db.Column(db.Boolean, default=False)
    contracts_enabled = db.Column(db.Boolean, default=False)
```

**×‘×“×™×§×•×ª ×‘××¡×œ×•×œ×™×** (×“×•×’××”):

```python
from flask import jsonify
# ...
if not current_business.crm_enabled:
    return jsonify({"error":"crm_disabled"}), 403
```

**×§×‘×œ×”:** × ×¡×” ×œ×’×©×ª ×œ××¡×œ×•×œ ×œ×œ× ×”×¨×©××” â†’ ××§×‘×œ 403.

---

## 9) ×”×ª×¨××•×ª â€” Socket.IO + Push (SW)

**×©×¨×ª:** ××ª×—×œ `flask_socketio` ×‘Ö¾`app_factory.py`:

```python
from flask_socketio import SocketIO
socketio = SocketIO(cors_allowed_origins="*")

def create_app(...):
    app = Flask(__name__)
    # ...
    socketio.init_app(app)
    return app
```

**×©×™×“×•×¨ ××™×¨×•×¢ ××©×™××•×ª:**

```python
from .app_factory import socketio
socketio.emit("task:due", {"task_id": t.id, "title": t.title}, broadcast=True)
```

**×§×œ×™×™× ×˜:** `client/src/lib/socket.ts`

```ts
import { io } from "socket.io-client"
export const socket = io(import.meta.env.VITE_API_BASE || location.origin)
```

**Service Worker:** `client/public/sw.js`

```js
self.addEventListener('push', event => {
  const data = (event.data && event.data.json && event.data.json()) || {}
  event.waitUntil(self.registration.showNotification(data.title || '×”×ª×¨××”', { body: data.body || '' }))
})

self.addEventListener('notificationclick', event => {
  event.notification.close()
  event.waitUntil(clients.openWindow(event.notification?.data?.url || '/'))
})
```

**×§×‘×œ×”:** ×§×‘×œ ×”×ª×¨××” ×’× ×‘×˜××‘ ×¤×ª×•×— (Socket) ×•×’× ×¡×’×•×¨ (Push).

---

## 10) UI ×‘×¡×™×¡ (RTL + Tokens + ×¤×¢×•×œ×”)

**×§×•×‘×¥:** `client/src/styles/tokens.css`

```css
:root {
  --font-family: "Assistant", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --space-2: 8px; --space-3: 12px; --space-4: 16px; --space-6: 24px;
  --radius-xl: 16px;
}
html { direction: rtl; font-family: var(--font-family); }
```

**Action Bar ×‘×“×£ ×œ×§×•×—:** ×”×•×¡×£ ×§×•××¤×•× × ×˜×” ×¢× ×›×¤×ª×•×¨×™: `Call / WhatsApp / Task / Proposal / Signature / Invoice` (× ×•×•×˜/×¤×ª×— ××•×“×œ×™×).

**×§×‘×œ×”:** ×‘×“×£ ×œ×§×•×— ×¨×•××™× Action Bar ×•×¤×•× ×§×¦×™×•×ª ×¤×•×¢×œ×•×ª (×¤×ª×™×—×ª ××•×“×œ×™×/× ×™×•×•×˜).

---

## 11) ×©×’×™××•×ª/×œ×•×’×™×/×“×™×‘××’

**×§×‘×¦×™×:** `server/error_handlers.py`, `server/logging_setup.py`, `server/main.py`

```python
# server/error_handlers.py
def register_error_handlers(app):
    @app.errorhandler(404)
    def nf(e): return {"error":"not_found"}, 404
    @app.errorhandler(500)
    def se(e): return {"error":"server_error"}, 500
```

* ×•×“× `debug=False` ×‘×¤×¨×•×“×§×©×Ÿ.
* × ×§×” `print`/`console.log` â†’ ×”×©×ª××© ×‘Ö¾logging.

**×§×‘×œ×”:** 404/500 ××•×—×–×¨×™× ×‘×¤×•×¨××˜ ××—×™×“; ××™×Ÿ debug=True.

---

## 12) Tests + CI

**×‘×“×™×§×•×ª ×‘×¡×™×¡×™×•×ª** (`tests/`):

* `test_twilio_routes.py`: ×©×œ×•×©×” × ×ª×™×‘×™× ××—×–×™×¨×™× 200, ×•×‘Ö¾incoming\_call ×™×© `<Record ...>`.
* `test_crm.py`: `GET /api/crm/customers?page=1&limit=25` â†’ 200 ×•Ö¾JSON.
* `test_timeline.py`: `GET /api/customers/<id>/timeline` â†’ 200 ×•××¢×¨×š.
* `test_pages.py`: `/signature` `/calendar` `/proposal` `/crm` `/reports` â†’ 200 ××• ××™×ª×•×‘ ×œÖ¾React.

**CI**: `.github/workflows/ci.yml` (×”×§×•×‘×¥ ×©×©×œ×—×ª×™ ×œ×š ×§×•×“×).
××¨×™×¥ `pytest` + `npm run build`.

**×§×‘×œ×”:** CI ×™×¨×•×§ ×¢×œ PR.

---

## 13) ×“×¤×™ ××¢×¨×›×ª / × ×ª×™×‘×™×

×•×“× ×§×‘×¦×™×/Routes ×§×™×™××™×: `/signature`, `/calendar`, `/proposal`, `/crm`, `/reports` (×©×¨×ª), ××• × ×™×ª×•×‘ ×œ×§×œ×™×™× ×˜.
×”×¦×’ 404 ××¢×•×¦×‘ ×œ×›×œ ×©××¨ ×”× ×ª×™×‘×™×.

---

# ğŸ” ×‘×“×™×§×•×ª ×™×“× ×™×•×ª ××”×™×¨×•×ª (×œ×¨×©×•× ××—×¨×™ ×›×œ ×ª×™×§×•×Ÿ)

* **Twilio:**
  `curl -XPOST http://localhost:5000/webhook/incoming_call` â†’ XML ×¢× `Play` + `Record(finishOnKey="*", timeout="5", maxLength="30")`
  `curl -XPOST http://localhost:5000/webhook/call_status` â†’ 200
* **CRM:**
  `GET /api/crm/customers?page=1&limit=25` â†’ 200 + `{items,total,...}`
* **Timeline:**
  `GET /api/customers/1/timeline` â†’ 200 + ××¢×¨×š ×××•×—×“
* **WhatsApp:**
  ×”×¨×¥ `npm start` ×ª×—×ª `services/whatsapp`
  `POST /api/whatsapp/send {to, text}` â†’ ×”×•×“×¢×” ×™×•×¦××ª; ×”×•×“×¢×•×ª × ×›× ×¡×•×ª ××’×™×¢×•×ª ×œÖ¾`/webhook/whatsapp_incoming`
* **×”×ª×¨××•×ª:**
  ×××˜ ××™×¨×•×¢ `task:due` ×‘×©×¨×ª â†’ ×”×œ×§×•×— ××§×‘×œ Socket.
  ×©×œ×— Push ×“××• ×œÖ¾SW â†’ ××•×¤×™×¢×” ×”×ª×¨××” ×›×©×”×˜××‘ ×¡×’×•×¨.

---

# âœ… Acceptance Checklist (×—×™×™×‘ ×œ×¦×¨×£ ×œ×¤×œ×˜)

* [ ] ×©×œ×•×©×ª Twilio routes ×§×™×™××™× ×•×¢×•×‘×¨×™× ×‘×“×™×§×•×ª
* [ ] `Record` ×›×•×œ×œ finishOnKey="\*", timeout=5, maxLength=30
* [ ] Whisper ×¢×‘×¨×™×ª ×¤×•×¢×œ ×¢×œ ×”×§×œ×˜×” ×××™×ª×™×ª
* [ ] AI/TTS ××—×–×™×¨ MP3 + fallback ×™×—×™×“
* [ ] WhatsApp (Baileys) â€” ×©×œ×™×—×”/×§×‘×œ×” ×¢×•×‘×“×•×ª, webhook × ×¨×©×
* [ ] CRM: ×¤××’â€™×™× ×¦×™×” ×ª×§×™× ×”; ×›×œ ×”××•×“×œ×™× ×§×™×™××™× ×¢× `to_dict()`
* [ ] Timeline: ××™×—×•×“ 5 ×”×™×©×•×™×•×ª ×××•×™×™×Ÿ
* [ ] Feature flags ×œ×›×œ ×©×™×¨×•×ª + ×—×¡×™××ª 403 ×‘××¡×œ×•×œ×™×
* [ ] SW push + Socket.IO ×¢×•×‘×“×™×
* [ ] tokens.css RTL + Action Bar ×¤×¢×™×œ
* [ ] 404/500 ××¢×•×¦×‘×™×; ××™×Ÿ debug=True
* [ ] Tests ×¨×¦×™×; CI ×™×¨×•×§

---

×× ×ª×¨×¦×” â€” ××•×¦×™× ×œ×š **PR Diffs ××•×›× ×™×** ×œ×›×œ ×”×§×‘×¦×™× ×œ×¢×™×œ (Twilio, Whisper, AI/TTS, WhatsApp, CRM, Timeline, ×”×¨×©××•×ª, SW/Socket, ErrorHandlers, CI, Tests) ×›×“×™ ×©×ª×•×›×œ ×¤×©×•×˜ ×œ×”×“×‘×™×§ ×•×œ×“×—×•×£.
