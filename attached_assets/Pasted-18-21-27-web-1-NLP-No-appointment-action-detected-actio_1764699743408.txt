18:21:27 web.1     | ğŸ“­ [NLP] No appointment action detected (action=none)
18:21:27 web.1     | âœ… [NLP] Async NLP parser completed successfully
18:21:27 web.1     | âœ… [NLP] Cache updated after successful processing
18:21:27 web.1     | ğŸ”“ [NLP] Cleared nlp_is_processing flag
18:21:28 web.1     | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=15, voice_frames=0
18:21:28 web.1     | [REALTIME] event: response.output_item.added
18:21:28 web.1     | [REALTIME] event: conversation.item.created
18:21:28 web.1     | [REALTIME] event: response.content_part.added
18:21:28 web.1     | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
18:21:28 web.1     | âš ï¸ [AUDIO GAP] 2177ms gap between chunks #25 and #26 - OpenAI delay!
18:21:28 web.1     | âš ï¸ [BRIDGE GAP] 2177ms wait for queue - chunk #45
18:21:28 web.1     | [REALTIME] event: conversation.item.input_audio_transcription.completed
18:21:28 web.1     | [TRANSCRIPT FILTER] Ignoring too_short: ''
18:21:28 web.1     | [SAFETY] Transcription successful (total failures: 0)
18:21:29 web.1     | [REALTIME] event: response.audio.done
18:21:29 web.1     | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
18:21:29 web.1     | [REALTIME] event: response.audio_transcript.done
18:21:29 web.1     | ğŸ¤– [REALTIME] AI said: ×‘××™×–×• ×¢×™×¨ ××ª×” ×¦×¨×™×š ××ª ×”×—×©××œ××™?
18:21:29 web.1     | ğŸ’° [COST] AI utterance: 0.63s (37 chunks)
18:21:29 web.1     | [GOODBYE CHECK] No goodbye phrase: '×‘××™×–×• ×¢×™×¨ ××ª×” ×¦×¨×™×š ××ª ×”×—×©××œ××™?...'
18:21:29 web.1     | [REALTIME] event: response.content_part.done
18:21:29 web.1     | [REALTIME] event: response.output_item.done
18:21:29 web.1     | [REALTIME] event: response.done
18:21:29 web.1     | [REALTIME] event: rate_limits.updated
18:21:29 web.1     | [REALTIME] event: input_audio_buffer.speech_started
18:21:29 web.1     | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
18:21:29 web.1     | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
18:21:29 web.1     | [REALTIME] event: response.done
18:21:29 web.1     | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=83, voice_frames=0
18:21:29 web.1     | ğŸ¤ END OF UTTERANCE: 4.5s audio, conversation #2
18:21:29 web.1     | ğŸ§  STATE -> PROCESSING | len=72000 | silence_ms=1742
18:21:29 web.1     | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
18:21:29 web.1     | âœ… Processing complete for conversation #2
18:21:29 web.1     | [REALTIME] event: input_audio_buffer.speech_stopped
18:21:29 web.1     | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
18:21:29 web.1     | [REALTIME] event: input_audio_buffer.committed
18:21:29 web.1     | [REALTIME] event: conversation.item.created
18:21:29 web.1     | [REALTIME] event: response.created
18:21:29 web.1     | ğŸ¯ [REALTIME] Response started: resp_CiPI99pT4o7hXqtuacxOo
18:21:30 web.1     | ğŸ”‡ [AUDIO GATE] Blocked 800 noise frames (rms=8)
18:21:30 web.1     | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
18:21:30 web.1     | [REALTIME] event: response.output_item.added
18:21:30 web.1     | [REALTIME] event: conversation.item.created
18:21:30 web.1     | [REALTIME] event: response.content_part.added
18:21:30 web.1     | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
18:21:30 web.1     | âš ï¸ [AUDIO GAP] 1308ms gap between chunks #37 and #38 - OpenAI delay!
18:21:30 web.1     | âš ï¸ [BRIDGE GAP] 1309ms wait for queue - chunk #57
18:21:30 web.1     | [REALTIME] event: conversation.item.input_audio_transcription.completed
18:21:30 web.1     | [TRANSCRIPT FILTER] Ignoring hallucination: 'Yep.'
18:21:30 web.1     | [SAFETY] Transcription successful (total failures: 0)
18:21:31 web.1     | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
18:21:31 web.1     | [REALTIME] event: response.audio.done
18:21:31 web.1     | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
18:21:31 web.1     | [REALTIME] event: response.audio_transcript.done
18:21:31 web.1     | ğŸ¤– [REALTIME] AI said: ××¦×˜×¢×¨, ×× ×—× ×• ×›×¨×’×¢ ×œ× ×ª×•××›×™× ×‘×¢×™×¨ ×”×–×•. ×ª×•×“×” ×•×™×•× ×˜×•×‘.
18:21:31 web.1     | âš ï¸ [LOOP GUARD] AI responded 3 times without user input!
18:21:31 web.1     | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
18:21:31 web.1     | ğŸ›‘ [LOOP GUARD] Cleared TX queue
18:21:31 web.1     | ğŸ›‘ [LOOP GUARD] Sent clear to Twilio
18:21:31 web.1     | ğŸ’° [COST] AI utterance: 1.12s (57 chunks)
18:21:31 web.1     | [GOODBYE CHECK] No goodbye phrase: '××¦×˜×¢×¨, ×× ×—× ×• ×›×¨×’×¢ ×œ× ×ª×•××›×™× ×‘×¢...'
18:21:31 web.1     | [POLITE CLOSING] Detected: '×™×•× ×˜×•×‘'
18:21:31 web.1     | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
18:21:31 web.1     | [REALTIME] event: response.content_part.done
18:21:31 web.1     | [REALTIME] event: response.output_item.done
18:21:31 web.1     | [REALTIME] event: response.done
18:21:31 web.1     | [REALTIME] event: rate_limits.updated
18:21:31 web.1     | â³ [POLITE HANGUP] Starting wait for audio to finish...
18:21:31 web.1     | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
18:21:31 web.1     | â³ [POLITE HANGUP] TX queue still has 1 frames...
18:21:31 web.1     | ğŸ§¹ TX_CLEAR: SUCCESS
18:21:31 web.1     | âœ… [POLITE HANGUP] Twilio TX queue empty after 100ms
18:21:31 web.1     | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
18:21:31 web.1     | ğŸ™ï¸ REAL_VOICE: rms=159.0 > threshold=129.3
18:21:32 web.1     | ğŸ”‡ [AUDIO GATE] Blocked 900 noise frames (rms=8)
18:21:32 web.1     | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
18:21:32 web.1     | [REALTIME] event: input_audio_buffer.speech_started
18:21:32 web.1     | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
18:21:32 web.1     | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
18:21:33 web.1     | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3663, voice_frames=0
18:21:33 web.1     | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
18:21:33 web.1     | ğŸ“ [SMART HANGUP] === CALL ENDING ===
18:21:33 web.1     | ğŸ“ [SMART HANGUP] Reason: AI finished speaking politely
18:21:33 web.1     | ğŸ“ [SMART HANGUP] Lead captured: False
18:21:33 web.1     | ğŸ“ [SMART HANGUP] Goodbye detected: True
18:21:33 web.1     | ğŸ“ [SMART HANGUP] Lead state: {'service_type': '×ª×¨×¦×” ×¢×–×¨×”', 'city': '×œ×•×“'}
18:21:33 web.1     | ğŸ“ [SMART HANGUP] Required fields: ['name', 'service_type', 'city']
18:21:33 web.1     | ğŸ“ [SMART HANGUP] ===================
18:21:33 web.1     | âœ… [BUILD 163] Call CA607172... hung up successfully: AI finished speaking politely
18:21:34 web.1     | ğŸ“¨ Received: stop
18:21:34 web.1     | WS_STOP sid=MZabe7b1239aa28c45499f9a671de9d8ba rx=1435 tx=734
18:21:34 web.1     | âš ï¸ [BRIDGE GAP] 2400ms wait for queue - chunk #77
18:21:34 web.1     | ğŸ“¤ [REALTIME] Stop signal received
18:21:34 web.1     | ğŸ“¤ [REALTIME] Audio output bridge ended (sent 990 frames, 158400 bytes)
18:21:34 web.1     | ğŸ“¤ [REALTIME] Audio sender ended
18:21:34 web.1     | ğŸ“ [REALTIME] Text sender ended
18:21:34 web.1     | âš ï¸ DEV MODE: VALIDATE_TWILIO_SIGNATURE=false - signature validation skipped
18:21:34 web.1     | STREAM_ENDED call=CA607172e03135e3b1dbc9353ac4162b9b stream=N/A status=N/A
18:21:34 web.1     | INFO:     172.31.72.130:44702 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
18:21:34 web.1     | ğŸ§¹ Waiting for 5 background threads...
18:21:34 web.1     | âš ï¸ DEV MODE: VALIDATE_TWILIO_SIGNATURE=false - signature validation skipped
18:21:34 web.1     | INFO:     172.31.72.130:44702 - "POST /webhook/call_status HTTP/1.1" 204 No Content
18:21:34 web.1     | âœ… Found existing recording for CA607172e03135e3b1dbc9353ac4162b9b: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REb494a0686c7eb87dcdd13076b468a887.json
18:21:34 web.1     | âœ… Recording queued for processing: CA607172e03135e3b1dbc9353ac4162b9b
18:21:35 web.1     | âŒ Receive error: (<CloseCode.NO_STATUS_RCVD: 1005>, '')
18:21:35 web.1     | ğŸ”§ receive_loop ended
18:21:35 web.1     | INFO:     connection closed
18:21:35 web.1     | ğŸ”§ send_loop ended
18:21:37 web.1     | âš ï¸ Background thread 0 still running after timeout
18:21:40 web.1     | âš ï¸ Background thread 4 still running after timeout
18:21:40 web.1     | âœ… All background threads cleanup complete
18:21:40 web.1     | 
18:21:40 web.1     | ================================================================================
18:21:40 web.1     | ğŸ’°ğŸ’°ğŸ’° [CALL COST SUMMARY] ğŸ’°ğŸ’°ğŸ’°
18:21:40 web.1     | ================================================================================
18:21:40 web.1     | ğŸ“ Model: gpt-4o-realtime-preview
18:21:40 web.1     | â±ï¸  Total duration: 34.7s (0.6 min)
18:21:40 web.1     | ğŸ™ï¸  Audio IN (user speaking): 534 chunks (0.178 min)
18:21:40 web.1     |    â””â”€ Cost: 0.178 min Ã— $0.06/min = $0.0107
18:21:40 web.1     | ğŸ”Š Audio OUT (AI speaking): 57 chunks (0.019 min)
18:21:40 web.1     |    â””â”€ Cost: 0.019 min Ã— $0.24/min = $0.0046
18:21:40 web.1     | â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
18:21:40 web.1     | ğŸ’µ TOTAL COST: $0.0152 (â‰ˆ â‚ª0.06)
18:21:40 web.1     | ================================================================================
18:21:40 web.1     | 
18:21:40 web.1     | WS_DONE sid=MZabe7b1239aa28c45499f9a671de9d8ba rx=1435 tx=734
18:21:40 web.1     | âœ… MediaStreamHandler completed
18:21:40 web.1     | âœ… Handler thread join completed
18:21:43 web.1     | âœ… CALL FINALIZED: CA607172e03135e3b1dbc9353ac4162b9b
18:21:43 web.1     | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
18:21:43 web.1     | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×”×—×©××œ, ××š ×”×œ×§×•×— ××—×¤×© ×©×™×¨×•×ª ×‘×¢×™×¨ ×©××™× ×” × ×ª××›×ª ×¢×œ ×™×“×™ ×”×¢×¡×§.
18:21:43 web.1     | 
18:21:43 web.1     | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
18:21:43 web.1     | - ×”×œ×§×•×— ××—×¤×© ×—×©××œ××™.
18:21:43 web.1     | - ×”×¢×™×¨ ×”××‘×•×§×©×ª ×œ× ×¦×•×™× ×”, ××š ×”×œ×§×•×— ×¦×™×™×Ÿ ×›×™ ×”×•× ×œ× ×–×§×•×§ ×œ×©×™×¨×•×ª ×‘×œ×•×“.
18:21:43 web.1     | 
18:21:43 web.1     | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
18:21:43 web.1     | ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×œ×§×•×— ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
18:21:43 web.1     | 
18:21:43 web.1     | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
18:21:43 web.1     | - ×œ× × ×§×‘×¢×” ×¤×’×™×©×” ××• ×¤×¢×•×œ×” × ×•×¡×¤×ª, ×××—×¨ ×•×”×œ×§×•×— ×œ× ×§×™×‘×œ ×©×™×¨×•×ª ×‘×¢×™×¨ ×”××‘×•×§×©×ª.
18:21:43 web.1     | - ×“×—×™×¤×•×ª: × ××•×›×”, ××›×™×•×•×Ÿ ×©×”×©×™×—×” ×œ× ×”×ª×§×“××” ×œ×¤×ª×¨×•×Ÿ.
18:21:43 web.1     | 
18:21:43 web.1     | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
18:21:43 web.1     | ×—×©×•×‘ ×œ×¢×“×›×Ÿ ××ª ×”×œ×§×•×— ×œ×’×‘×™ ×”×¢×¨×™× ×”× ×ª××›×•×ª ×¢×œ ×™×“×™ ×”×¢×¡×§ ×•×œ×•×•×“× ×©×”××™×“×¢ ×–××™×Ÿ ×‘××ª×¨ ××• ×‘×©×™×¨×•×ª ×”×œ×§×•×—×•×ª. ×™×© ×œ×©×§×•×œ ×œ×”×¨×—×™×‘ ××ª ××–×•×¨×™ ×”×©×™×¨×•×ª ×›×“×™ ×œ×× ×•×¢ ××•×‘×“×Ÿ ×œ×§×•×—×•×ª ×¤×•×˜× ×¦×™××œ×™×™× ×‘×¢×ª×™×“.
18:21:43 web.1     | ğŸ¯ Intent: interested
18:21:43 web.1     | ğŸ“Š Next Action: ×©×œ×™×—×ª ×¤×¨×˜×™× × ×•×¡×¤×™×
18:21:43 web.1     | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
18:21:59 web.1     | [WA-SESSION] ğŸ“± Check #1: Found 0 stale sessions to process