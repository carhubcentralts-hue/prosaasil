LLUCINATION RULES (BUILD 112):
prosaas-backend  | 1. NEVER say "×§×‘×¢×ª×™"/"×”×¤×’×™×©×” × ×§×‘×¢×”" UNLESS you called calendar_create_appointment() THIS turn and got ok:true
prosaas-backend  | 2. NEVER say "×ª×¤×•×¡"/"×¤× ×•×™"/"×™×© ×ª×•×¨" UNLESS you called calendar_find_slots() THIS turn
prosaas-backend  | 3. NEVER say "×©×œ×—×ª×™ ××™×©×•×¨" UNLESS you called whatsapp_send() THIS turn
prosaas-backend  | 4. ğŸ”¥ BUILD 112: 
prosaas-backend  | ...
prosaas-backend  | ================================================================================
prosaas-backend  | ğŸ“… Today calculated as: 2025-12-05 (Friday)
prosaas-backend  | ğŸ“… Tomorrow calculated as: 2025-12-06
prosaas-backend  | ================================================================================
prosaas-backend  | 
prosaas-backend  | âœ… create_booking_agent RETURNED: True
prosaas-backend  | â±ï¸  AGENT_CREATION_TIME: 115ms
prosaas-backend  |   âœ… ×¤×¨×• ×¡××¡ (whatsapp): 340ms
prosaas-backend  |   âœ… ×¤×¨×• ×¡××¡ (whatsapp): 339msâœ… Warmed: ×¤×¨×• ×¡××¡ (calls)
prosaas-backend  | 
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (calls)
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (whatsapp)
prosaas-backend  | 
prosaas-backend  | ğŸ‰ WARMUP COMPLETE: 4 agents ready in 1823ms
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (whatsapp)
prosaas-backend  | 
prosaas-backend  | ğŸ‰ WARMUP COMPLETE: 4 agents ready in 1763ms
prosaas-backend  | âœ… DATA PROTECTION: 25 leads preserved (no deletions)
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (calls): 0ms
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (calls): 0ms
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (whatsapp): 0ms
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ğŸ”¥ğŸ”¥ WARMUP COMPLETE: 4/4 agents ready in 1109ms
prosaas-backend  | ğŸš€ System preheated - First AI response will be FAST!
prosaas-backend  | 
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (whatsapp): 0ms
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ğŸ”¥ğŸ”¥ WARMUP COMPLETE: 4/4 agents ready in 1098ms
prosaas-backend  | ğŸš€ System preheated - First AI response will be FAST!
prosaas-backend  | 
prosaas-backend  | ğŸ”„ Starting admin roles migration...
prosaas-backend  | âœ… Service warmup thread completed
prosaas-backend  | âœ… Service warmup thread completed
prosaas-backend  | ğŸ“Š Found 1 users with legacy roles
prosaas-backend  | ğŸ“ Business admin: 'admin@shai-realestate.co.il' (ID=7): admin -> admin (business_id=1)
prosaas-backend  | 
prosaas-backend  | âœ… Successfully migrated 1 users to new role structure!
prosaas-backend  | ğŸ‘¤ Admin exists (ID=8), resetting password to 'admin123'
prosaas-backend  | âœ… Admin password reset: admin@admin.com / admin123
prosaas-backend  | ğŸ”§ Starting database initialization...
prosaas-backend  | âœ… Business exists: ×¤×¨×• ×¡××¡ (ID: 1)
prosaas-backend  | âœ… System admin user exists: admin@admin.com (ID: 8, role: system_admin, business_id: None)
prosaas-backend  | 
prosaas-backend  | ğŸ“Š Total users in database: 6
prosaas-backend  |   - User 10: calliber@gmail.com | role=owner | business_id=10
prosaas-backend  |   - User 3: manager@shai-realestate.co.il | role=agent | business_id=1
prosaas-backend  |   - User 2: business@shai-offices.co.il | role=owner | business_id=1
prosaas-backend  |   - User 7: admin@shai-realestate.co.il | role=admin | business_id=1
prosaas-backend  |   - User 8: admin@admin.com | role=system_admin | business_id=None
prosaas-backend  |   - User 9: freezeb123@gmail.com | role=owner | business_id=1
prosaas-backend  | âœ… Lead statuses exist: 4 statuses found
prosaas-backend  | âœ… FAQs table exists: 0 FAQs found across all businesses
prosaas-backend  | âœ… Business settings exist (slot_size: 60min, 24/7: False)
prosaas-backend  | ğŸ‘¥ Checking user ownership...
prosaas-backend  | ğŸ”„ Starting User-to-Owner migration...
prosaas-backend  | ğŸ“Š Found 2 businesses
prosaas-backend  | âœ… Business '×¤×¨×• ×¡××¡' (ID=1) already has owner: business@shai-offices.co.il
prosaas-backend  | âœ… Business '×§×œ×™×‘×¨' (ID=10) already has owner: calliber@gmail.com
prosaas-backend  | 
prosaas-backend  | âœ… User-to-Owner migration completed!
prosaas-backend  | 
prosaas-backend  | âœ… All businesses have owners!
prosaas-backend  | âœ… User ownership check completed
prosaas-backend  | âœ… Database initialization completed successfully!
prosaas-backend  | ğŸ“§ Admin login: admin@admin.com / admin123
prosaas-backend  | ğŸ¢ Business ID: 1
prosaas-backend  | âœ… DATA PROTECTION: 0 FAQs preserved (no deletions)
prosaas-backend  | âœ… DATA PROTECTION: 25 leads preserved (no deletions)
prosaas-backend  | ğŸ”„ Starting admin roles migration...
prosaas-backend  | ğŸ“Š Found 1 users with legacy roles
prosaas-backend  | ğŸ“ Business admin: 'admin@shai-realestate.co.il' (ID=7): admin -> admin (business_id=1)
prosaas-backend  | 
prosaas-backend  | âœ… Successfully migrated 1 users to new role structure!
prosaas-backend  | ğŸ‘¤ Admin exists (ID=8), resetting password to 'admin123'
prosaas-backend  | âœ… Admin password reset: admin@admin.com / admin123
prosaas-backend  | ğŸ”§ Starting database initialization...
prosaas-backend  | âœ… Business exists: ×¤×¨×• ×¡××¡ (ID: 1)
prosaas-backend  | âœ… System admin user exists: admin@admin.com (ID: 8, role: system_admin, business_id: None)
prosaas-backend  | 
prosaas-backend  | ğŸ“Š Total users in database: 6
prosaas-backend  |   - User 10: calliber@gmail.com | role=owner | business_id=10
prosaas-backend  |   - User 3: manager@shai-realestate.co.il | role=agent | business_id=1
prosaas-backend  |   - User 2: business@shai-offices.co.il | role=owner | business_id=1
prosaas-backend  |   - User 7: admin@shai-realestate.co.il | role=admin | business_id=1
prosaas-backend  |   - User 8: admin@admin.com | role=system_admin | business_id=None
prosaas-backend  |   - User 9: freezeb123@gmail.com | role=owner | business_id=1
prosaas-backend  | âœ… Lead statuses exist: 4 statuses found
prosaas-backend  | âœ… FAQs table exists: 0 FAQs found across all businesses
prosaas-backend  | âœ… Business settings exist (slot_size: 60min, 24/7: False)
prosaas-backend  | ğŸ‘¥ Checking user ownership...
prosaas-backend  | ğŸ”„ Starting User-to-Owner migration...
prosaas-backend  | ğŸ“Š Found 2 businesses
prosaas-backend  | âœ… Business '×¤×¨×• ×¡××¡' (ID=1) already has owner: business@shai-offices.co.il
prosaas-backend  | âœ… Business '×§×œ×™×‘×¨' (ID=10) already has owner: calliber@gmail.com
prosaas-backend  | 
prosaas-backend  | âœ… User-to-Owner migration completed!
prosaas-backend  | 
prosaas-backend  | âœ… All businesses have owners!
prosaas-backend  | âœ… User ownership check completed
prosaas-backend  | âœ… Database initialization completed successfully!
prosaas-backend  | ğŸ“§ Admin login: admin@admin.com / admin123
prosaas-backend  | ğŸ¢ Business ID: 1
prosaas-backend  | INFO:     127.0.0.1:56346 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:36536 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:36552 - "GET /api/auth/me HTTP/1.1" 401 Unauthorized
prosaas-backend  | ğŸ” LOGIN ATTEMPT: email=calliber@gmail.com
prosaas-backend  | âœ“ Found user: id=10, email=calliber@gmail.com, role=owner
prosaas-backend  | âœ“ Password hash: scrypt:32768:8:1$NwJjYhcFJjcNjejm$9cc6e19d7dbac0ba...
prosaas-backend  | âœ“ Password verification result: True
prosaas-backend  | ğŸ” LOGIN SUCCESS: user_id=10, email=calliber@gmail.com, role=owner, business_id=10
prosaas-backend  | INFO:     172.18.0.6:36564 - "POST /api/auth/login HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:36568 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:36578 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:36586 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     127.0.0.1:49480 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:36594 - "GET /api/dashboard/stats?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:36604 - "GET /api/dashboard/activity?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:36612 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:36618 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | [WA-SESSION] ğŸ“± Check #1: Found 0 stale sessions to process
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:53486 - "GET /api/calls?search=&status=all&direction=all&limit=25&offset=0 HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:53500 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:53514 - "GET /api/leads HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:47338 - "POST /api/outbound_calls/start HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:47354 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:47370 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:42902 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:42916 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:42932 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | INFO:     172.18.0.6:42936 - "POST /webhook/outbound_call?call_id=690&lead_id=79&lead_name=%D7%9C%D7%9C%D7%90%20%D7%A9%D7%9D&business_id=10&business_name=%D7%A7%D7%9C%D7%99%D7%91%D7%A8 HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | INFO:     172.18.0.6:42954 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-48016361
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+972504294724'
prosaas-backend  |    ğŸ“¤ OUTBOUND CALL: lead=×œ×œ× ×©×, template=None
prosaas-backend  | ğŸ¯ [T0=1764955537.146] WS_START sid=MZ89306ca74ba1df4e95ff43ef57cf9621 call_sid=CA0b3c4e449c19cad3402961fcffe76402 from=None to=+972504294724 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA0b3c4e (FRESH SESSION)
prosaas-backend  | ğŸ”’ OUTBOUND CALL: Using explicit business_id=10 (NOT phone-based resolution)
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 465ms (T0+471ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:42948 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | âœ… OUTBOUND: Loaded business ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ“¤ [OUTBOUND] Disabling all call control settings - AI follows prompt only!
prosaas-backend  |    âœ“ auto_end=OFF, silence_timeout=120s, smart_hangup=OFF, loop_guard_max=20
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1078ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=False
prosaas-backend  |    auto_end_lead=False, silence_timeout=120s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=[]
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=False
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1185ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA0b3c4e449c19cad3402961fcffe76402
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764955538.332] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1186ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=9.9, threshold=110.0)
prosaas-backend  | 
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 719ms
prosaas-backend  | ğŸ“¤ [OUTBOUND GREETING] Building greeting for lead: ×œ×œ× ×©×
prosaas-backend  | ğŸ“¤ [OUTBOUND GREETING] Using minimal greeting (DB error)
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=321 chars (direction=outbound)
prosaas-backend  | INFO:     127.0.0.1:34022 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… Recording already active for CA0b3c4e449c19cad3402961fcffe76402: RE17e20fd35cfbdbc6659984b750bee7b1
prosaas-backend  | âœ… Call log already exists for CA0b3c4e449c19cad3402961fcffe76402
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1064ms (total: 2248ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764955539.400
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 2248ms
prosaas-backend  | ğŸ“¤ [OUTBOUND CRM] Using existing lead_id=79
prosaas-backend  | âœ… [CRM] Context ready (background): lead_id=79, direction=outbound
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTql4XLultlccd...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTql4XLultlccd... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764955540.266 (duration: 866ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=120s, max_warnings=0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×œ×œ× ×©×, ×§×œ×™×‘×¨.
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 0ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×œ× ×©×, ×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (19ms, frames=0)
prosaas-backend  | ğŸ“¤ [OUTBOUND] Using outbound prompt with greeting for: ×œ×œ× ×©×
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 0.0s - now updating session
prosaas-backend  | ğŸ“ [OUTBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 1699 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1190.0 > threshold=110.0
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=61 57 4e 4a 48, rms=3892, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=57 7a 57 3e 2f, rms=4533, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=b5 d0 4f 3c 31, rms=4564, consec_frames=5
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.1s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=17600 | silence_ms=501
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTqrMz9L8n6ApD...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTqrMz9L8n6ApD... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '××” ×§×•×¨×”?' (len=8)
prosaas-backend  | INFO:     172.18.0.6:60770 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '××” ×§×•×¨×”?...' despite low RMS=8)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '××” ×§×•×¨×”?' (hebrew_chars=6)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '××” ×§×•×¨×”?'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '××” ×§×•×¨×”?' (hebrew=6, english=0)
prosaas-backend  | [STT_FINAL] '××” ×§×•×¨×”?' (from raw: '××” ×§×•×¨×”?...')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.95s (71 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ××” ×§×•×¨×”?
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '××” ×§×•×¨×”?...' - processing as answer to greeting question
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '××” ×§×•×¨×”?...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '××” ×§×•×¨×”?...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['××” ×§×•×¨×”?']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 486e5c5f...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=486e5c5f...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: True
prosaas-backend  | ğŸ” [DEBUG] CRM data - name: 'None', phone: 'None'
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××” ×§×•×¨×”?...'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.createdğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×œ×œ× ×©×, ×§×œ×™×‘×¨.', 'ts': 1764955540.2663002}, {'speaker': 'user', 'text': '××” ×§×•×¨×”?', 'ts': 1764955547.1196241}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7d 7b 7e 7e 7b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=b4 ae b3 b5 d8
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=ee da cc c1 c5
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨××™×ª×™ ×©×”×ª×¢× ×™×™× ×ª ×‘×¢×‘×¨ ×‘×—×©××œ××™ ×“×¨×š ×§×œ×™×‘×¨ ×•×¨×¦×™×ª×™ ×œ×‘×“×•×§ ×× ×›×‘×¨ ×”×¡×ª×“×¨×ª.
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.67s (22 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨××™×ª×™ ×©×”×ª×¢× ×™×™× ×ª ×‘×¢×‘×¨ ×‘×—×©××œ××™ ×“...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': None, 'time': None, 'name': None, 'phone': None, 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=18, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=738.0 > threshold=110.0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=72 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=41, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=15, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 2.0s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=31360 | silence_ms=501
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTr2eOEIVTfFf1...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTr2eOEIVTfFf1... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ× ×”×ª×§× ×ª×™.' (len=10)
prosaas-backend  | INFO:     172.18.0.6:55720 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=15, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ× ×”×ª×§× ×ª×™....' despite low RMS=11)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×œ× ×”×ª×§× ×ª×™.' (hebrew_chars=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ× ×”×ª×§× ×ª×™.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ× ×”×ª×§× ×ª×™.' (hebrew=8, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (10889ms)
prosaas-backend  | [STT_FINAL] '×œ× ×”×ª×§× ×ª×™.' (from raw: '×œ× ×”×ª×§× ×ª×™....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.21s (182 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ× ×”×ª×§× ×ª×™.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ× ×”×ª×§× ×ª×™.' - user is rejecting/correcting
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ× ×”×ª×§× ×ª×™....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ× ×”×ª×§× ×ª×™....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['××” ×§×•×¨×”?', '×œ× ×”×ª×§× ×ª×™.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 0dcaa14d...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (486e5c5f â†’ 0dcaa14d) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=0dcaa14d...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: True
prosaas-backend  | ğŸ” [DEBUG] CRM data - name: 'None', phone: 'None'
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ× ×”×ª×§× ×ª×™....'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '××” ×§×•×¨×”?', 'ts': 1764955547.1196241}, {'speaker': 'ai', 'text': '×¨××™×ª×™ ×©×”×ª×¢× ×™×™× ×ª ×‘×¢×‘×¨ ×‘×—×©××œ××™ ×“×¨×š ×§×œ×™×‘×¨ ×•×¨×¦×™×ª×™ ×œ×‘×“×•×§ ×× ×›×‘×¨ ×”×¡×ª×“×¨×ª.', 'ts': 1764955547.7961423}, {'speaker': 'user', 'text': '×œ× ×”×ª×§× ×ª×™.', 'ts': 1764955558.0127766}]
prosaas-backend  | 
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7e 7d 7e 7d 7e
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=45 3b 3d 3d 3d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=ec ec 7b 69 5d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 5 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××” ×‘×“×™×•×§ ×”×‘×¢×™×” ×©××ª×” ×¦×¨×™×š ×‘×” ×¢×–×¨×”?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.01s (32 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××” ×‘×“×™×•×§ ×”×‘×¢×™×” ×©××ª×” ×¦×¨×™×š ×‘×” ×¢×–...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 5 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (6ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=620.0 > threshold=110.0
prosaas-backend  | [PIPELINE STATUS] sent=183 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=786, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTr9RTjzZsBYm5...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTr9RTjzZsBYm5... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.' (len=27)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.' (hebrew=21, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6332ms)
prosaas-backend  | [STT_FINAL] '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.' (from raw: '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.77s (302 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['××” ×§×•×¨×”?', '×œ× ×”×ª×§× ×ª×™.', '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 0b85fd39...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (0dcaa14d â†’ 0b85fd39) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=0b85fd39...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: True
prosaas-backend  | ğŸ” [DEBUG] CRM data - name: 'None', phone: 'None'
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª....'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ× ×”×ª×§× ×ª×™.', 'ts': 1764955558.0127766}, {'speaker': 'ai', 'text': '××” ×‘×“×™×•×§ ×”×‘×¢×™×” ×©××ª×” ×¦×¨×™×š ×‘×” ×¢×–×¨×”?', 'ts': 1764955558.0185597}, {'speaker': 'user', 'text': '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.', 'ts': 1764955564.3407595}]
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fd fc fd fd fd
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=11, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d7 f6 48 f8 e9
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=c5 ba c9 bb be
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 3200 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.26s (38 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (76ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=195.0 > threshold=110.0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=303 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | INFO:     172.18.0.6:53484 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | INFO:     127.0.0.1:35816 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:53488 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTrEZxsdtRknZA...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTrEZxsdtRknZA... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×‘×¢×¤×•×œ×”.' (len=7)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 900 frames (rms=9, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×‘×¢×¤×•×œ×”....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×‘×¢×¤×•×œ×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×‘×¢×¤×•×œ×”.' (hebrew=6, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6654ms)
prosaas-backend  | [STT_FINAL] '×‘×¢×¤×•×œ×”.' (from raw: '×‘×¢×¤×•×œ×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.41s (376 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×‘×¢×¤×•×œ×”.
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×‘×¢×¤×•×œ×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×‘×¢×¤×•×œ×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 8
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['××” ×§×•×¨×”?', '×œ× ×”×ª×§× ×ª×™.', '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.', '×‘×¢×¤×•×œ×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: e6d31286...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (0b85fd39 â†’ e6d31286) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=e6d31286...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: True
prosaas-backend  | ğŸ” [DEBUG] CRM data - name: 'None', phone: 'None'
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×‘×¢×¤×•×œ×”....'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 8 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×”×•× ×¢×œ×•×œ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª.', 'ts': 1764955564.3407595}, {'speaker': 'ai', 'text': '×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955564.8961134}, {'speaker': 'user', 'text': '×‘×¢×¤×•×œ×”.', 'ts': 1764955570.9947233}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fe ff ff 7d 7b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=55 3f 3d 41 37
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=ce 73 7a fe ef
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×× ×™ ××¢×‘×™×¨×” ×¢×›×©×™×• ××ª ×”×¤×¨×˜×™×â€”×‘×¢×œ ××§×¦×•×¢ ×™×—×–×•×¨ ××œ×™×š ×××© ×‘×§×¨×•×‘.
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.43s (59 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××¦×•×™×Ÿ, ×× ×™ ××¢×‘×™×¨×” ×¢×›×©×™×• ××ª ×”×¤×¨...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (4ms, frames=0)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1000 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=436.0 > threshold=110.0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=377 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | WS_STOP sid=MZ89306ca74ba1df4e95ff43ef57cf9621 rx=2087 tx=837
prosaas-backend  | ğŸ“ [SES-48016361] CALL ENDED - duration=41.5s, business_id=10, rx=2087, tx=837
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA0b3c4e449c19cad3402961fcffe76402 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:52872 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA0b3c4e449c19cad3402961fcffe76402: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE17e20fd35cfbdbc6659984b750bee7b1.json
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | INFO:     172.18.0.6:52888 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | âœ… Recording queued for processing: CA0b3c4e449c19cad3402961fcffe76402
prosaas-backend  | INFO:     connection closed
prosaas-backend  | INFO:     172.18.0.6:52902 - "GET /api/outbound_calls/counts HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | INFO:     172.18.0.6:52914 - "GET /api/calls?search=&status=all&direction=all&limit=25&offset=0 HTTP/1.1" 200 OK
prosaas-backend  | âœ… CALL FINALIZED: CA0b3c4e449c19cad3402961fcffe76402
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×¤× ×™×™×” ×‘×ª×—×•× ×”× ×“×œ"×Ÿ, ×œ×§×•×— ××ª×¢× ×™×™×Ÿ ×‘×©×™×¨×•×ª×™ ×—×©××œ××™ ×“×¨×š ×§×œ×™×‘×¨.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | ×”×œ×§×•×— ××ª××•×“×“ ×¢× ×‘×¢×™×™×ª ×—×©××œ ×—××•×¨×” â€“ × ×¤×œ ×›×œ ×”×—×©××œ ×‘×‘×™×ª. ×”×•× ×–×§×•×§ ×œ×©×™×¨×•×ª×™ ×—×©××œ××™ ××§×¦×•×¢×™.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×”×œ×§×•×— × ××¦× ×‘×¢×¤×•×œ×”. ×œ× × ××¡×¨×• ×¤×¨×˜×™× × ×•×¡×¤×™× ×›××• ×©× ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | ×”×¢×•×–×¨ ×”×¢×‘×™×¨ ××ª ×”×¤×¨×˜×™× ×œ×‘×¢×œ ××§×¦×•×¢, ××©×¨ ×¦×¤×•×™ ×œ×—×–×•×¨ ×œ×œ×§×•×— ×‘×§×¨×•×‘. ×“×—×™×¤×•×ª ×”×¤× ×™×™×” ×”×™× ×’×‘×•×”×”, ×‘×©×œ ×”×‘×¢×™×” ×”×—××•×¨×” ×¢× ×”×—×©××œ ×‘×‘×™×ª.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×—×©××œ××™ ×©×™×—×–×•×¨ ×œ×œ×§×•×— ××ª×•×× ×¢× ×‘×¢×™×•×ª ×—×©××œ ×“×—×•×¤×•×ª, ×•×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××¢× ×” ××”×™×¨. ××•××œ×¥ ×œ×¢×§×•×‘ ××—×¨×™ ×”×¤× ×™×™×” ×›×“×™ ×œ×•×•×“× ×©×”×‘×¢×™×” × ×¤×ª×¨×” ×œ×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ ×”×œ×§×•×—.
prosaas-backend  | ğŸ¯ Intent: information_request
prosaas-backend  | ğŸ“Š Next Action: ××ª×Ÿ ××™×“×¢ ××¤×•×¨×˜
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ89306ca74ba1df4e95ff43ef57cf9621 rx=2087 tx=837
prosaas-backend  | âœ… [CRM] Updated lead #79: summary=True, status=None
prosaas-backend  | âœ… [CRM] Lead #79 updated with call summary
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  |    - call_log.from_number: +97233762734
prosaas-backend  |    - crm_context.customer_phone: None
prosaas-backend  |    âœ“ Using CallLog from_number: +97233762734
prosaas-backend  | ğŸ¯ [WEBHOOK] Found LAST professional in transcript: ×—×©××œ××™ (pos=64)
prosaas-backend  | ğŸ“‹ [WEBHOOK] Enriching from Lead #79
prosaas-backend  |    â””â”€ City from transcript (fuzzy): ×¢×¤×•×œ×” (confidence=100%)
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA0b3c4e449c19cad3402961fcffe76402, phone=+97233762734, city=×¢×¤×•×œ×”, direction=outbound
prosaas-backend  | [WEBHOOK] No outbound webhook URL configured for business 10 - skipping
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+97233762734, city=×¢×¤×•×œ×”, service=×—×©××œ××™
prosaas-backend  | INFO:     172.18.0.6:52378 - "GET /api/calls?search=&status=all&direction=all&limit=25&offset=0 HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.6:52394 - "GET /api/calls/CA0b3c4e449c19cad3402961fcffe76402/details HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:50740 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:44588 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA6ab23caa61927c7238b4a57ff25b12f2
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA6ab23caa61927c7238b4a57ff25b12f2
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA6ab23caa61927c7238b4a57ff25b12f2ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1277ms - CA6ab23caa61927c
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA6ab23caa61927c7238b4a57ff25b12f2" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | INFO:     172.18.0.6:45418 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:43402 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-37270dcd
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764955612.827] WS_START sid=MZd1d62fe76d96ebe86d0c20e4258e8186 call_sid=CA6ab23caa61927c7238b4a57ff25b12f2 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA6ab23c (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 443ms (T0+444ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1065ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1170ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA6ab23caa61927c7238b4a57ff25b12f2
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764955613.998] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1171ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.8, threshold=108.8)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 730ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1ms (total: 1174ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764955614.002
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1174ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTry7mABSOCo5N...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTry7mABSOCo5N... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Call log already exists for CA6ab23caa61927c7238b4a57ff25b12f2
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Recording started for CA6ab23caa61927c7238b4a57ff25b12f2: RE0b8a1f052c39a0b814bd92932979e5b2
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764955615.297 (duration: 1295ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (32ms, frames=0)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×××ª×¨' (confidence=57%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1405ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.5s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (18ms, frames=0)
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=912.0 > threshold=108.8
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=5b 5d 6c ed e1, rms=3965, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=24 24 28 2d 32, rms=4625, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=dd 7a 4f 39 30, rms=4418, consec_frames=5
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3298, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=4469, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3967, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=152 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTs7lPpDgisTPT...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTs7lPpDgisTPT... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=8, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' (len=31)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' â†’ '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ...' despite low RMS=8)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (hebrew_chars=31)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (hebrew=31, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×...')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.81s (170 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....' - processing as answer to greeting question
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=135.0 > threshold=108.8
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×—×›×' (confidence=54%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 762c8f0d...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=762c8f0d...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764955615.297728}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', 'ts': 1764955624.3259254}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=c8 bd bf c0 c6
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=e1 ce c6 be bb
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=48 eb c4 c0 b1
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 4800 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (16ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:52650 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=149.0 > threshold=108.8
prosaas-backend  | [PIPELINE STATUS] sent=172 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=4261, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | INFO:     127.0.0.1:34396 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTsDJUfVq7ACOm...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTsDJUfVq7ACOm... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×œ×™××˜ ×˜×˜×.' (len=10)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | [STT_REPAIRED] '×§×œ×™××˜ ×˜×˜×.' â†’ '×§×œ×™×‘×¨.'
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×œ×™×‘×¨....' despite low RMS=9)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×§×œ×™×‘×¨.' (hebrew_chars=5)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×œ×™×‘×¨.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×œ×™×‘×¨.' (hebrew=5, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6435ms)
prosaas-backend  | [STT_FINAL] '×§×œ×™×‘×¨.' (from raw: '×§×œ×™××˜ ×˜×˜×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 4.86s (247 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×œ×™×‘×¨.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×™×‘×¨' (confidence=77%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×§×œ×™×‘×¨.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 9264a8b7...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (762c8f0d â†’ 9264a8b7) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=9264a8b7...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', 'ts': 1764955624.3259254}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955625.2963924}, {'speaker': 'user', 'text': '×§×œ×™×‘×¨.', 'ts': 1764955630.7604191}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=e1 df ec fb 5e
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=e6 4c 3a 38 f5
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=d9 ca ce d4 6e
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=10, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.47s (26 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×× ×¢×•×œ ×—×›×' (confidence=51%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (8ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1116.0 > threshold=108.8
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=248 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTsLHQi5bMImkT...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTsLHQi5bMImkT... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '× ×›×•×Ÿ.' (len=5)
prosaas-backend  | WS_STOP sid=MZd1d62fe76d96ebe86d0c20e4258e8186 rx=1259 tx=527
prosaas-backend  | ğŸ“ [SES-37270dcd] CALL ENDED - duration=25.1s, business_id=10, rx=1259, tx=527
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA6ab23caa61927c7238b4a57ff25b12f2 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:39326 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | INFO:     172.18.0.6:39342 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA6ab23caa61927c7238b4a57ff25b12f2: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE0b8a1f052c39a0b814bd92932979e5b2.json
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | âœ… Recording queued for processing: CA6ab23caa61927c7238b4a57ff25b12f2
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '× ×›×•×Ÿ....' despite low RMS=11)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '× ×›×•×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '× ×›×•×Ÿ.' (hebrew=4, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7953ms)
prosaas-backend  | [STT_FINAL] '× ×›×•×Ÿ.' (from raw: '× ×›×•×Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.21s (306 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: × ×›×•×Ÿ.
prosaas-backend  | âœ… [BUILD 176] User CONFIRMED with '× ×›×•×Ÿ.' - verification_confirmed = True
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '× ×›×•×Ÿ.' (confidence=48%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '× ×›×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '× ×›×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×§×œ×™×‘×¨.', '× ×›×•×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 6281d25d...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (9264a8b7 â†’ 6281d25d) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=6281d25d...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '× ×›×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fe fd fd fe fe
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=f2 f1 69 60 5b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=2e 29 2e 2d 35
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×§×œ×™×‘×¨.', 'ts': 1764955630.7604191}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?', 'ts': 1764955631.2928271}, {'speaker': 'user', 'text': '× ×›×•×Ÿ.', 'ts': 1764955638.7133467}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | INFO:     connection closed
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 24 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.84s (50 chunks)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×œ×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city': '×¢×œ×™'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××œ×™×š
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city': '×¢×œ×™', 'raw_city': '××œ×™×š'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=84.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city': '×¢×œ×™', 'raw_city': '××œ×™×š', 'city_confidence': '84.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city': '×¢×œ×™', 'raw_city': '××œ×™×š', 'city_confidence': '84.0', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×¢×œ×™' (confidence=84%)
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP] User confirmed all details - disconnecting
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (reason: user_verified)
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 24 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… CALL FINALIZED: CA6ab23caa61927c7238b4a57ff25b12f2
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×”×©×™×¨×•×ª×™× ×”×‘×™×ª×™×™×, ×¡×¤×¦×™×¤×™×ª ×‘×ª×—×•× ×”×× ×¢×•×œ×™×. ×”×œ×§×•×— ××—×¤×© ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | - **××™×§×•×**: ×§×¨×™×™×ª ××ª×
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | - **×©× ×”×œ×§×•×—**: ×œ× × ××¡×¨
prosaas-backend  | - **×××¦×¢×™ ×”×ª×§×©×¨×•×ª**: ×œ× × ××¡×¨
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×œ×§×‘×•×¢ ××•×¢×“ ×œ×”×ª×§× ×”
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×œ× ×¦×•×™× ×” ×“×—×™×¤×•×ª, ××š ××•××œ×¥ ×œ×¤×¢×•×œ ×‘××”×™×¨×•×ª ×›×“×™ ×œ× ×œ××‘×“ ××ª ×”×œ×§×•×—.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×—×©×•×‘ ×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××ª ×”××™×“×¢ ×”× ×“×¨×© ×œ×’×‘×™ ×¡×•×’×™ ×”×× ×¢×•×œ×™× ×”×—×›××™× ×”×–××™× ×™×, ×›×•×œ×œ ×™×ª×¨×•× ×•×ª×™×”× ×•×”×ª×§× ×”. ×™×© ×œ×©×§×•×œ ×”×¦×¢×ª ×©×™×¨×•×ª×™× × ×•×¡×¤×™× ×›××• ×ª×—×–×•×§×” ××• ×ª×™×§×•×Ÿ ×× ×¢×•×œ×™× ×§×™×™××™×.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city': '×¢×œ×™', 'raw_city': '××œ×™×š', 'city_confidence': '84.0', 'city_needs_confirmation': 'True'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA6ab23caa61927c7238b4a57ff25b12f2, phone=+972504294724, city=×¢×œ×™, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×¢×œ×™, service=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | âœ… Background thread 4 completed
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZd1d62fe76d96ebe86d0c20e4258e8186 rx=1259 tx=527
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CAbe3e40ba6e33d7b1c9d723ee565d8673
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CAbe3e40ba6e33d7b1c9d723ee565d8673
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CAbe3e40ba6e33d7b1c9d723ee565d8673ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | âœ… incoming_call: 1268ms - CAbe3e40ba6e33d7
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CAbe3e40ba6e33d7b1c9d723ee565d8673" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.6:38074 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:38086 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-4d1f57d7
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764955646.368] WS_START sid=MZc91fdf585c1098a962673cba06a69f85 call_sid=CAbe3e40ba6e33d7b1c9d723ee565d8673 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CAbe3e40 (FRESH SESSION)
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 470ms (T0+470ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1053ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1157ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CAbe3e40ba6e33d7b1c9d723ee565d8673
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764955647.527] STORING GREETING FOR REALTIME!
prosaas-backend  | 
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1160ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=16.0, threshold=116.0)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 693ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1ms (total: 1163ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764955647.531
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1163ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTsVRNLb25wkff...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTsVRNLb25wkff... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Call log already exists for CAbe3e40ba6e33d7b1c9d723ee565d8673
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Recording started for CAbe3e40ba6e33d7b1c9d723ee565d8673: RE551c85419cedfc5b0151cab03cb42ee3
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764955648.903 (duration: 1372ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (29ms, frames=0)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTsWZ1LupVwLOO...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTsWZ1LupVwLOO... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=5f df eb 5d ed
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=c9 b7 c9 3b 29
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=3a 2e 35 32 34
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 39 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?...'
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.74s (65 chunks)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '× ××ª×¨' (confidence=54%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1544ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.8s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (22ms, frames=0)
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city': '×¢×œ×™', 'raw_city': '××œ×™×š', 'city_confidence': '84.0', 'city_needs_confirmation': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×××ª×¨' (confidence=57%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 39 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=16, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=735.0 > threshold=116.0
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=4b 54 70 e8 cd, rms=3755, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=a7 9e 97 98 98, rms=6308, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=1f 22 30 42 e5, rms=5038, consec_frames=5
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1676, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=149, voice_frames=0
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=39, tx_q=0) retry #10
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTsfNBDjZkGt8Z...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTsfNBDjZkGt8Z... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=26)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥...' despite low RMS=14)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew_chars=30)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew=30, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.17s (140 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....' - processing as answer to greeting question
prosaas-backend  | INFO:     172.18.0.6:34664 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 2.9s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=46720 | silence_ms=1888
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×ª×•×ª' (confidence=43%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: f6be4cd2...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=f6be4cd2...)INFO:     127.0.0.1:53920 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | 
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...[SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764955648.9027505}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764955657.8239033}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=48 3e 44 46 4b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=bc b4 ba b9 b7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=54 50 5d 5f f3
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (21ms, frames=0)
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=39, tx_q=0) retry #20
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=39, tx_q=0) retry #30
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1243.0 > threshold=116.0
prosaas-backend  | [PIPELINE STATUS] sent=141 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.0s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=15680 | silence_ms=516
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTsl2Tj0t4rFFJ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTsl2Tj0t4rFFJ... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¤×•×œ×”.' (len=5)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=9, reason=noise)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×¤×•×œ×”....' despite low RMS=8)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×¤×•×œ×”.' (hebrew_chars=4)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×¤×•×œ×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¤×•×œ×”.' (hebrew=4, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6352ms)
prosaas-backend  | [STT_FINAL] '×¤×•×œ×”.' (from raw: '×¤×•×œ×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.13s (202 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¤×•×œ×”.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¤×•×œ×”.' (confidence=42%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¤×•×œ×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¤×•×œ×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×¤×•×œ×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: e8ccf477...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (f6be4cd2 â†’ e8ccf477) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=e8ccf477...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...[GOODBYE CHECK] No goodbye phrase: '×¤×•×œ×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messagesğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764955657.8239033}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955658.7274733}, {'speaker': 'user', 'text': '×¤×•×œ×”.', 'ts': 1764955664.1765893}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f9 ed eb ed 7d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=dd c6 cd 5e 5a
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=f5 bf ff 4d 56
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.45s (23 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (49ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×¤×•×œ×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×¤×•×œ×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×¤×•×œ×”', 'raw_city': '×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×¤×•×œ×”', 'raw_city': '×¢×¤×•×œ×”', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×¢×¤×•×œ×”' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×¤×•×œ×”', 'raw_city': '×¢×¤×•×œ×”', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=162.0 > threshold=116.0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | WS_STOP sid=MZc91fdf585c1098a962673cba06a69f85 rx=1159 tx=512
prosaas-backend  | ğŸ“ [SES-4d1f57d7] CALL ENDED - duration=23.1s, business_id=10, rx=1159, tx=512
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CAbe3e40ba6e33d7b1c9d723ee565d8673 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:60030 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | INFO:     172.18.0.6:60032 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CAbe3e40ba6e33d7b1c9d723ee565d8673: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE551c85419cedfc5b0151cab03cb42ee3.json
prosaas-backend  | âœ… Recording queued for processing: CAbe3e40ba6e33d7b1c9d723ee565d8673
prosaas-backend  | INFO:     connection closed
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âœ… CALL FINALIZED: CAbe3e40ba6e33d7b1c9d723ee565d8673
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×”×× ×¢×•×œ× ×•×ª, ×¡×¤×¦×™×¤×™×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×¤×•×¨×¥ ×“×œ×ª×•×ª
prosaas-backend  | - **××™×§×•×**: ×¢×¤×•×œ×”
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×©× ×”×œ×§×•×— ×œ× × ××¡×¨, ××š ×”×•× × ××¦× ×‘×¢×™×¨ ×¢×¤×•×œ×”.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×™×© ×œ×ª×× ×‘×™×§×•×¨ ×©×œ ×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×œ× ×¦×•×™× ×” ×“×—×™×¤×•×ª, ××š ×™×© ×œ×”× ×™×— ×›×™ ××“×•×‘×¨ ×‘××¦×‘ ×“×—×•×£.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ×©×™×¨×•×ª ××”×™×¨ ×•×™×¢×™×œ, ×©×›×Ÿ ××“×•×‘×¨ ×‘×©×™×¨×•×ª ×—×™×¨×•×. ××•××œ×¥ ×œ×”×¦×™×¢ ×–××™× ×•×ª ×’×‘×•×”×” ×•×œ×•×•×“× ×©×”×˜×›× ××™ ×”××’×™×¢ ××¦×•×™×“ ×‘×›×œ×™× ×”× ×“×¨×©×™× ×œ×¤×ª×¨×•×Ÿ ×”×‘×¢×™×”.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×•×¨×¥ ×“×œ×ª×•×ª'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×¢×¤×•×œ×”', 'raw_city': '×¢×¤×•×œ×”', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CAbe3e40ba6e33d7b1c9d723ee565d8673, phone=+972504294724, city=×¢×¤×•×œ×”, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×¢×¤×•×œ×”, service=×¤×•×¨×¥ ×“×œ×ª×•×ª
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | âœ… Background thread 4 completed
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZc91fdf585c1098a962673cba06a69f85 rx=1159 tx=512
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×¤×•×œ×”, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTt4S8psysoNL3...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTt4S8psysoNL3... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=d7 e8 d5 be d0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=fc fb fb fb fa
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=57 3e 38 2b 2f
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 17 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€” ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.97s (40 chunks)
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×¢×“×™×™×Ÿ' differs from locked '×¢×¤×•×œ×”'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×¢×¤×•×œ×”' (reason: user_said_×¢×“×™×™×Ÿ)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×¤×•×œ×”', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×¢×“×™' (confidence=90%)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 17 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA555ce8121c65b8faccc9adf7fc80a110
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA555ce8121c65b8faccc9adf7fc80a110
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA555ce8121c65b8faccc9adf7fc80a110ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1351ms - CA555ce8121c65b8
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA555ce8121c65b8faccc9adf7fc80a110" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.6:34804 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | INFO:     172.18.0.6:34820 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-80d3c25f
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764955688.409] WS_START sid=MZf9ebb2dcfebdb57be36fddf44f08a98d call_sid=CA555ce8121c65b8faccc9adf7fc80a110 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA555ce8 (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | INFO:     127.0.0.1:40912 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 446ms (T0+452ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:34814 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1062ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1166ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA555ce8121c65b8faccc9adf7fc80a110
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764955689.577] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | 
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1168ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.3, threshold=108.2)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 719ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1ms (total: 1165ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764955689.581
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1166ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtBMeNFIRs7H0...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtBMeNFIRs7H0... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Call log already exists for CA555ce8121c65b8faccc9adf7fc80a110
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Recording started for CA555ce8121c65b8faccc9adf7fc80a110: RE4250376dfdb86707ef49b5d0205b0b57
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764955690.964 (duration: 1383ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (55ms, frames=0)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×××ª×¨' (confidence=57%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1396ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.5s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (0ms, frames=0)
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = []
prosaas-backend  | âš ï¸ [DEBUG] Using default required_fields (no custom config found)
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['name', 'phone'] | Collected: []
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] User has been silent )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtEgcs2qmn4Az...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtEgcs2qmn4Az... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f7 dd 76 6c e1
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d4 ce da df ec
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=32 28 36 bc a3
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=634.0 > threshold=108.2
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=4a 48 46 46 48, rms=1342, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=50 4b 45 40 3e, rms=1838, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=bc bb ba ba bb, rms=1011, consec_frames=5
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 12 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×ª×•×“×” ×©×“×™×‘×¨×ª ××™×ª×™, ×©×™×”×™×” ×œ×š ×™×•× × ×”×“×¨!
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.61s (71 chunks)
prosaas-backend  | [GOODBYE CHECK] Skipping greeting: '×ª×•×“×” ×©×“×™×‘×¨×ª ××™×ª×™, ×©×™×”×™×” ×œ×š ×™×•×...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 12 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtGpWQ8alncVs...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtGpWQ8alncVs... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=db d0 d4 d5 da
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=10, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=45 3a 3e 3d 3f
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª' (len=27)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª' â†’ '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×', '×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“...' despite low RMS=13)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª' (hebrew_chars=38)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª' (hebrew=38, english=0)
prosaas-backend  | [STT_FINAL] '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª' (from raw: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª...')
prosaas-backend  | ğŸ’° [COST] User utterance: 1.46s (40 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª...' - processing as answer to greeting question
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=4262, frames=1/5)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtHnPrDudA1R3...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtHnPrDudA1R3... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=2809, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=3086, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=10079, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=260, frames=0/5)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×—×›× ×¤×•×¨×¥' (confidence=78%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 4a8e981b...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=4a8e981b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764955690.9652724}, {'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª', 'ts': 1764955695.0866346}]
prosaas-backend  | 
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=56 4e 55 44 43
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.12s (6 chunks)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fe fd fe fe fe
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d1 cd 6f c5 bb
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=5407, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=4670.0 > threshold=108.2
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (586ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=41 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.8s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=28800 | silence_ms=521
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': None, 'time': None, 'name': None, 'phone': None, 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtJ6wgFg09wZM...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtJ6wgFg09wZM... status=in_progress modalities=['text', 'audio'] output_format=g711_ulawğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=be a8 a8 b2 dd
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 22 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×©×™×”×™×” ×œ×š ×”××©×š ×™×•× × ×¤×œ×.
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.53s (81 chunks)
prosaas-backend  | [GOODBYE CHECK] Skipping greeting: '×©×œ×•×! ×©×™×”×™×” ×œ×š ×”××©×š ×™×•× × ×¤×œ×....'
prosaas-backend  | [POLITE CLOSING] Detected: '×™×•× × ×¤×œ×'
prosaas-backend  | ğŸ”’ [HANGUP BLOCKED] AI said closing phrase but conditions not met:
prosaas-backend  |    goodbye_detected=False
prosaas-backend  |    auto_end_on_goodbye=False
prosaas-backend  |    auto_end_after_lead_capture=False, lead_captured=False
prosaas-backend  |    verification_confirmed=False
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 22 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×œ×™×‘×¨.' (len=6)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×œ×™×‘×¨....' despite low RMS=10)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×§×œ×™×‘×¨.' (hebrew_chars=5)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×œ×™×‘×¨.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×œ×™×‘×¨.' (hebrew=5, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (3464ms)
prosaas-backend  | [STT_FINAL] '×§×œ×™×‘×¨.' (from raw: '×§×œ×™×‘×¨....')
prosaas-backend  | ğŸ’° [COST] User utterance: 1.81s (112 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×œ×™×‘×¨.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×™×‘×¨' (confidence=77%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª', '×§×œ×™×‘×¨.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: cbda4f76...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (4a8e981b â†’ cbda4f76) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=cbda4f76...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=ea e4 eb f2 7b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=cf b8 ae b2 ba
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=f9 e6 ce d2 4b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª', 'ts': 1764955695.0866346}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955696.1392853}, {'speaker': 'user', 'text': '×§×œ×™×‘×¨.', 'ts': 1764955698.5504448}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=13, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=1278, frames=1/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª ×‘××©×œ×—×™×, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.89s (27 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (26ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×œ×‘×™×ª' (confidence=74%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×¤...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (18ms, frames=0)
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtN45PwWCKH40...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtN45PwWCKH40... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=e5 fb dd d4 60
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=f8 ee ee ef ef
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=3f 38 3e 4a 51
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 34 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€” ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€” ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×...'
prosaas-backend  | âš ï¸ [LOOP GUARD] Triggered by semantic_repetition!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped cancel - no active response (id=None, speaking=False)
prosaas-backend  | âœ… [LOOP GUARD] Engaged - blocking new audio (existing queue: 0 frames will play)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.99s (57 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=22, tx_q=0) retry #10
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['× ××ª×¨', '×ª×•×ª', '×¢×™×¨ ××ª×”', '×¤×•×œ×”.', '×¢×¤×•×œ×”', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€”...'
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢×¦××š. ×××•×¨: '×œ× ×©××¢×ª×™ ×˜×•×‘, ××¤×©×¨ ×œ×—×–×•×¨?' ×•×ª××ª×™×Ÿ ×‘×©×§×˜.
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SERVER_EVENT:[SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 34 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=957.0 > threshold=108.2
prosaas-backend  | [PIPELINE STATUS] sent=113 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8823, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=907, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.8s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=28480 | silence_ms=508
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtSoUnkjeAAZM...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtSoUnkjeAAZM... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×, ×œ× ×××© ×œ×.' (len=14)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×, ×œ× ×××© ×œ×....' despite low RMS=12)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×, ×œ× ×××© ×œ×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×, ×œ× ×××© ×œ×.' (hebrew=9, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8832ms)
prosaas-backend  | [STT_FINAL] '×œ×, ×œ× ×××© ×œ×.' (from raw: '×œ×, ×œ× ×××© ×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.48s (218 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×, ×œ× ×××© ×œ×.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×, ×œ× ×××© ×œ×.' - user is rejecting/correcting
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª'}
prosaas-backend  | âŒ [CITY] Rejected '×××© ×œ×.' (confidence=45%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×, ×œ× ×××© ×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×, ×œ× ×××© ×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª', '×§×œ×™×‘×¨.', '×œ×, ×œ× ×××© ×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 7e8abaf0...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (cbda4f76 â†’ 7e8abaf0) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=7e8abaf0...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×, ×œ× ×××© ×œ×....'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×§×œ×™×‘×¨.', 'ts': 1764955698.5504448}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª ×‘××©×œ×—×™×, × ×›×•×Ÿ?', 'ts': 1764955699.4945695}, {'speaker': 'user', 'text': '×œ×, ×œ× ×××© ×œ×.', 'ts': 1764955707.3828006}]
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7a f4 fd fe f8
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=6a f1 78 ef eb
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=ed c4 cb ce ce
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=11, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¡×œ×™×—×”, ××– ×‘××™×–×” ×ª×—×•× ××ª×” ×¦×¨×™×š ×¢×–×¨×”?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.43s (38 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=22, tx_q=0) retry #20
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×–×¨×”?' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¡×œ×™×—×”, ××– ×‘××™×–×” ×ª×—×•× ××ª×” ×¦×¨×™×š ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (0ms, frames=0)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=9, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=822.0 > threshold=108.2
prosaas-backend  | [PIPELINE STATUS] sent=219 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=5619, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=22, tx_q=0) retry #30
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.8s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=28160 | silence_ms=517
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtadzVYrfmzRJ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtadzVYrfmzRJ... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?' (len=20)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?...' despite low RMS=15)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?' (hebrew=16, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7649ms)
prosaas-backend  | [STT_FINAL] '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?' (from raw: '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?...')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.29s (314 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=20, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª'}
prosaas-backend  | âŒ [CITY] Rejected '×©×™×¨×•×ª×™×' (confidence=51%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 8
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª', '×§×œ×™×‘×¨.', '×œ×, ×œ× ×××© ×œ×.', '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 0cb6ed76...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (7e8abaf0 â†’ 0cb6ed76) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=0cb6ed76...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 8 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×, ×œ× ×××© ×œ×.', 'ts': 1764955707.3828006}, {'speaker': 'ai', 'text': '×¡×œ×™×—×”, ××– ×‘××™×–×” ×ª×—×•× ××ª×” ×¦×¨×™×š ×¢×–×¨×”?', 'ts': 1764955708.248569}, {'speaker': 'user', 'text': '××™×–×” ×©×™×¨×•×ª×™× ×™×© ×œ×›×?', 'ts': 1764955715.0312603}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fd 7e 7d f8 7b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=3d 43 c2 cd cb
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=cd c7 c4 bf cb
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=14, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×™×© ×œ× ×• ×©×™×¨×•×ª×™× ×›××• ×¤×¨×™×¦×ª ×“×œ×ª×•×ª, ×”×—×œ×¤×ª ×× ×¢×•×œ×™×, ×ª×™×§×•×Ÿ ×¦×™×œ×™× ×“×¨×™× ×•×¢×•×“. ×‘××™×–×” ×ª×—×•× ××ª×” ×¦×¨×™×š ×¢×–×¨×”?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.17s (69 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (30ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:53884 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | WS_STOP sid=MZf9ebb2dcfebdb57be36fddf44f08a98d rx=1486 tx=842
prosaas-backend  | ğŸ“ [SES-80d3c25f] CALL ENDED - duration=29.7s, business_id=10, rx=1486, tx=843
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CA555ce8121c65b8faccc9adf7fc80a110 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:53888 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | INFO:     172.18.0.6:53900 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA555ce8121c65b8faccc9adf7fc80a110: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE4250376dfdb86707ef49b5d0205b0b57.json
prosaas-backend  | âœ… Recording queued for processing: CA555ce8121c65b8faccc9adf7fc80a110
prosaas-backend  | INFO:     127.0.0.1:58024 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     connection closed
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×¢×–×¨×”?' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×–×¨×”?
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×–×¨×”?'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×–×¨×”?
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×–×¨×”?', 'raw_city': '×¢×–×¨×”?'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×–×¨×”?', 'raw_city': '×¢×–×¨×”?', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×–×¨×”?', 'raw_city': '×¢×–×¨×”?', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×–×¨×”?' from ['×××ª×¨', '×—×›× ×¤×•×¨×¥', '×¢×™×¨ ××ª×”', '×™×‘×¨', '×œ×‘×™×ª', '×××© ×œ×.', '×¢×–×¨×”?', '×©×™×¨×•×ª×™×', '×¢×–×¨×”?']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×™×© ×œ× ×• ×©×™×¨×•×ª×™× ×›××• ×¤×¨×™×¦×ª ×“×œ×ª×•×ª...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âœ… call_log created immediately for CA94ff916602b5f7b346452a1f4af80d3d
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA94ff916602b5f7b346452a1f4af80d3d
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA94ff916602b5f7b346452a1f4af80d3d
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1307ms - CA94ff916602b5f7
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA94ff916602b5f7b346452a1f4af80d3d" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.6:53916 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:53922 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-cd92e507
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764955721.780] WS_START sid=MZ2daf3c574094f2a6bae922b1dd83c5af call_sid=CA94ff916602b5f7b346452a1f4af80d3d from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA94ff91 (FRESH SESSION)
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 419ms (T0+420ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1090ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1198ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA94ff916602b5f7b346452a1f4af80d3d
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764955722.980] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1201ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | 
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=9.1, threshold=109.1)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 783ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 0ms (total: 1203ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764955722.984
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1204ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtj75f4Z4KebO...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtj75f4Z4KebO... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Call log already exists for CA94ff916602b5f7b346452a1f4af80d3d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Recording started for CA94ff916602b5f7b346452a1f4af80d3d: REeb6e04c341d518850f0b52ca05c404c2
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZf9ebb2dcfebdb57be36fddf44f08a98d rx=1486 tx=843
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764955724.345 (duration: 1361ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (7ms, frames=0)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | âœ… CALL FINALIZED: CA555ce8121c65b8faccc9adf7fc80a110
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×œ×§×•×— ×¤× ×” ×œ×©×™×¨×•×ª×™ ×× ×¢×•×œ×Ÿ, ××—×¤×© ×¤×ª×¨×•× ×•×ª ×‘×ª×—×•× ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×•×”×—×œ×¤×ª ×× ×¢×•×œ×™×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - ×¡×•×’ ×”×©×™×¨×•×ª ×”××‘×•×§×©: ×¤×¨×™×¦×ª ×“×œ×ª×•×ª, ×”×—×œ×¤×ª ×× ×¢×•×œ×™×, ×ª×™×§×•×Ÿ ×¦×™×œ×™× ×“×¨×™×.
prosaas-backend  | - ××™×§×•×: ×§×œ×™×‘×¨ (× ×“×¨×© ×œ×•×•×“× ×× ××“×•×‘×¨ ×‘×¢×™×¨ ××• ×‘×©× ×”×¢×¡×§).
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×§×©×¨ ××• ×©× ×”×œ×§×•×— ×‘×©×™×—×”.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - ×œ× × ×§×‘×¢×” ×¤×’×™×©×” ××• ×ª×•×¨ ×‘×©×™×—×” ×–×•.
prosaas-backend  | - ×“×—×™×¤×•×ª: ×œ× ×¦×•×™×™× ×”, ××š ×™×© ×œ×”× ×™×— ×©×”×™× ×’×‘×•×”×” ×œ××•×¨ ×”×¦×•×¨×š ×‘×©×™×¨×•×ª×™ ×× ×¢×•×œ×Ÿ.
prosaas-backend  | - ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª: ×™×© ×œ×‘×¦×¢ ××¢×§×‘ ×¢× ×”×œ×§×•×— ×¢×œ ×× ×ª ×œ×”×‘×™×Ÿ ××ª ×”×¦×•×¨×š ×”××“×•×™×§ ×‘×©×™×¨×•×ª ×•×œ×”×¦×™×¢ ×¤×ª×¨×•× ×•×ª ××ª××™××™×.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ××ª ×”××™×§×•× ×”××“×•×™×§ ×©×œ ×”×œ×§×•×— (×§×œ×™×‘×¨) ×•×œ×‘×¨×¨ ×× ×™×© ×¦×•×¨×š ×‘×©×™×¨×•×ª ×“×—×•×£. ××•××œ×¥ ×œ×”×¦×™×’ ×œ×œ×§×•×— ××ª ××’×•×•×Ÿ ×”×©×™×¨×•×ª×™× ×”××•×¦×¢×™× ×•×œ×‘×¨×¨ ××ª ×”×¦×•×¨×š ×”×¡×¤×¦×™×¤×™ ×©×œ×•.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=598.0 > threshold=109.1
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=6e 6f 76 fe fa, rms=62, consec_frames=3
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×–×¨×”?', 'raw_city': '×¢×–×¨×”?', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA555ce8121c65b8faccc9adf7fc80a110, phone=+972504294724, city=×¢×–×¨×”?, direction=inbound
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=ea ee fe 70 6d, rms=77, consec_frames=3
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×¢×–×¨×”?, service=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | 
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×××ª×¨' (confidence=57%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1418ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.6s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (1ms, frames=0)
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=136.0 > threshold=109.1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=13, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=12, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=192, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=730, reason=insufficient_consec_frames(1/3))
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=3e 33 2f 39 f2, rms=2796, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=3 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=4848.0 > threshold=109.1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1422, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTttcPHzeY4y9q...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTttcPHzeY4y9q... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' (len=16)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' â†’ '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....' despite low RMS=9)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (hebrew_chars=19)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (hebrew=19, english=0)
prosaas-backend  | [STT_FINAL] '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (from raw: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 8.64s (102 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....' - processing as answer to greeting question
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×× ×¢×•×œ ×—×›×.' (confidence=49%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 881ea750...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=881ea750...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764955724.3454602}, {'speaker': 'user', 'text': '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', 'ts': 1764955734.4009757}]
prosaas-backend  | 
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f1 ec ed ed ee
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=6d 76 fc eb 7d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=4e 56 ea f8 f7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (27ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×–×¨×”?, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtvlPDLLogrdw...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtvlPDLLogrdw... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=9877.0 > threshold=109.1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3903, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=103 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=71 5e 77 f0 5c
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=fc f9 fa fa f9
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=54 49 48 48 48
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTtxRLdM5hYZNz...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTtxRLdM5hYZNz... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 18 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“ ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.00s (87 chunks)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¨×’×¢.' (len=4)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=13, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=16, reason=noise)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 3.6s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=57920 | silence_ms=2479
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×¨×’×¢....' despite low RMS=16)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×¨×’×¢.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¨×’×¢.' (hebrew=3, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (4786ms)
prosaas-backend  | [STT_FINAL] '×¨×’×¢.' (from raw: '×¨×’×¢....')ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | 
prosaas-backend  | ğŸ’° [COST] User utterance: 3.03s (164 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¨×’×¢.
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¨×’×¢....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¨×’×¢....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×¨×’×¢.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 90acdfce...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (881ea750 â†’ 90acdfce) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=90acdfce...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×’×¢....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', 'ts': 1764955734.4009757}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955734.8876493}, {'speaker': 'user', 'text': '×¨×’×¢.', 'ts': 1764955739.2025657}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×¢×“×™×™×Ÿ' differs from locked '×¢×–×¨×”?'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×¢×–×¨×”?' (reason: user_said_×¢×“×™×™×Ÿ)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×–×¨×”?', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×¢×“×™' (confidence=90%)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“...'
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fd ff 7d 7c 7b
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=e0 6c 60 ea f6
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=ff e7 e5 fc 75
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 18 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 10 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.01s (25 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (7ms, frames=0)
prosaas-backend  | INFO:     172.18.0.6:42982 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:42986 - "GET /api/auth/me HTTP/1.1" 401 Unauthorized
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×’×“×¨×”' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (8ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=165.0 > threshold=109.1
prosaas-backend  | [PIPELINE STATUS] sent=165 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=207 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.0s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=16640 | silence_ms=509
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTu6S4Ivq3PFcz...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTu6S4Ivq3PFcz... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=483.0 > threshold=109.1
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×' (len=2)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=13, reason=noise)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×œ×'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8112ms)
prosaas-backend  | [STT_FINAL] '×œ×' (from raw: '×œ×...')
prosaas-backend  | ğŸ’° [COST] User utterance: 4.33s (222 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×' - user is rejecting/correcting
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×œ×' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×’×“×¨×”' (reason: user_correction_word)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×¨×’×¢.', '×œ×']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 1f1ae62f...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (90acdfce â†’ 1f1ae62f) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=1f1ae62f...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×...'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×’×“×¨×”, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”
prosaas-backend  | 
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×¨×’×¢.', 'ts': 1764955739.2025657}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, × ×›×•×Ÿ?', 'ts': 1764955739.2468584}, {'speaker': 'user', 'text': '×œ×', 'ts': 1764955747.2985418}]
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=67 57 5f 66 5e
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=4d 43 3e 40 4e
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=bf b5 b9 b9 ba
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××– ×‘××™×–×• ×¢×™×¨ ×‘×“×™×•×§?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (31 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (7ms, frames=0)
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ×‘×“×™×•×§?' (confidence=45%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××– ×‘××™×–×• ×¢×™×¨ ×‘×“×™×•×§?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTu7unp5eq0C9K...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTu7unp5eq0C9K... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=ff 7c 77 71 6e
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=ee 6b d4 b7 aa
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=cb c0 c2 c3 cc
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | INFO:     172.18.0.6:59918 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=85, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, × ×›×•×Ÿ?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=83% with: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, × ×›×•...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.96s (50 chunks)
prosaas-backend  | INFO:     127.0.0.1:49340 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×’×“×¨×”' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (20ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 900 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=939.0 > threshold=109.1
prosaas-backend  | [PIPELINE STATUS] sent=223 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (2 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=274, voice_frames=0
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTuF1AAUx9uQFW...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTuF1AAUx9uQFW... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.3s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=20480 | silence_ms=522
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f1 5f 5e 6f 66
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTuFJ3u3tEelGF...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTuFJ3u3tEelGF... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=fa f7 f8 f8 f8
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=c3 af b8 c7 4d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fc e1 ee ef ea
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=9, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=f6 62 ef d9 69
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×.' (len=3)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 36 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“ ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“ ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×...'
prosaas-backend  | âš ï¸ [LOOP GUARD] Triggered by semantic_repetition!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped cancel - no active response (id=None, speaking=False)
prosaas-backend  | âœ… [LOOP GUARD] Engaged - blocking new audio (existing queue: 259 frames will play)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.98s (105 chunks)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (10625ms)
prosaas-backend  | [STT_FINAL] '×œ×.' (from raw: '×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.28s (280 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×.' - user is rejecting/correcting
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×œ×.' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×’×“×¨×”' (reason: user_correction_word)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 9
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×¨×’×¢.', '×œ×', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 11d6bbc4...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (1f1ae62f â†’ 11d6bbc4) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=11d6bbc4...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×’×“×¨×”, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 9 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '××– ×‘××™×–×• ×¢×™×¨ ×‘×“×™×•×§?', 'ts': 1764955747.3029988}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, × ×›×•×Ÿ?', 'ts': 1764955748.8623073}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1764955757.9617026}]
prosaas-backend  | 
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=de c8 cd c9 c6
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 4 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.57s (59 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (52ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['×××ª×¨', '×—×›× ×¤×•×¨×¥', '×¢×™×¨ ××ª×”', '×™×‘×¨', '×œ×‘×™×ª', '×××© ×œ×.', '×¢×–×¨×”?', '×©×™×¨×•×ª×™×', '×¢×–×¨×”?', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“...'
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢×¦××š. ×××•×¨: '×œ× ×©××¢×ª×™ ×˜×•×‘, ××¤×©×¨ ×œ×—×–×•×¨?' ×•×ª××ª×™×Ÿ ×‘×©×§×˜.
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SERVER_EVENT:[SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 36 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (1ms, frames=0)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTuJWEY4w1Wl9q...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTuJWEY4w1Wl9q... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7e 7b 7b 7d 7c
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=c9 d5 56 4a 59
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=f9 dc dd df e6
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=71% with: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, × ×›...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.20s (81 chunks)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1000 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×’×“×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×’×“×¨×”' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1151.0 > threshold=109.1
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #4 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=281 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (2 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=4246, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3802, voice_frames=0
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTuTxzYf8lKXcJ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTuTxzYf8lKXcJ... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1200 frames (rms=13, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.' (len=32)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘...' despite low RMS=13)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.' (hebrew=22, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (12963ms)
prosaas-backend  | [STT_FINAL] '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.' (from raw: '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘...')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.84s (424 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.' - user is rejecting/correcting
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×’×“×¨×”' (reason: user_correction_word)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '×××© ×œ×,' (confidence=45%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 12
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×¨×’×¢.', '×œ×', '×œ×.', '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: f6ae0953...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (11d6bbc4 â†’ f6ae0953) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=f6ae0953...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×’×“×¨×”, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 12 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955758.0360146}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?', 'ts': 1764955761.2110965}, {'speaker': 'user', 'text': '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.', 'ts': 1764955770.886757}]
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjTuTxzYf8lKXcJ...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7c f2 7b f9 fb
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=e1 7a e5 6f f5
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=69 ce fe ec 76
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¡×œ×™×—×” ×¢×œ ×”×‘×œ×‘×•×œ. ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×‘×××ª × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (95 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (17ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¡×œ×™×—×” ×¢×œ ×”×‘×œ×‘×•×œ. ××– ×‘××™×–×• ×¢×™×¨ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (22ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=140.0 > threshold=109.1
prosaas-backend  | [PIPELINE STATUS] sent=425 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #5 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1570, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:48084 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTucy7VqJWNi8a...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTucy7VqJWNi8a... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | INFO:     127.0.0.1:55518 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¨×™×¢×ª ×¢×ª×”.' (len=9)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1500 frames (rms=10, reason=noise)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×¨×™×¢×ª ×¢×ª×”....' despite low RMS=15)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×¨×™×¢×ª ×¢×ª×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¨×™×¢×ª ×¢×ª×”.' (hebrew=7, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8674ms)
prosaas-backend  | [STT_FINAL] '×¨×™×¢×ª ×¢×ª×”.' (from raw: '×¨×™×¢×ª ×¢×ª×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.61s (501 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¨×™×¢×ª ×¢×ª×”.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×’×“×¨×”', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '×¨×™×¢×ª ×¢×ª×”.' (confidence=49%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¨×™×¢×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¨×™×¢×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 14
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×', '×œ×.', '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.', '×¨×™×¢×ª ×¢×ª×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 7409ae7c...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (f6ae0953 â†’ 7409ae7c) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=7409ae7c...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×™×¢×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×’×“×¨×”, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7b 75 75 75 75
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d7 68 58 7d c5
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=c9 bd bf c0 cf
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=12, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 14 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.', 'ts': 1764955770.886757}, {'speaker': 'ai', 'text': '×¡×œ×™×—×” ×¢×œ ×”×‘×œ×‘×•×œ. ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×‘×××ª × ××¦×?', 'ts': 1764955772.0395935}, {'speaker': 'user', 'text': '×¨×™×¢×ª ×¢×ª×”.', 'ts': 1764955779.5604107}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (2ms, frames=0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×ª ×›×¨××œ, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=80% with: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, ×”×...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.93s (122 chunks)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1600 frames (rms=8, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×˜×™×¨×ª ×”×›×¨××œ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×’×“×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×˜×™×¨×ª ×›×¨××œ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×˜×™×¨×ª ×”×›×¨××œ' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (4ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ×¢×¤×•×œ×”
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | ğŸ”‡ [SILENCE] Final chance already given - closing anyway
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] User has been silent )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1700 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=406.0 > threshold=109.1
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #6 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=502 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=7494, voice_frames=0
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTumnKWzzMDjYy...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTumnKWzzMDjYy... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1800 frames (rms=10, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×.' (len=3)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×....' despite low RMS=11)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (10074ms)
prosaas-backend  | [STT_FINAL] '×œ×.' (from raw: '×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 1.92s (552 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×.' - user is rejecting/correcting
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×œ×.' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×˜×™×¨×ª ×”×›×¨××œ' (reason: user_correction_word)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 16
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×.', '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.', '×¨×™×¢×ª ×¢×ª×”.', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: ddc3a406...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (7409ae7c â†’ ddc3a406) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=ddc3a406...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×˜×™×¨×ª ×”×›×¨××œ, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] Conversation history has 16 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×¨×™×¢×ª ×¢×ª×”.', 'ts': 1764955779.5604107}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×ª ×›×¨××œ, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?', 'ts': 1764955780.670943}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1764955789.6343493}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fe fc fd 7b 72
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=cf c6 db e5 e7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=f5 e9 e3 de db
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjTumnKWzzMDjYy...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 1 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=83% with: '×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (128 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (13ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨ ××ª×”' (confidence=50%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': None, 'time': None, 'name': None, 'phone': None, 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1900 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=461.0 > threshold=109.1
prosaas-backend  | [PIPELINE STATUS] sent=553 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=115, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTus9C0DSoqxMh...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTus9C0DSoqxMh... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¨×’×¢ ××ª×”.' (len=8)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×¨×’×¢ ××ª×”....' despite low RMS=19)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×¨×’×¢ ××ª×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¨×’×¢ ××ª×”.' (hebrew=6, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6220ms)
prosaas-backend  | [STT_FINAL] '×¨×’×¢ ××ª×”.' (from raw: '×¨×’×¢ ××ª×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.32s (641 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¨×’×¢ ××ª×”.
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=359.0 > threshold=109.1
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '×¨×’×¢' (confidence=60%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¨×’×¢ ××ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¨×’×¢ ××ª×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 18
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×.', '×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.', '×¨×™×¢×ª ×¢×ª×”.', '×œ×.', '×¨×’×¢ ××ª×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 941fbfff...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (ddc3a406 â†’ 941fbfff) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=941fbfff...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×’×¢ ××ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×˜×™×¨×ª ×”×›×¨××œ, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] Conversation history has 18 messages
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×.', 'ts': 1764955789.6343493}, {'speaker': 'ai', 'text': '××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764955789.6386256}, {'speaker': 'user', 'text': '×¨×’×¢ ××ª×”.', 'ts': 1764955795.8540041}]ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | 
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=79 71 72 70 6d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d2 f1 5c 5e d2
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=cd c2 c4 c4 ca
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjTus9C0DSoqxMh...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=34, tx_q=0) retry #10
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×ª ×¢×ª×, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=80% with: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×’×“×¨×”, ×”×...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.70s (152 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (20ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2000 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '×˜×™×¨×ª' (confidence=57%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×ª ×”×›×¨××œ', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (22ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=34, tx_q=0) retry #20
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=245.0 > threshold=109.1
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #7 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=642 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=7878, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1211, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=737 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=951.0 > threshold=109.1
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=34, tx_q=0) retry #30
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=4764, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×” ×œ×‘×™×ª
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjTv53uQbcM90xy...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjTv53uQbcM90xy... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:41944 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×¨×™×™×ª ××ª×.' (len=10)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×¨×™×™×ª ××ª×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×¨×™×™×ª ××ª×.' (hebrew=8, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (12683ms)
prosaas-backend  | [STT_FINAL] '×§×¨×™×™×ª ××ª×.' (from raw: '×§×¨×™×™×ª ××ª×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 5.42s (816 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×¨×™×™×ª ××ª×.
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=30, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×˜×™×¨×ª ×›×¨××œ', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ××ª×.
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=91.89473684210526
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [CITY] Auto-accepted AND locked: '×§×¨×™×™×ª ××ª×' (confidence=92%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×¨×™×™×ª ××ª×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×¨×™×™×ª ××ª×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 20
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×, ×××© ×œ×, ××ª×” ×œ× × ×•×ª×Ÿ ×œ×™ ×œ×“×‘×¨.', '×¨×™×¢×ª ×¢×ª×”.', '×œ×.', '×¨×’×¢ ××ª×”.', '×§×¨×™×™×ª ××ª×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: de97cafd...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (941fbfff â†’ de97cafd) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=de97cafd...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×¨×™×™×ª ××ª×....'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 20 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×¨×’×¢ ××ª×”.', 'ts': 1764955795.8540041}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×ª ×¢×ª×, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?', 'ts': 1764955796.6751244}, {'speaker': 'user', 'text': '×§×¨×™×™×ª ××ª×.', 'ts': 1764955808.5368636}]
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××ª×, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f0 ef 7c 78 6d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=6c 44 3c 3f d0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=bf b5 b7 b7 bd
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=31, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | INFO:     127.0.0.1:32936 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×§×¨×™×™×ª ×¢×ª×, ×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=75% with: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×ª ×›×¨×...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.66s (176 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (27ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2400 frames (rms=8, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ×¢×ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ×¢×ª×', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ×¢×ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ×¢×ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×§×¨×™×™×ª ××ª×' from ['×××ª×¨', '×× ×¢×•×œ ×—×›×.', '×¢×™×¨ ××ª×”', '×’×“×¨×”', '×¢×™×¨ ×‘×“×™×•×§?', '×’×“×¨×”', '×¢×™×¨ ××ª×”', '×’×“×¨×”', '×××© ×œ×,', '×¢×™×¨ ××ª×”', '×¨×™×¢×ª ×¢×ª×”.', '×˜×™×¨×ª ×›×¨××œ', '×¢×™×¨ ××ª×”', '×¨×’×¢', '×˜×™×¨×ª', '×§×¨×™×™×ª ××ª×.', '×§×¨×™×™×ª ×¢×ª×']
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ×¢×ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 11.4s audio, conversation #3
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=183040 | silence_ms=7796
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #3
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #8 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=239.0 > threshold=109.1
prosaas-backend  | [PIPELINE STATUS] sent=820 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | WS_STOP sid=MZ2daf3c574094f2a6bae922b1dd83c5af rx=4754 tx=2457
prosaas-backend  | ğŸ“ [SES-cd92e507] CALL ENDED - duration=95.0s, business_id=10, rx=4754, tx=2457
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA94ff916602b5f7b346452a1f4af80d3d stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:57900 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | INFO:     172.18.0.6:57914 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA94ff916602b5f7b346452a1f4af80d3d: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REeb6e04c341d518850f0b52ca05c404c2.json
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | âœ… Recording queued for processing: CA94ff916602b5f7b346452a1f4af80d3d
prosaas-backend  | INFO:     connection closed
p