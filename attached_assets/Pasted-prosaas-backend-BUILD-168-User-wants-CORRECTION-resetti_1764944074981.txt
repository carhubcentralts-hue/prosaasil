prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 16
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×.', '×œ×.', '×§×œ×™×‘×¨.', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 10d5e237...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (df87374e â†’ 10d5e237) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=10d5e237...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××•× ×•, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] Conversation history has 16 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×§×œ×™×‘×¨.', 'ts': 1764942923.2501981}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“××ªâ€” ×”×™×™×ª ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ××•× ×•, × ×›×•×Ÿ?', 'ts': 1764942923.3766654}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1764942927.8715312}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 4498ms gap between chunks #112 and #113 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjQZKl3NHo1AY4L...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 6 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×¦×¨×™×š ××ª ×”×©×™×¨×•×ª?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=88% with: '××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×¦×¨×™×š ××ª ×”×©×™×¨×•×ª?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (123 chunks)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1700 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××•× ×•', 'raw_city': '×§×¨×™×™×ª ××•× ×•', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×¦×¨×™×š ×...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1800 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1354.0 > threshold=112.8
prosaas-backend  | [PIPELINE STATUS] sent=567 blocked=0 | active_response=None... | ai_speaking=False | user_has_spoken=True
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.8s audio, conversation #8
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=12160 | silence_ms=500
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #8
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjQZO1vZ0FuYAzX...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjQZO1vZ0FuYAzX... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×.' (len=3)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1900 frames (rms=8, reason=noise)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (5062ms)
prosaas-backend  | [STT_FINAL] '×œ×.' (from raw: '×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.93s (617 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×.
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×œ×.' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 18
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×.', '×§×œ×™×‘×¨.', '×œ×.', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 991a6bcc...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (10d5e237 â†’ 991a6bcc) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=991a6bcc...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××•× ×•, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmationğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 18 messages
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 5058ms gap between chunks #123 and #124 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×.', 'ts': 1764942927.8715312}, {'speaker': 'ai', 'text': '×¡×œ×™×—×”, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×¦×¨×™×š ××ª ×”×©×™×¨×•×ª?', 'ts': 1764942927.8775918}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1764942932.9340477}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjQZO1vZ0FuYAzX...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 7 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××•×§×™×™, ×¨×§ ××•×•×“××ª ×©×•×‘â€”×”×™×™×ª ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª, ×•×‘××™×–×• ×¢×™×¨?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.01s (143 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=370.0 > threshold=112.8
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #5 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2774, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': '×§×œ×™×‘×¨', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××•× ×•', 'raw_city': '×§×¨×™×™×ª ××•× ×•', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âŒ [CITY] Rejected '××•×§×™×™,' (confidence=81%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Skipping greeting: '××•×§×™×™, ×¨×§ ××•×•×“××ª ×©×•×‘â€”×”×™×™×ª ×¦×¨×™×š...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=618 blocked=0 | active_response=None... | ai_speaking=False | user_has_spoken=True
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.0s audio, conversation #9
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=15680 | silence_ms=520
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #9
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjQZT6T5xLJWIpN...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjQZT6T5xLJWIpN... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×œ×™××˜ ×××•× ×”.' (len=12)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2000 frames (rms=13, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [STT_REPAIRED] '×§×œ×™××˜ ×××•× ×”.' â†’ '×§×œ×™×‘×¨ ×××•× ×”.'
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×œ×™×‘×¨ ×××•× ×”....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×œ×™×‘×¨ ×××•× ×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×œ×™×‘×¨ ×××•× ×”.' (hebrew=10, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (4649ms)
prosaas-backend  | [STT_FINAL] '×§×œ×™×‘×¨ ×××•× ×”.' (from raw: '×§×œ×™××˜ ×××•× ×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.88s (685 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×œ×™×‘×¨ ×××•× ×”.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××•× ×•', 'raw_city': '×§×¨×™×™×ª ××•× ×•', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âŒ [CITY] Rejected '×××•× ×”.' (confidence=51%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×œ×™×‘×¨ ×××•× ×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×œ×™×‘×¨ ×××•× ×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 20
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×.', '×§×œ×™×‘×¨.', '×œ×.', '×œ×.', '×§×œ×™×‘×¨ ×××•× ×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 59474a82...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (991a6bcc â†’ 59474a82) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=59474a82...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×œ×™×‘×¨ ×××•× ×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××•× ×•, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 20 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×.', 'ts': 1764942932.9340477}, {'speaker': 'ai', 'text': '××•×§×™×™, ×¨×§ ××•×•×“××ª ×©×•×‘â€”×”×™×™×ª ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª, ×•×‘××™×–×• ×¢×™×¨?', 'ts': 1764942932.9437826}, {'speaker': 'user', 'text': '×§×œ×™×‘×¨ ×××•× ×”.', 'ts': 1764942937.5824506}]ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 4897ms gap between chunks #143 and #144 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ªâ€” ×”×™×™×ª ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×©××•× ×”, × ×›×•×Ÿ?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=73% with: '×¨×§ ××•×•×“××ªâ€” ×”×™×™×ª ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×—×•×œ×•×Ÿ, × ×›×•×Ÿ?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.01s (164 chunks)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': '×§×œ×™×‘×¨', 'phone': 'null', 'confidence': 0.8}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ×©××•× ×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×©××•× ×”', 'raw_city': '×§×¨×™×™×ª ××•× ×•', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ×©××•× ×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×©××•× ×”', 'raw_city': '×§×¨×™×™×ª ×©××•× ×”', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×©××•× ×”', 'raw_city': '×§×¨×™×™×ª ×©××•× ×”', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âœ… [CITY] Auto-accepted: '×§×¨×™×™×ª ×©××•× ×”' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×©××•× ×”', 'raw_city': '×§×¨×™×™×ª ×©××•× ×”', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | [GOODBYE CHECK] Skipping greeting: '×¨×§ ××•×•×“××ªâ€” ×”×™×™×ª ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #6 (prevents 5min timeout)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2400 frames (rms=37, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=216.0 > threshold=112.8
prosaas-backend  | [PIPELINE STATUS] sent=686 blocked=0 | active_response=None... | ai_speaking=False | user_has_spoken=True
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=34, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #10
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=552
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #10
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjQZdYOvIF6022z...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjQZdYOvIF6022z... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=30)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×', '×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥...' despite low RMS=10)
prosaas-backend  | [GIBBERISH] Detected: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' | Reason: repeated_pattern: '×× ×¢' x3 | Confidence: 70%
prosaas-backend  | [NOISE FILTER] âŒ REJECTED (gibberish): '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 8400ms gap between chunks #164 and #165 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2500 frames (rms=16, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.32s (188 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 2600 frames (rms=8, reason=noise)
prosaas-backend  | WS_STOP sid=MZd72dcbdfc42c4443997abf64c70ccc62 rx=3533 tx=2664
prosaas-backend  | ğŸ“ [SES-7745a4a3] CALL ENDED - duration=70.5s, business_id=10, rx=3533, tx=2665
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CA74014e1327d3462ead0bd6c41ba5ceb4 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:55268 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA74014e1327d3462ead0bd6c41ba5ceb4: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REd8613518898c00e34f010e5afcc643dd.json
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×©××•× ×”', 'raw_city': '×§×¨×™×™×ª ×©××•× ×”', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | âŒ [CITY] Rejected '××œ×™×š' (confidence=84%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP BUILD 176] AI said goodbye with auto_end_on_goodbye=True + user interaction - disconnecting
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (reason: ai_goodbye_auto_end)
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | INFO:     172.18.0.5:55284 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CA74014e1327d3462ead0bd6c41ba5ceb4
prosaas-backend  | INFO:     connection closed
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | âœ… CALL FINALIZED: CA74014e1327d3462ead0bd6c41ba5ceb4
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×œ×©×™×¨×•×ª×™ ×¤×¨×™×¦×ª ×“×œ×ª×•×ª, ×‘×ª×—×•× ×”×× ×¢×•×œ× ×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | ×”×œ×§×•×—, ×”××™×™×¦×’ ××ª ×”×¢×¡×§ "×§×œ×™×‘×¨", ××—×¤×© ×©×™×¨×•×ª ×¤×¨×™×¦×ª ×“×œ×ª×•×ª. ×‘××”×œ×š ×”×©×™×—×”, ×œ× ×”×•×‘×”×¨ ×‘××“×•×™×§ ×‘××™×–×• ×¢×™×¨ × ×“×¨×© ×”×©×™×¨×•×ª, ××š ×”×•×–×›×¨×• ××¡×¤×¨ ×¢×¨×™× ×›××• ×¨×¢× × ×”, ×ª×œ ××‘×™×‘, ×—×•×œ×•×Ÿ ×•×§×¨×™×™×ª ××•× ×•.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×©× ×”×¢×¡×§: ×§×œ×™×‘×¨. ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×”×ª×§×©×¨×•×ª × ×•×¡×¤×™×.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | ×œ× × ×§×‘×¢×” ×¤×’×™×©×” ××• ×ª×•×¨, ××š ×”×•×‘×”×¨ ×›×™ ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×“×—×™×¤×•×ª ×”×¤× ×™×™×” × ×¨××™×ª ×’×‘×•×”×”, ×‘×©×œ ×”×¦×•×¨×š ×”××™×™×“×™ ×‘×©×™×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×¢× ×”×œ×§×•×— ××ª ×”××™×§×•× ×”××“×•×™×§ ×©×‘×• × ×“×¨×© ×”×©×™×¨×•×ª, ×›×“×™ ×œ×× ×•×¢ ×‘×œ×‘×•×œ ×•×œ×™×™×¢×œ ××ª ×”×ª×”×œ×™×š. ××•××œ×¥ ×œ×¢×§×•×‘ ××—×¨×™ ×”×¤× ×™×™×” ×•×œ×•×•×“× ×©×”×œ×§×•×— ×§×™×‘×œ ××ª ×”×©×™×¨×•×ª ×”× ×“×¨×© ×‘×”×§×“×.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZd72dcbdfc42c4443997abf64c70ccc62 rx=3533 tx=2665
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×©××•× ×”', 'raw_city': '×§×¨×™×™×ª ×©××•× ×”', 'city_confidence': '100.0', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA74014e1327d3462ead0bd6c41ba5ceb4, phone=+972504294724, city=×§×¨×™×™×ª ×©××•× ×”, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×§×¨×™×™×ª ×©××•× ×”, service=×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | 
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | INFO:     127.0.0.1:55652 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 167 frames...
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=167) retry #0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=167) retry #10
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=167) retry #20
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=167) retry #30
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | INFO:     127.0.0.1:45454 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:53424 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:55596 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:34936 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:37954 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:53626 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:49024 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:48418 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:42442 - "GET /api/notifications HTTP/1.1" 401 Unauthorized
prosaas-backend  | INFO:     127.0.0.1:39712 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | [WA-SESSION] ğŸ“± Check #2: Found 0 stale sessions to process
prosaas-backend  | INFO:     127.0.0.1:57870 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:38004 - "GET /api/notifications HTTP/1.1" 401 Unauthorized
prosaas-backend  | INFO:     127.0.0.1:55550 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:56066 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:41802 - "GET /api/notifications HTTP/1.1" 401 Unauthorized
prosaas-backend  | INFO:     127.0.0.1:55034 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:39394 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:47558 - "GET /api/notifications HTTP/1.1" 401 Unauthorized