🎯 GOAL: Final production QA for ProSaaS before git push & deploy to Contabo (prosaas.pro)

חשוב: אל תוסיף פיצ'רים חדשים. תבצע עכשיו ROUND QA סופי רק לאימות, תיקון באגים, וניקוי קונפיגורציה לפרודקשן.

הנחות יסוד:
- הפרויקט כבר כולל:
  - BUILD 153 (Twilio security, Node 20+, multi-tenant CRM, payments hardening)
  - BUILD 155 (AgentKit לוואטסאפ, feature freeze לתשלומים/חוזים, cross-tenant fixes)

המטרות:

1) אימות מלא של מה שטענת ב-BUILD 153 + BUILD 155 מול הקוד בפועל:
   - עבור סעיף-סעיף בסיכום שלך:
     - אתר בקוד את השינוי המתאים.
     - אם משהו חסר/לא תואם – לתקן עכשיו.
   - תעד ב-replit.md תחת SECTION חדש:
     - "BUILD 155 QA VERIFICATION" – רשימת סעיפים ✔/✘ ומה תוקן.

2) Twilio:
   - ודא שכל ה-webhook routes:
     - מקבלים POST בלבד.
     - משתמשים ב-resolve_business_with_fallback() לזיהוי עסק.
     - משתמשים ב-check_twilio_signature() (או מודול אבטחה מרוכז).
   - ב-production:
     - FLASK_ENV != "development" → אסור לעקוף חתימת Twilio.
     - אם אין TWILIO_AUTH_TOKEN → לבטל את ה-webhook (reject 500/403) עם לוג ברור.
   - הסר כל בדיקות/קיצורי דרך development ישנים (למשל override של signature) אם נשארו.

3) WhatsApp / Baileys / AgentKit:
   - ודא:
     - Dockerfile.baileys משתמש ב-Node >= 20.
     - יש healthcheck ל-baileys.
   - whatsapp_appointment_handler:
     - אין שום fallback ל-Business.query.first() / business_id=1.
     - create_whatsapp_appointment ו-send_appointment_confirmation דורשים business_id מפורש.
     - אין מספרי טלפון hard-coded – הכל דרך DB:
       - Business.phone_e164 או שדה רלוונטי.
   - ודא ש-resolve_business_with_fallback() משתמש במספר נכנס (from / to) בצורה מולטי-טננט ולא חורג לעסק אחר.

4) CRM / Multi-tenant:
   - עבור על כל קבצי ה-API המרכזיים של CRM (לידים, משימות, משתמשים, עסקים וכו'):
     - ודא שכל endpoint משתמש ב-get_business_id() או מנגנון זהה.
     - רק system_admin יכול לשלוט ידנית ב-business_id דרך פרמטרים.
   - מחיקת לידים:
     - קיים כפתור מחיקה גם ב-mobile וגם ב-desktop.
     - מאובטח בצד שרת (business_id, permissions).
   - מחיקת משתמשים:
     - system_admin: יכול למחוק כל משתמש.
     - owner: יכול למחוק רק משתמשים של העסק שלו.
     - אי אפשר למחוק owner יחיד או למחוק את המשתמש הנוכחי.
   - תעד בקצרה ב-replit.md מה נבדק ושה-RBAC תקין.

5) תשלומים / חוזים – Feature Freeze מלא:
   - ודא שהדגלים:
     - ENABLE_PAYMENTS=false
     - ENABLE_CONTRACTS=false
     כבר קיימים ב-code וב-.env.example.
   - ב-backend:
     - כל endpoints שקשורים לתשלומים/חוזים/חשבוניות:
       - אם flag=false → מחזירים 410 Gone / 501 Not Implemented עם הודעת JSON ברורה.
     - אין שום callback חיצוני (Tranzila וכו') שמבצע פעולה אמיתית בפרודקשן כרגע.
   - ב-frontend:
     - לא מוצגים כפתורים/טאבים/מסכים של:
       - "תשלום אונליין"
       - "חשבוניות"
       - "חוזים"
     - אם יש מסכים קיימים – לא לזרוק אותם, רק לא לקשר אליהם. מי שיכנס ידנית ל-URL יקבל הודעה ברורה שהמודול מושבת.
   - ודא שאין URLs ישנים כמו ai-crmd.replit.app בשום קובץ (רק בקבצי doc אם בכלל).

6) Google TTS/STT:
   - אל תמחק בהכרח את הקוד, אבל ודא:
     - שיש feature flag ברור:
       - TTS_DISABLED או שמות קיימים אחרים.
     - אם לא מוגדרים credentials של Google (אין קבצי JSON ואין GOOGLE_APPLICATION_CREDENTIALS):
       - המערכת לא מנסה לקרוא לשירותי TTS/STT של גוגל.
       - יש fallback ל-Whisper/OpenAI לפי העיצוב הנוכחי.
   - תוודא שאין קריאות ישירות ל-Google ללא בדיקת flag / credentials.

7) דומיין ו-URLs:
   - ודא שהכל משתמש ב-PUBLIC_BASE_URL:
     - במיוחד בתשלומים, webhooks, קישורי frontend, לינקים במיילים וכו'.
   - אסור שישארו:
     - ai-crmd.replit.app
     - *.replit.app / *.repl.co
   - הדומיין הדיפולטי בקוד וב-.env.example:
     - PUBLIC_BASE_URL=https://prosaas.pro

8) Docker / Deploy:
   - ודא ש:
     - Dockerfile.frontend, Dockerfile.backend, Dockerfile.baileys תואמים לדרישות Node/Python/Deps העדכניות.
     - .dockerignore מכיל:
       - build/, dist/, .pythonlibs/, __pycache__/, .venv/, node_modules/, credentials/, וכו'.
   - DEPLOYMENT.md:
     - כל ההנחיות שם כבר מעודכנות ל-prosaas.pro ול-Contabo, כולל הערות על Cloudflare/Nginx/SSL.

לבסוף:
- אל תוסיף פיצ'רים.
- אל תשנה לוגיקה עסקית יציבה.
- תתמקד ב:
  - תיקון חורים אם משהו שסיכמת לא באמת קיים בסורס.
  - ניקוי, hardening, ויישור קו מלא לפרודקשן.
- בסוף תרשום ב-replit.md תחת "BUILD 155 – FINAL PRODUCTION QA" סיכום קצר של:
  - מה נבדק.
  - מה תוקן.
  - ומצב סופי: "Ready for external VPS at prosaas.pro".