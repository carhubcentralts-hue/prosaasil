MAYBE_SPEECH â†’ SPEECH | SNR=9.3dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ“¼ [BUILD 198] Sending 10 pre-roll frames (RAW Î¼-law)
prosaas-backend  | WS_STOP sid=MZ336177893d76004a03650466b26b7d4b rx=2904 tx=1564
prosaas-backend  | ğŸ“ [SES-4cdda08f] CALL ENDED - duration=58.0s, business_id=10, rx=2904, tx=1565
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | âœ… [BUILD 195] SUSTAINED speech (14908ms >= 600ms) - valid user input
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjFekBRp0Zk8b6n...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjFekBRp0Zk8b6n... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | ğŸ”’ [BUILD 194] âŒ BLOCKED: Transcript after closing - '...'
prosaas-backend  | STREAM_ENDED call=CA7fcf933b01978eb597b33ac1d44f78af stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:37872 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | INFO:     172.18.0.5:37888 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Found existing recording for CA7fcf933b01978eb597b33ac1d44f78af: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE8d3ce6c91a7eedc633f4179ebb2264c5.json
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 3616ms gap between chunks #103 and #104 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | âœ… Recording queued for processing: CA7fcf933b01978eb597b33ac1d44f78af
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | INFO:     connection closed
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | â³ [AUDIO] 50 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’¾ [BUILD 196.5] AI transcript saved to conversation_history (total: 17 messages)
prosaas-backend  | ğŸ” [DEBUG CALLIBER] AI_REPLY: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.'
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§...'
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.28s (128 chunks)
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '××œ×™×š' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=××œ×™×š
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '×¦×¤×ª', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ×¦×¤×ª'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city=××œ×™×š source=ai_confirmation
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××œ×™×š
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ×¦×¤×ª'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: raw_city=××œ×™×š source=ai_confirmation
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ×¦×¤×ª'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city_confidence=100.0 source=ai_confirmation
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ×¦×¤×ª', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city_autocorrected=True source=ai_confirmation
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '××œ×™×š' from ['×©×œ×•×!', '×¢×™×¨', '×ª×œ ××‘×™×‘', '× ×ª×™', '×¨×›×‘', '×¦×¤×ª', '××œ×™×š', '××œ×™×š']
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP] User said goodbye, AI responded politely - disconnecting
prosaas-backend  | ğŸ”’ [BUILD 194] Hangup triggered - blocking future transcripts
prosaas-backend  | ğŸ”‡ [BUILD 194] Cleared audio input buffer
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | â³ [AUDIO] 50 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | [REALTIME] event: input_audio_buffer.cleared
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ336177893d76004a03650466b26b7d4b rx=2904 tx=1565
prosaas-backend  | âœ… CALL FINALIZED: CA7fcf933b01978eb597b33ac1d44f78af
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×©×™×—×ª ×©×™×¨×•×ª ×œ×§×•×—×•×ª ×‘×ª×—×•× ×”×× ×¢×•×œ× ×•×ª. ×”×œ×§×•×— ××—×¤×© ×©×™×¨×•×ª ×¤×¨×™×¦×” ×œ×¨×›×‘.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×¤×¨×™×¦×” ×œ×¨×›×‘
prosaas-backend  | - **××™×§×•×**: ×¦×¤×ª
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ× × ××¡×¨×• ×¤×¨×˜×™× ××™×©×™×™× ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×’×‘×•×”×”, ×‘×©×œ ×”×¦×•×¨×š ×”××™×™×“×™ ×‘×©×™×¨×•×ª ×¤×¨×™×¦×”.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××ª ×”×©×™×¨×•×ª ×‘×”×§×“× ×”××¤×©×¨×™, ×•×œ×•×•×“× ×©×”×× ×¢×•×œ×Ÿ ×”××™×•×¢×“ ××¦×•×™×“ ×‘×›×œ×™× ×”× ×“×¨×©×™× ×œ×¤×¨×™×¦×” ×œ×¨×›×‘. ××•××œ×¥ ×œ×¢×§×•×‘ ××—×¨×™ ×”×¤× ×™×™×” ×•×œ×•×•×“× ×©×”×œ×§×•×— ××¨×•×¦×” ××”×©×™×¨×•×ª ×©× ×™×ª×Ÿ ×œ×•.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×•×¨×¥ ×œ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ×¦×¤×ª', 'city_autocorrected': 'True'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA7fcf933b01978eb597b33ac1d44f78af, phone=+972504294724, city=××œ×™×š, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=××œ×™×š, service=×¤×•×¨×¥ ×œ×¨×›×‘
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | âœ… call_log created immediately for CAc72e1b17c695cd68c02ab817713fd974
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CAc72e1b17c695cd68c02ab817713fd974
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CAc72e1b17c695cd68c02ab817713fd974
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1273ms - CAc72e1b17c695cd
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CAc72e1b17c695cd68c02ab817713fd974" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:42270 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:42284 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-1a729f1b
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764900990.121] WS_START sid=MZe0f8b7e61afbf73a94d24518d7e1410f call_sid=CAc72e1b17c695cd68c02ab817713fd974 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CAc72e1b (FRESH SESSION)
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 457ms (T0+458ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 948ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=5s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1053ms
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764900991.176] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1055ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.6, threshold=80.0)
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CAc72e1b17c695cd68c02ab817713fd974
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 600ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=shimmer for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1ms (total: 1057ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=shimmer
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764900991.179
prosaas-backend  | âœ… [BUILD 163] response.create sent! OpenAI=1058ms, T0â†’speak=1058ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender started
prosaas-backend  | ğŸ”§ [BUILD 197] VAD thresholds: MIN_UTTERANCE=900ms, TRAILING_SILENCE=500ms, FIRST_UTTERANCE=1200ms
prosaas-backend  | ğŸ”§ [BUILD 198] AUDIO PATH FIX: Raw Î¼-law to Realtime | DIAGNOSTIC_MODE=False
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjFexdrCoB0DrJx...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjFexdrCoB0DrJx... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Call log already exists for CAc72e1b17c695cd68c02ab817713fd974
prosaas-backend  | âœ… Recording started for CAc72e1b17c695cd68c02ab817713fd974: RE7b0ce77a9a2ee43f4a2e018ee8535b48
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=50, tx_q=115) retry #0
prosaas-backend  | ğŸ“ [PROMPT] Final length: 3575 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764900992.714 (duration: 1535ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=5s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ’¾ [BUILD 196.5] AI transcript saved to conversation_history (total: 1 messages)
prosaas-backend  | ğŸ” [DEBUG CALLIBER] AI_REPLY: '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?'
prosaas-backend  | [REALTIME] sending audio TO queue: chunk#1, Î¼-law bytes=160, first5=fe fe fe fe fe, rms=8
prosaas-backend  | [REALTIME] sending audio TO queue: chunk#2, Î¼-law bytes=160, first5=fe fe fe fe fe, rms=8
prosaas-backend  | [REALTIME] sending audio TO queue: chunk#3, Î¼-law bytes=160, first5=fe fe fe fe fe, rms=8
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city_needs_retry=True source=ai_confirmation
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1699ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸšï¸ [BUILD 198] NOISE CALIBRATED: noise_rms=30 (from 30 frames)
prosaas-backend  | ğŸ“Š [BUILD 198] Stats: sent=0 blocked=1 | ğŸ¤NORMAL | noise=30 | state=SILENCE
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 2.2s - now updating session
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated with full prompt: 3575 chars, voice=shimmer locked, max_tokens=4096, transcription=Hebrew
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 115 frames...
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=50, tx_q=115) retry #10
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=228.0 > threshold=80.0
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=21.5dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ¤ [BUILD 196.2] SPEECH STARTED (SNR=44.3dB) echo_blocked=False
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SPEECH | SNR=44.3dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ“¼ [BUILD 198] Sending 10 pre-roll frames (RAW Î¼-law)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=5556, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking (user_has_spoken NOT set yet - waiting for valid utterance)
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | â³ [BUILD 195] Speech detected - will confirm after 600ms sustained speech...
prosaas-backend  | ğŸ›¡ï¸ [BUILD 196.3] Speech detected - echo protection active (no bypass)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=1091, voice_frames=0
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ”‡ [BUILD 197] SPEECH ENDED: duration=2059ms threshold=1200ms trailing_silence=516ms first=True
prosaas-backend  | âœ… [BUILD 197] ACCEPTED utterance: 2059ms >= 1200ms
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 2.1s - triggering AI response
prosaas-backend  | ğŸ“Š [AUDIO PATH] First utterance accepted: duration=2059ms, trailing_silence=516ms, first=True
prosaas-backend  | ğŸ—£ï¸ [BUILD 197] First REAL user utterance detected - user_has_spoken=True
prosaas-backend  | âœ… [BUILD 197] response.create queued (end of speech)
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SPEECH â†’ SILENCE | SNR=-14.0dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | âœ… [BUILD 196.3] response.create sent (manual trigger)
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | INFO:     127.0.0.1:47696 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=50, tx_q=115) retry #20
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=11.6dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjFf6maYXUCBnG8...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjFf6maYXUCBnG8... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ¤ [BUILD 196.2] SPEECH STARTED (SNR=11.9dB) echo_blocked=False
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SPEECH | SNR=11.9dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ“¼ [BUILD 198] Sending 10 pre-roll frames (RAW Î¼-law)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)ğŸ™ï¸ REAL_VOICE: rms=160.0 > threshold=80.0
prosaas-backend  | 
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f1 ee f6 fa ff
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=bf ba c3 c7 d1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=126, voice_frames=0
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 6.3s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=f2 e8 ea f1 7c
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | âœ… [BUILD 195] SUSTAINED speech (2895ms >= 600ms) - valid user input
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’¾ [BUILD 196.5] AI transcript saved to conversation_history (total: 3 messages)
prosaas-backend  | ğŸ” [DEBUG CALLIBER] AI_REPLY: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.19s (3 chunks)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city_needs_retry=True source=ai_confirmation
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=cancelled, output_count=1, details={'type': 'cancelled', 'reason': 'turn_detected'}
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ”„ [BUILD 193] Response cancelled (output=1)! Triggering IMMEDIATE recovery...
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjFf6WHwtmuRo7r...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjFf6WHwtmuRo7r... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 830ms gap between chunks #3 and #4 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”‡ [BUILD 197] SPEECH ENDED: duration=1196ms threshold=900ms trailing_silence=843ms first=False
prosaas-backend  | ğŸ”‡ [BUILD 197] Echo blocked (is_ai=True, cooldown=True) - NOT triggering
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=10.4dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SILENCE | SNR=5.7dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=8.4dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SILENCE | SNR=-9.5dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=23.8dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ¤ [BUILD 196.2] SPEECH STARTED (SNR=23.3dB) echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SPEECH | SNR=23.3dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | âœ… [BUILD 193] ALLOWED: Transcript 76ms after AI (within 300ms overlap grace)
prosaas-backend  | [SILENCE GATE] âŒ REJECTED (RMS=25 < 30, frames=0): '×¦×¨×™×›×” ×ª×§× ×ª ×× ×•×œ ×—×›×'
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [BUILD 197] SPEECH ENDED: duration=515ms threshold=900ms trailing_silence=514ms first=False
prosaas-backend  | ğŸš« [BUILD 197] IGNORED short utterance: 515ms < 900ms (not triggering)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=50, tx_q=115) retry #30
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”„ [BUILD 192] Recovery skipped - AI already speaking
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 552ms gap between chunks #18 and #19 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª, ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×. ×‘××™×–×• ×¢×™×¨?
prosaas-backend  | ğŸ’¾ [BUILD 196.5] AI transcript saved to conversation_history (total: 6 messages)
prosaas-backend  | ğŸ” [DEBUG CALLIBER] AI_REPLY: '×¨×§ ××•×•×“××ª, ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×. ×‘××™×–×• ×¢×™×¨?'
prosaas-backend  | â„¹ï¸ [BUILD 195] Verification phrase detected but lead NOT captured yet - NOT setting pending_confirmation
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.34s (21 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city_needs_retry=True source=ai_confirmation
prosaas-backend  | âŒ [CITY] Rejected '×—×›×.' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª, ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ“Š [BUILD 198] Stats: sent=138 blocked=360 | ğŸ¤NORMAL | noise=30 | state=SILENCE
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:33778 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=194, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=194.0 > threshold=80.0
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=14.2dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ¤ [BUILD 196.2] SPEECH STARTED (SNR=17.3dB) echo_blocked=False
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SPEECH | SNR=17.3dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ“¼ [BUILD 198] Sending 10 pre-roll frames (RAW Î¼-law)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking (user_has_spoken NOT set yet - waiting for valid utterance)
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (2 -> 0)
prosaas-backend  | â³ [BUILD 195] Speech detected - will confirm after 600ms sustained speech...
prosaas-backend  | ğŸ›¡ï¸ [BUILD 196.3] Speech detected - echo protection active (no bypass)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=143, voice_frames=0
prosaas-backend  | ğŸ”‡ [BUILD 197] SPEECH ENDED: duration=1482ms threshold=900ms trailing_silence=517ms first=False
prosaas-backend  | âœ… [BUILD 197] ACCEPTED utterance: 1482ms >= 900ms
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.5s - triggering AI response
prosaas-backend  | ğŸ“Š [AUDIO PATH] First utterance accepted: duration=1482ms, trailing_silence=517ms, first=False
prosaas-backend  | âœ… [BUILD 197] response.create queued (end of speech)
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SPEECH â†’ SILENCE | SNR=-10.5dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | âœ… [BUILD 196.3] response.create sent (manual trigger)
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjFfFSsccMdNmeZ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjFfFSsccMdNmeZ... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=18, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 6819ms gap between chunks #21 and #22 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸµ [BUILD 196.2] MUSIC DETECTED - thresholds: start=12.0dB, stop=8.0dB
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 6.1s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€” ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×ª×œ ××‘×™×‘, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’¾ [BUILD 196.5] AI transcript saved to conversation_history (total: 8 messages)
prosaas-backend  | ğŸ” [DEBUG CALLIBER] AI_REPLY: '×¨×§ ××•×•×“××ª â€” ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×ª×œ ××‘×™×‘, × ×›×•×Ÿ?'
prosaas-backend  | â„¹ï¸ [BUILD 195] Verification phrase detected but lead NOT captured yet - NOT setting pending_confirmation
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.19s (42 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×ª×œ ××‘×™×‘
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×ª×œ ××‘×™×‘'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city=×ª×œ ××‘×™×‘ source=ai_confirmation
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×ª×œ ××‘×™×‘
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×ª×œ ××‘×™×‘', 'raw_city': '×ª×œ ××‘×™×‘'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: raw_city=×ª×œ ××‘×™×‘ source=ai_confirmation
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×ª×œ ××‘×™×‘', 'raw_city': '×ª×œ ××‘×™×‘', 'city_confidence': '100.0'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: city_confidence=100.0 source=ai_confirmation
prosaas-backend  | âœ… [CITY] Auto-accepted: '×ª×œ ××‘×™×‘' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×ª×œ ××‘×™×‘', 'raw_city': '×ª×œ ××‘×™×‘', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'}
prosaas-backend  | ğŸ” [DEBUG CALLIBER] LEAD_STATE_UPDATE: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× source=ai_confirmation
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€” ××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ¤ [BUILD 196.2] Music stopped - thresholds: start=8.0dB, stop=5.0dB
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ“Š [BUILD 198] Stats: sent=222 blocked=871 | ğŸ¤NORMAL | noise=30 | state=SILENCE
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 3.0s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=47680 | silence_ms=8116
prosaas-backend  | â­ï¸ [REALTIME] END OF UTTERANCE detected - triggering AI response
prosaas-backend  | âœ… [REALTIME] response.create triggered via queue
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1011.0 > threshold=80.0
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=27.7dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | âœ… [BUILD 196.3] response.create sent (manual trigger)
prosaas-backend  | ğŸ¤ [BUILD 196.2] SPEECH STARTED (SNR=37.3dB) echo_blocked=False
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SPEECH | SNR=37.3dB | noise=30 | music=False | echo_blocked=False
prosaas-backend  | ğŸ“¼ [BUILD 198] Sending 10 pre-roll frames (RAW Î¼-law)
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjFfMVos8V4to8P...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjFfMVos8V4to8P... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 6447ms gap between chunks #42 and #43 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”‡ [BUILD 197] SPEECH ENDED: duration=880ms threshold=900ms trailing_silence=512ms first=False
prosaas-backend  | ğŸš« [BUILD 197] IGNORED short utterance: 880ms < 900ms (not triggering)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=16.1dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SILENCE | SNR=1.3dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=9.7dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SILENCE | SNR=3.5dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=9.3dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SILENCE | SNR=-0.7dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: SILENCE â†’ MAYBE_SPEECH | SNR=10.1dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ“Š [BUILD 196.2] State: MAYBE_SPEECH â†’ SILENCE | SNR=-0.3dB | noise=30 | music=False | echo_blocked=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=13, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (700ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’¾ [BUILD 196.5] AI transcript saved to conversation_history (total: 10 messages)
prosaas-backend  | ğŸ” [DEBUG CALLIBER] AI_REPLY: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.'
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.48s (69 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0