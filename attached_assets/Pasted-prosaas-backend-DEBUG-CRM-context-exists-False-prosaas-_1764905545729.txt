prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×ª×•×“×”....'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×ª×•×“×” ×¨×‘×”.', 'ts': 1764905458.6065087, 'filtered': True}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“××ªâ€”××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×›×¡×¤×ª ×‘×¢×™×¨ ×¨××œ×”, × ×›×•×Ÿ?', 'ts': 1764905458.7502744}, {'speaker': 'user', 'text': '×ª×•×“×”.', 'ts': 1764905467.5534253}]
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¨××œ×”, service_type=×× ×¢×•×œ ×›×¡×¤×ª ×‘×¢×™×¨ ×¨××œ×”
prosaas-backend  | âœ… [BUILD 163] Lead captured AND confirmed - closing call
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (lead_captured + confirmed)
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] âœ… ×”×œ×§×•×— ××™×©×¨ ××ª ×”×¤×¨×˜×™×! ×¡×™×™× ×‘×¦×•×¨×” ×× ×•××¡×ª - ×”×•×“×” ×œ×œ×§×•×— ×•×××•×¨ ×œ×”×ª×¨××•×ª.
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjGp8lEGpfXdvuG...) - skipping (SERVER_EVENT:[SERVER] âœ… ×”×œ×§×•×— ××™×©×¨ ××ª ×”×¤×¨×˜×™)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | â° [FALLBACK] Starting 10s timer for lead_captured_confirmed...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (1200ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××•×§×™×™, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.48s (38 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¨××œ×”', 'raw_city': '×¨××œ×”', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ ×›×¡×¤×ª ×‘×¢×™×¨ ×¨××œ×”'}
prosaas-backend  | âŒ [CITY] Rejected '××•×§×™×™,' (confidence=81%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××•×§×™×™, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (1200ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1200 frames (rms=28, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=113, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=309.0 > threshold=120.8
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=300 blocked=0 | active_response=None... | ai_speaking=False | user_has_spoken=True
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1259, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3821, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=2260.0 > threshold=120.8
prosaas-backend  | [PIPELINE STATUS] sent=450 blocked=0 | active_response=None... | ai_speaking=False | user_has_spoken=True
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=6083, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjGpIKxVWytgfxg...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjGpIKxVWytgfxg... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 9536ms gap between chunks #38 and #39 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âš ï¸ [FALLBACK] 10s passed, AI didn't say closing phrase - forcing polite disconnect
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ.' (hebrew=29, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (10240ms)
prosaas-backend  | ğŸ’° [COST] User utterance: 5.93s (556 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ.
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=True, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1300 frames (rms=71, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¨××œ×”', 'raw_city': '×¨××œ×”', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ ×›×¡×¤×ª ×‘×¢×™×¨ ×¨××œ×”'}
prosaas-backend  | âŒ [CITY] Rejected '×—×›×' (confidence=54%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¨××œ×”', 'raw_city': '×¨××œ×”', 'city_confidence': '100.0', 'service_type': '×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 8
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×•×œ ×—×¡××™', '×ª×•×“×” ×¨×‘×”.', '×ª×•×“×”.', '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: e453a51d...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (334a6fec â†’ e453a51d) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=e453a51d...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×”...'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 8 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×ª×•×“×”.', 'ts': 1764905467.5534253}, {'speaker': 'ai', 'text': '××•×§×™×™, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764905467.9867065}, {'speaker': 'user', 'text': '×¦×¨×™×š ×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›× ×‘××¦×¤×” ×¨××•×Ÿ.', 'ts': 1764905477.7931895}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 1377ms gap between chunks #43 and #44 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (1200ms)
prosaas-backend  | â³ [AUDIO] 2 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.62s (64 chunks)
prosaas-backend  | INFO:     127.0.0.1:39680 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 15.9s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×™×¨ ×’× ×™×, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×‘×™×ª ×©××©
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¨××œ×”', 'raw_city': '×¨××œ×”', 'city_confidence': '100.0', 'service_type': '×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×'}
prosaas-backend  | âŒ [CITY] Rejected '××œ×™×š' (confidence=84%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP] Lead captured + confirmed + auto_end=True - disconnecting
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (1200ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 163 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1500 frames (rms=8, reason=noise)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 113 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 62 frames...
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=161.0 > threshold=120.8
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #4 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1600 frames (rms=8, reason=noise)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 11 frames...
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 3300ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | WS_STOP sid=MZbb173a2b6bddaaf65598adc9c3cccfa2 rx=2332 tx=1140
prosaas-backend  | ğŸ“ [SES-e4e168b2] CALL ENDED - duration=46.6s, business_id=10, rx=2332, tx=1140
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CAac62bf63d7215a32f9eb7150b4b963f3 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:47478 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | INFO:     172.18.0.6:47492 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | âœ… Found existing recording for CAac62bf63d7215a32f9eb7150b4b963f3: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE6f71fc7096bff4b49f71276ad77da37b.json
prosaas-backend  | âœ… Recording queued for processing: CAac62bf63d7215a32f9eb7150b4b963f3
prosaas-backend  | INFO:     connection closed
prosaas-backend  | ğŸ“ [FALLBACK] Triggering hangup after lead_captured_confirmed timeout
prosaas-backend  | ğŸ“ [SMART HANGUP] === CALL ENDING ===
prosaas-backend  | ğŸ“ [SMART HANGUP] Reason: Fallback after lead_captured_confirmed
prosaas-backend  | ğŸ“ [SMART HANGUP] Lead captured: True
prosaas-backend  | ğŸ“ [SMART HANGUP] Goodbye detected: True
prosaas-backend  | ğŸ“ [SMART HANGUP] Lead state: {'city_needs_retry': 'True', 'city': '×¨××œ×”', 'raw_city': '×¨××œ×”', 'city_confidence': '100.0', 'service_type': '×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×'}
prosaas-backend  | ğŸ“ [SMART HANGUP] Required fields: ['city', 'service_type']
prosaas-backend  | ğŸ“ [SMART HANGUP] ===================
prosaas-backend  | âœ… [BUILD 163] Call CAac62bf... hung up successfully: Fallback after lead_captured_confirmed
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
^[[Bprosaas-backend  | âœ… CALL FINALIZED: CAac62bf63d7215a32f9eb7150b4b963f3
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×”×× ×¢×•×œ× ×•×ª. ×”×œ×§×•×— ××—×¤×© ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | - **××™×§×•×**: ××¦×¤×” ×¨××•×Ÿ
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ×¦×¢×¨×™, ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×”×ª×§×©×¨×•×ª ×©×œ ×”×œ×§×•×—.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×”**: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×œ× ×¦×•×™× ×” ×“×—×™×¤×•×ª, ××š ×™×© ×œ×”× ×™×— ×©×”×©×™×¨×•×ª × ×“×¨×© ×‘×”×§×“×.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×× ×¢×•×œ×Ÿ ×”××™×•×¢×“ ××ª××—×” ×‘×”×ª×§× ×ª ×× ×¢×•×œ×™× ×—×›××™×, ×•×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××ª ×›×œ ×”××™×“×¢ ×”× ×“×¨×© ×œ×’×‘×™ ×”××•×¦×¨ ×•×”×”×ª×§× ×”. ××•××œ×¥ ×œ×¢×§×•×‘ ××—×¨×™ ×”×¤× ×™×™×” ×•×œ×•×•×“× ×©×”×œ×§×•×— ××¨×•×¦×” ××”×©×™×¨×•×ª.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZbb173a2b6bddaaf65598adc9c3cccfa2 rx=2332 tx=1140
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×¨××œ×”', 'raw_city': '×¨××œ×”', 'city_confidence': '100.0', 'service_type': '×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CAac62bf63d7215a32f9eb7150b4b963f3, phone=+972504294724, city=×¨××œ×”, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×¨××œ×”, service=×‘×›×œ×œ ×”×ª×§× ×ª ×× ×•×œ ×—×›×
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×™×¨ ×’× ×™×, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×‘×™×ª ×©××©
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
^[[B^[[Bp