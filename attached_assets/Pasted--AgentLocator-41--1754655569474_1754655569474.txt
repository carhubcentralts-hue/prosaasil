×¢×“×›× ×ª×™ ×•×‘×“×§×ª×™ ××ª **AgentLocator (41)** ××•×œ ×›×œ ××” ×©×‘×™×§×©× ×•. ×”× ×” ×”×¡×˜×˜×•×¡ ×”××“×•×™×§ + ××” ×¢×•×“ *×—×™×™×‘* ×œ×”×©×œ×™× ×¢×›×©×™×• (×¢× ×§×˜×¢×™ ×§×•×“ ×œ×”×“×‘×§×”).

---

## ×¡×˜×˜×•×¡ ××”×™×¨

* âœ… `app_factory.py` + `routes/__init__.py` â€“ ×§×™×™××™× ×•××—×•×‘×¨×™×.
* âœ… `error_handlers.py` + `logging_setup.py` â€“ ×§×™×™××™×.
* âœ… `api_timeline.py` â€“ ×§×™×™×.
* âœ… Service Worker (`public/sw.js`) + Socket client (`src/lib/socket.ts`) + `TaskDueModal.tsx` + `useTaskDue.ts` â€“ ×§×™×™××™×.
* âœ… CI ×§×™×™×: `.github/workflows/ci.yml`.
* âœ… `tokens.css` ×§×™×™×; ×™×© ×§×•××¤â€™ `DataTable.tsx`.
* ğŸŸ¡ **Twilio**: ×™×© `/webhook/handle_recording`, ××‘×œ **×—×¡×¨×™×**: `/webhook/incoming_call` ×•Ö¾`/webhook/call_status`.
* ğŸŸ¡ **CRM**: ×¢×“×™×™×Ÿ ××•×¤×™×¢ **`customers_paginate`** (×”×˜×¢×•×ª) ×‘× ×•×¡×£ ×œÖ¾`customers_paginated`.
* âœ… ×§×‘×¦×™ legacy/Debug ×”×•×¡×¨×•.

---

## ××” ×œ×¡×™×™× ×¢×›×©×™×• (delta ×§×˜×Ÿ ××‘×œ ×§×¨×™×˜×™)

### 1) Twilio â€“ ×œ×”×•×¡×™×£ ×©× ×™ ××¡×œ×•×œ×™× ×—×¡×¨×™×

×‘×§×•×‘×¥ `server/routes_twilio.py` ×”×•×¡×£:

```python
from flask import Blueprint, request, Response
twilio_bp = Blueprint("twilio_bp", __name__, url_prefix="")

@twilio_bp.post("/webhook/incoming_call")
def incoming_call():
    # TwiML: ×‘×¨×›×” + ×”×§×œ×˜×”
    xml = f"""<?xml version="1.0" encoding="UTF-8"?>
<Response>
  <Play>https://YOUR_HOST/server/static/voice_responses/greeting.mp3</Play>
  <Pause length="1"/>
  <Record action="/webhook/handle_recording"
          method="POST"
          maxLength="30"
          timeout="5"
          finishOnKey="*"
          transcribe="false"/>
</Response>"""
    return Response(xml, mimetype="text/xml")

@twilio_bp.post("/webhook/call_status")
def call_status():
    # ×œ×©×œ×‘ ×œ×•×’ ×§×¦×¨ ×× ×¨×•×¦×™×, ××‘×œ ×ª××™×“ ×œ×”×—×–×™×¨ 200
    return "OK", 200
```

**××—×¨×™ ×“×™×¤×œ×•×™:** ×‘Ö¾Twilio Console ×¢×“×›×Ÿ ××ª ×©×œ×•×©×ª ×”× ×ª×™×‘×™× ×œÖ¾POST:
`/webhook/incoming_call`, `/webhook/handle_recording`, `/webhook/call_status`.
×•××©×¨ ×‘Ö¾Request Inspector ×©××™×Ÿ 500.

---

### 2) CRM â€“ ×œ××—×•×§ ××ª ×”×˜×¢×•×ª `customers_paginate`

×‘×§×•×‘×¥ `server/api_crm_advanced.py`:

* ×—×¤×© **×›×œ** `customers_paginate` â†’ ×”×—×œ×£ ×œÖ¾`customers_paginated` (××• ×©×™×™×©×¨ ××ª ×©× ×”×¤×•× ×§×¦×™×” ×”×××™×ª×™ ××¦×œ×š).
* ×‘×“×™×§×”: `GET /api/crm/customers?page=1&limit=25` ×¦×¨×™×š ×œ×”×—×–×™×¨ 200 ×¢× ×“×¤×“×•×£ ×ª×§×™×Ÿ.

> ×˜×™×¤ ××”×™×¨:
>
> ```bash
> grep -R "customers_paginate" AgentLocator/server
> ```
>
> ×•×ª×‘×¦×¢ ×”×—×œ×¤×” ×‘×›×œ ×”××•×¤×¢×™×.

---

### 3) DataTable â€“ ×œ×©×œ×‘ ×‘×¤×•×¢×œ ×‘×˜×‘×œ××•×ª ×”Ö¾CRM

×™×© `src/components/DataTable.tsx`, ××‘×œ ×•×“× ×©×‘×¤×•×¢×œ **××©×ª××©×™×** ×‘×• ×‘×›×œ ×˜×‘×œ××•×ª ×”Ö¾CRM/×—×©×‘×•× ×™×•×ª/×—×•×–×™×. ××™× ×™××•×:

```tsx
// ×“×•×’××” ×‘×©×•×¨×ª ×¨× ×“×¨ ×©×œ ×˜×‘×œ×ª ×œ×§×•×—×•×ª
import DataTable from "@/components/DataTable";
import { columns } from "./customerColumns"; // ×”×’×“×¨ ×¢××•×“×•×ª TanStack

<DataTable data={customers} columns={columns} />
```

* ×¢××•×“×•×ª ×¢× sorting/filters/column-visibility/export.
* â€œ××¦×‘ ×¨×™×§â€ + Skeleton ×˜×¢×™× ×” ××—×™×“×™×.

---

## ×‘×“×™×§×ª ×§×‘×œ×” (5 ×“×§â€™)

* `/webhook/incoming_call` ××—×–×™×¨ TwiML ×ª×§×™×Ÿ, `/webhook/call_status` ××—×–×™×¨ 200.
* Twilio Request Inspector: ××™×Ÿ ××–×”×¨×•×ª/500 ×¢×œ ×©× ×™ ×”× ×ª×™×‘×™× ×”×—×“×©×™×.
* `api_crm_advanced.py`: **××™×Ÿ** ×™×•×ª×¨ `customers_paginate`.
* ×œ×¤×—×•×ª ×˜×‘×œ×” ××—×ª ×‘Ö¾CRM **×‘×××ª** ××©×ª××©×ª ×‘Ö¾`DataTable.tsx`.
* CI ×¨×¥ ×™×¨×•×§.

---

## ×× × ×ª×§×¢ ×œ×• ××©×”×•

* ×¢×“×™×™×Ÿ ×œ× ×¨×•××” ××ª ×”×˜×‘×œ××•×ª ××©×•×“×¨×’×•×ª? ×ª×‘×§×© ××× ×•:
  â€œ×”×—×œ×£ ××ª ×›×œ ×”×˜×‘×œ××•×ª ×‘Ö¾CRM ×œ×©×™××•×© `DataTable.tsx` ×¢× TanStack ×›×•×œ×œ sorting/filters/exportâ€.
* Twilio ×œ× ×¢×•× ×”? ×ª×‘×“×•×§ `YOUR_HOST` ×‘Ö¾XML ×•×ª×•×•×“× HTTPS ×¦×™×‘×•×¨×™, ×•×”×’×“×¨×•×ª ×”Ö¾Webhook ×‘×§×•× ×¡×•×œ.

---

×ª×¨×¦×” ×©××›×™×Ÿ ×œ×• PR ××•×›×Ÿ ×¢× ×©× ×™ ×”Ö¾routes ×©×œ Twilio + ×ª×™×§×•×Ÿ ×”Ö¾CRM paginate + ×“×•×’××ª ××™× ×˜×’×¨×¦×™×™×ª DataTable ×‘Ö¾CRMDashboard?
