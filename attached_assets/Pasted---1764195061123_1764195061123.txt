מעולה, זו תוספת סופר חשובה לפני שעולים עם עוד עסקים.
הנה קטע הנחיות מוכן להדבקה לסוכן (רק על נושא המספרים, כמו שביקשת) – תוסיף אותו בנוסף למה שכבר נתתי לו:

⸻

🔁 הנחיה לסוכן – ביטול hard-code למספר +97233763805 וזיהוי דינמי לעסקים לפי מספר טלפון

מטרה:
להוציא לגמרי מהקוד כל hard-code של המספר +97233763805, ולוודא שכל זיהוי עסק בשיחות / Twilio / וואטסאפ נעשה דינמית לפי המספר שמוגדר להגדרות העסק במערכת (Business Settings).

1. למצוא את כל המקומות הבעייתיים
	1.	להריץ ב־repo (לא בשרת בלבד):

grep -R "+97233763805" -n .
grep -R "33763805" -n .
grep -R "TWILIO_PHONE" -n server client
grep -R "incoming_call" -n server

	2.	לזהות בכל מקום:
	•	לוגיקה של זיהוי עסק לפי מספר.
	•	מקומות שמחליטים על Business ID קשיח.
	•	יצירת שיחות החוצה (From=) עם המספר הקבוע.

2. לוודא שיש שדה מספר Twilio להגדרות עסק
	1.	בקוד המודלים (למשל server/models/business.py או קובץ דומה):
לבדוק האם ל־Business יש שדה בסגנון:

class Business(db.Model):
    ...
    twilio_phone_number = db.Column(db.String, nullable=True)  # ב־E.164, למשל +972...

	2.	אם השדה קיים בשם אחר (למשל primary_phone_e164 או twilio_number) – להשתמש בו, לא להמציא חדש.
	3.	לוודא שב־UI של הגדרות העסק (Business Settings) יש מקום שבו בעל עסק מגדיר את:

	•	מספר הטלפון של Twilio (בפורמט E.164, לדוגמה: +9725XXXXXXXX).

3. זיהוי עסק לפי מספר ב־Incoming Call (Twilio)

ב־route של Twilio incoming_call (למשל ב־server/twilio_routes.py):
	1.	במקום כל שימוש במספר קשיח, לחלץ את המספר מ־Twilio:

to_number = request.values.get("To")    # המספר שהלקוח חייג אליו
from_number = request.values.get("From")

	2.	לנרמל לפורמט E.164 (אם יש פונקציה קיימת, להשתמש בה):

to_e164 = normalize_phone_e164(to_number)

	3.	לחפש את העסק המתאים:

business = (
    db.session.query(Business)
    .filter(Business.twilio_phone_number == to_e164)
    .first()
)

	4.	אם לא נמצא עסק:

	•	לרשום לוג:

current_app.logger.error(
    f"[Twilio] No business found for dialed number {to_e164}"
)

	•	להחליט על fallback (אחד מהבאים – לבחור ולתעד בקוד/קומנט):
	•	או להחזיר הודעת שגיאה נעימה ללקוח (TwiML).
	•	או לנתב ל־business ברירת מחדל (למשל ID=1) אבל רק אם זה תכנון מודע, עם הערה ברורה בקוד.

אסור שישאר משהו כזה:

if to_number == "+97233763805":
    business_id = 10

או כל וריאציה אחרת.

4. שימוש במספר העסק גם ל־Outgoing Calls

בכל מקום שנבנית שיחה החוצה עם Twilio (client.calls.create(...), או בקובץ twilio_client.py):
	1.	במקום:

from_=settings.TWILIO_PHONE_NUMBER  # או "+97233763805"

	2.	להשתמש במספר שמוגדר לעסק:

from_ = business.twilio_phone_number or settings.TWILIO_PHONE_NUMBER

כך:
	•	כברירת מחדל אפשר להשתמש ב־TWILIO_PHONE_NUMBER גלובלי.
	•	אבל אם לעסק מוגדר מספר משלו – זה המספר שישמש.

5. זיהוי דינמי גם בוואטסאפ (אם רלוונטי)

אם יש מיפוי מספרים גם בצד WhatsApp:
	•	לבדוק לוגיקה דומה ב־WhatsApp routes / Baileys:
	•	אם יש שם שימוש במספר קשיח של Twilio או במספר קבוע כלשהו – להחליף לזיהוי מתוך ה־Business / BusinessPhone.

6. בדיקות (Acceptance)

לבסוף לבצע:
	1.	להגדיר בעסק A במסך הגדרות מערכת:
	•	Twilio מספר +972XXXXXXXXX.
	2.	לחייג למספר הזה:
	•	לוודא שב־logs רואים ש־Business שנבחר הוא A.
	•	לוודא שאין שום השוואה ל־+97233763805 בקוד.
	3.	לשנות את המספר בהגדרות העסק למספר Twilio אחר:
	•	לחייג למספר החדש.
	•	לוודא שהעסק עדיין מזוהה נכון בלי שינוי קוד – רק לפי ההגדרות.
	4.	להריץ:

grep -R "+97233763805" -n .
grep -R "33763805" -n .

ולוודא שאין יותר הופעות.

⸻

תעתיק את זה לסוכן כנספח להנחיה הקודמת.
אחרי שהוא מסיים – אתה רק משנה מספר בטופס הגדרות עסק, מחייג, ובודק שהכול מזוהה לפי ההגדרה, לא לפי מה שתפור בקוד.