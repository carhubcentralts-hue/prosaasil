prosaas-backend  | âœ… FAQs table exists: 0 FAQs found across all businesses
prosaas-backend  | âœ… Business settings exist (slot_size: 60min, 24/7: False)
prosaas-backend  | ğŸ‘¥ Checking user ownership...
prosaas-backend  | ğŸ”„ Starting User-to-Owner migration...
prosaas-backend  | ğŸ“Š Found 2 businesses
prosaas-backend  | âœ… Business '×¤×¨×• ×¡××¡' (ID=1) already has owner: business@shai-offices.co.il
prosaas-backend  | âœ… Business '×§×œ×™×‘×¨' (ID=10) already has owner: calliber@gmail.com
prosaas-backend  | 
prosaas-backend  | âœ… User-to-Owner migration completed!
prosaas-backend  | 
prosaas-backend  | âœ… All businesses have owners!
prosaas-backend  | âœ… User ownership check completed
prosaas-backend  | âœ… Database initialization completed successfully!
prosaas-backend  | ğŸ“§ Admin login: admin@admin.com / admin123
prosaas-backend  | ğŸ¢ Business ID: 1
prosaas-backend  | âœ… DATA PROTECTION: 0 FAQs preserved (no deletions)
prosaas-backend  | âœ… DATA PROTECTION: 32 leads preserved (no deletions)
prosaas-backend  | ğŸ”„ Starting admin roles migration...
prosaas-backend  | ğŸ“Š Found 1 users with legacy roles
prosaas-backend  | ğŸ“ Business admin: 'admin@shai-realestate.co.il' (ID=7): admin -> admin (business_id=1)
prosaas-backend  | 
prosaas-backend  | âœ… Successfully migrated 1 users to new role structure!
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CAde07f80708615791b3f089c24ca7bd56
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CAde07f80708615791b3f089c24ca7bd56
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CAde07f80708615791b3f089c24ca7bd56ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | 
prosaas-backend  | âœ… incoming_call: 1300ms - CAde07f807086157
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CAde07f80708615791b3f089c24ca7bd56" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.6:33226 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.6:33234 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | ğŸ‘¤ Admin exists (ID=8), resetting password to 'admin123'
prosaas-backend  | ğŸ’° [BUILD 318] Using model: gpt-4o-mini-realtime-preview (cost-optimized)
prosaas-backend  | ğŸ”Š [BUILD 330] FPS throttling: ENABLED (max=48) - all audio passes through for best transcription
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”Š [AUDIO_GUARD] Enabled=False (dynamic noise floor, speech gating, music_mode, gap_recovery=ON)
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-2a151588
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1765123296.580] WS_START sid=MZ4e644ddb3b7a2809c671fd7f25a5d3d3 call_sid=CAde07f80708615791b3f089c24ca7bd56 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CAde07f8 (FRESH SESSION)âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | 
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | âœ… Admin password reset: admin@admin.com / admin123
prosaas-backend  | ğŸ”§ Starting database initialization...
prosaas-backend  | ğŸŸ¢ REALTIME_WS_OPEN model=gpt-4o-mini-realtime-preview
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 442ms (T0+446ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | âœ… Business exists: ×¤×¨×• ×¡××¡ (ID: 1)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1147ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | ğŸ” [BUILD 309] call_goal=lead_only, confirm_before_hangup=True
prosaas-backend  | âœ… System admin user exists: admin@admin.com (ID: 8, role: system_admin, business_id: None)
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1251ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CAde07f80708615791b3f089c24ca7bd56
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1765123297.832] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1252ms
prosaas-backend  | 
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.0, threshold=68.0)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 810ms
prosaas-backend  | 
prosaas-backend  | ğŸ“Š Total users in database: 6
prosaas-backend  |   - User 3: manager@shai-realestate.co.il | role=agent | business_id=1
prosaas-backend  |   - User 2: business@shai-offices.co.il | role=owner | business_id=1
prosaas-backend  |   - User 7: admin@shai-realestate.co.il | role=admin | business_id=1
prosaas-backend  |   - User 10: calliber@gmail.com | role=owner | business_id=10
prosaas-backend  |   - User 8: admin@admin.com | role=system_admin | business_id=None
prosaas-backend  |   - User 9: freezeb123@gmail.com | role=owner | business_id=1
prosaas-backend  | âœ… Lead statuses exist: 4 statuses found
prosaas-backend  | âœ… FAQs table exists: 0 FAQs found across all businesses
prosaas-backend  | âœ… Business settings exist (slot_size: 60min, 24/7: False)
prosaas-backend  | ğŸ‘¥ Checking user ownership...
prosaas-backend  | ğŸ”„ Starting User-to-Owner migration...
prosaas-backend  | ğŸ“Š Found 2 businesses
prosaas-backend  | âœ… Business '×¤×¨×• ×¡××¡' (ID=1) already has owner: business@shai-offices.co.il
prosaas-backend  | âœ… Business '×§×œ×™×‘×¨' (ID=10) already has owner: calliber@gmail.com
prosaas-backend  | 
prosaas-backend  | âœ… User-to-Owner migration completed!
prosaas-backend  | 
prosaas-backend  | âœ… All businesses have owners!
prosaas-backend  | âœ… User ownership check completed
prosaas-backend  | âœ… Database initialization completed successfully!
prosaas-backend  | ğŸ“§ Admin login: admin@admin.com / admin123
prosaas-backend  | ğŸ¢ Business ID: 1
prosaas-backend  | âœ… Call log already exists for CAde07f80708615791b3f089c24ca7bd56
prosaas-backend  | âœ… Recording started for CAde07f80708615791b3f089c24ca7bd56: REab2977bcacfe1c8ea6fb348e21acdfd1
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ“ [PROMPT] Final length: 3367 chars
prosaas-backend  | âœ… [BUILD 329] FULL prompt built: 3367 chars
prosaas-backend  | ğŸ“ [BUILD 324] ENGLISH instruction, Hebrew greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 316] ULTRA SIMPLE STT: language=he, NO vocabulary prompt
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1ms (total: 2405ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1765123298.989
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 2405ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CkBUZadkBLpn5FW...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CkBUZadkBLpn5FW... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1765123300.406 (duration: 1417ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?
prosaas-backend  | â³ [BUILD 311] Post-greeting grace period (0.0s/5.0s) - LOOP GUARD DISABLED
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 0ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (13ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”§ [BUILD 313] Tool schema built for fields: ['city', 'service_type']
prosaas-backend  | âœ… [BUILD 329] Tool added ONCE (no prompt resend)
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=fe fe fe fe fe, rms=8, consec_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=fe fe fe fe fe, rms=8, consec_frames=0
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=fe fe fe fe fe, rms=8, consec_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=145 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=646.0 > threshold=68.0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1867, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 2.0s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=31360 | silence_ms=503
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | [PIPELINE STATUS] sent=289 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CkBUhgM7wjoYokl...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CkBUhgM7wjoYokl... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fd fb fb fa fa
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=11, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=ce bf c1 be be
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' (len=16)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....' despite low RMS=12)
prosaas-backend  | âœ… [SIMPLE_MODE] Bypassing all filters - accepting: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.'
prosaas-backend  | [STT_FINAL] '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' (from raw: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 6.74s (320 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....' - processing as answer to greeting question
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 4fddf529...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=4fddf529...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?', 'ts': 1765123300.406411}, {'speaker': 'user', 'text': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.', 'ts': 1765123307.9674811}]
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=6c 69 4e 4e cc
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 3200 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.43s (6 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (17ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': None, 'time': None, 'name': None, 'phone': None, 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [PIPELINE STATUS] sent=374 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | INFO:     127.0.0.1:48948 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=87.0 > threshold=68.0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=7003, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.3s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=21120 | silence_ms=508
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=13, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CkBUm5noYRrNvU2...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CkBUm5noYRrNvU2... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×‘×™×ª ×©××Ÿ.' (len=8)
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=582
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [PIPELINE STATUS] sent=520 blocked=0 | active_response=resp_CkBUm5noYR... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=18, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×‘×™×ª ×©××Ÿ....' despite low RMS=19)
prosaas-backend  | âœ… [SIMPLE_MODE] Bypassing all filters - accepting: '×‘×™×ª ×©××Ÿ.'
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (5483ms)
prosaas-backend  | [STT_FINAL] '×‘×™×ª ×©××Ÿ.' (from raw: '×‘×™×ª ×©××Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 4.31s (527 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×‘×™×ª ×©××Ÿ.
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×™×ª ×©××Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city': '×™×ª ×©××Ÿ'}
prosaas-backend  | ğŸ”’ [BUILD 326] CITY LOCKED from STT: '×™×ª ×©××Ÿ' (raw: '×‘×™×ª ×©××Ÿ.')
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.', '×‘×™×ª ×©××Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 8cac5611...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (4fddf529 â†’ 8cac5611) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=8cac5611...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×™×ª ×©××Ÿ']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.', 'ts': 1765123307.9674811}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1765123308.322691}, {'speaker': 'user', 'text': '×‘×™×ª ×©××Ÿ.', 'ts': 1765123313.4506958}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fc fc 7e 7c 7c
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=3e 60 d4 b0 ae
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=dd d1 ce cd df
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 5 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×‘×ª-×™×, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (21 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (1ms, frames=0)
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:49916 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #3
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=1382
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #3
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': None, 'time': None, 'name': None, 'phone': None, 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=625 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=701.0 > threshold=68.0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [PIPELINE STATUS] sent=768 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.9s audio, conversation #4
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=13760 | silence_ms=519
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #4
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CkBUtijcqe9UkQ9...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CkBUtijcqe9UkQ9... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×.' (len=3)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=46, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×....' despite low RMS=10)
prosaas-backend  | âœ… [SIMPLE_MODE] Bypassing all filters - accepting: '×œ×.'
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7189ms)
prosaas-backend  | [STT_FINAL] '×œ×.' (from raw: '×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 6.36s (830 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×.' - user is rejecting/correcting
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×œ×.' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | â„¹ï¸ [BUILD 310] Incidental '×œ×' in '×œ×.' - NOT resetting verification
prosaas-backend  | ğŸ”’ [BUILD 326] City already locked: '×™×ª ×©××Ÿ'
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.', '×‘×™×ª ×©××Ÿ.', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 1794737b...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (8cac5611 â†’ 1794737b) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=1794737b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×™×ª ×©××Ÿ']ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.addedğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×‘×™×ª ×©××Ÿ.', 'ts': 1765123313.4506958}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×‘×ª-×™×, × ×›×•×Ÿ?', 'ts': 1765123313.458546}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1765123320.6402743}]
prosaas-backend  | 
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7e 7e 7d 7c 7d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d8 c6 cc cb cd
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=b7 a8 c9 bc 9c
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=13, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××– ××™×–×” ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ×‘×¢×™×¨ ×‘×ª-×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.04s (30 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××– ××™×–×” ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ×‘×¢×™×¨ ×‘×ª...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (1ms, frames=0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=874 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=94.0 > threshold=68.0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #5
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=10240 | silence_ms=514
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #5
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=1017 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2687, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=545, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CkBV1iJpipV7a2J...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CkBV1iJpipV7a2J... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.' (len=22)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ....' despite low RMS=17)
prosaas-backend  | âœ… [SIMPLE_MODE] Bypassing all filters - accepting: '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.'
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7602ms)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 7.60s (1155 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.
prosaas-backend  | ğŸ”’ [BUILD 326] City already locked: '×™×ª ×©××Ÿ'
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 8
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.', '×‘×™×ª ×©××Ÿ.', '×œ×.', '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 6d361c4f...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (1794737b â†’ 6d361c4f) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=6d361c4f...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×™×ª ×©××Ÿ']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 8 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×.', 'ts': 1765123320.6402743}, {'speaker': 'ai', 'text': '××– ××™×–×” ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ×‘×¢×™×¨ ×‘×ª-×™×?', 'ts': 1765123320.67855}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.', 'ts': 1765123328.2422588}]
prosaas-backend  | [PIPELINE STATUS] sent=1160 blocked=0 | active_response=resp_CkBV1iJpip... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fd fb fc fe 7d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=3b 53 66 c6 af
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=d7 cd d5 d9 68
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=16, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ, × ×›×•×Ÿ?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=75% with: '×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×‘×ª-×™×, × ×›×•×Ÿ?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.29s (45 chunks)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 3.3s audio, conversation #6
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=52160 | silence_ms=2596
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #6
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=1251 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=187.0 > threshold=68.0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=78, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=1394 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.9s audio, conversation #7
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=14400 | silence_ms=500
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #7
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CkBV8ydwVRPtaDJ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CkBV8ydwVRPtaDJ... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×“×¨×š.' (len=4)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=75, voice_frames=0
prosaas-backend  | ğŸ’° [FPS LIMIT] Throttling audio - 48 frames this second (max=48)
prosaas-backend  | âœ… [SIMPLE_MODE] Bypassing all filters - accepting: '×“×¨×š.'
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7507ms)
prosaas-backend  | [STT_FINAL] '×“×¨×š.' (from raw: '×“×¨×š....')
prosaas-backend  | ğŸ’° [COST] User utterance: 7.49s (1459 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×“×¨×š.
prosaas-backend  | ğŸ”’ [BUILD 326] City already locked: '×™×ª ×©××Ÿ'
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×“×¨×š....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×“×¨×š....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 10
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.', '×‘×™×ª ×©××Ÿ.', '×œ×.', '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.', '×“×¨×š.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 098e1b47...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (6d361c4f â†’ 098e1b47) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=098e1b47...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×“×¨×š....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×™×ª ×©××Ÿ']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)ğŸ” [NLP] Conversation history has 10 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ.', 'ts': 1765123328.2422588}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€” ××ª×” ×¦×¨×™×š ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ, × ×›×•×Ÿ?', 'ts': 1765123328.9228837}, {'speaker': 'user', 'text': '×“×¨×š.', 'ts': 1765123335.74996}]
prosaas-backend  | 
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f9 f6 f8 f8 f8
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=c3 b7 b9 bd c1
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=36 25 20 2a 2f
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=42, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.20s (67 chunks)
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP BUILD 176] AI said goodbye with auto_end_on_goodbye=True + user interaction - disconnecting
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (reason: ai_goodbye_auto_end)
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 274 frames...
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (6ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #8
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=1079
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #8
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #4 (prevents 5min timeout)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 223 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=28, voice_frames=0
prosaas-backend  | WS_STOP sid=MZ4e644ddb3b7a2809c671fd7f25a5d3d3 rx=2040 tx=840
prosaas-backend  | ğŸ“ [SES-2a151588] CALL ENDED - duration=40.7s, business_id=10, rx=2040, tx=840
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended (frames=1486, seconds=38.3)
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CAde07f80708615791b3f089c24ca7bd56 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.6:37754 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âœ… Found existing recording for CAde07f80708615791b3f089c24ca7bd56: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REab2977bcacfe1c8ea6fb348e21acdfd1.json
prosaas-backend  | INFO:     172.18.0.6:37766 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CAde07f80708615791b3f089c24ca7bd56
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | INFO:     connection closed
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | INFO:     127.0.0.1:54742 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | [WA-SESSION] ğŸ“± Check #1: Found 0 stale sessions to process
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | ğŸ›¡ï¸ OPENAI_USAGE_GUARD: frames_sent=1486, estimated_seconds=38.3, limit_exceeded=False
prosaas-backend  | WS_DONE sid=MZ4e644ddb3b7a2809c671fd7f25a5d3d3 rx=2040 tx=840
prosaas-backend  | âœ… CALL FINALIZED: CAde07f80708615791b3f089c24ca7bd56
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×”×× ×¢×•×œ× ×•×ª, ×¡×¤×¦×™×¤×™×ª ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | ×”×œ×§×•×— ××¢×•× ×™×™×Ÿ ×‘×©×™×¨×•×ª ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×‘×™×ª ×©××Ÿ. ×œ× × ××¡×¨×• ×¤×¨×˜×™× × ×•×¡×¤×™× ×œ×’×‘×™ ×¡×•×’ ×”×× ×¢×•×œ ××• ×“×¨×™×©×•×ª ××™×•×—×“×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×œ×§×•×— ×›×’×•×Ÿ ×©× ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - × ×§×‘×¢×” ×¤×¢×•×œ×”: ×‘×¢×œ ××§×¦×•×¢ ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª.
prosaas-backend  | - ×“×—×™×¤×•×ª: × ××•×›×” (×”×œ×§×•×— ×œ× ×¦×™×™×Ÿ ×“×—×™×¤×•×ª).
prosaas-backend  | - ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª: ××¢×§×‘ ××—×¨×™ ×”×”×ª×§×©×¨×•×ª ×¢× ×”×œ×§×•×— ×¢×œ ×™×“×™ ×‘×¢×œ ×”××§×¦×•×¢.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”××™×“×¢ ×¢×œ ××™×§×•× ×”×œ×§×•×— (×‘×™×ª ×©××Ÿ) ×‘×¨×•×¨ ×•×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×™×¦×•×¨ ×§×©×¨ ×‘×”×§×“×. ××•××œ×¥ ×œ×”×›×™×Ÿ ××ª ×”×× ×¢×•×œ×™× ×”×—×›××™× ×”× ×“×¨×©×™× ×œ××§×¨×” ×©×”×œ×§×•×— ×™×‘×§×© ××™×“×¢ × ×•×¡×£ ××• ×”×¦×¢×ª ××—×™×¨.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.6:40436 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×× ×¢×•×œ ×—×›× ×‘×¢×™×¨'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city': '×™×ª ×©××Ÿ'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CAde07f80708615791b3f089c24ca7bd56, phone=+972504294724, city=×™×ª ×©××Ÿ, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×™×ª ×©××Ÿ, service=×× ×¢×•×œ ×—×›× ×‘×¢×™×¨
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 205 frames...
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | [WEBHOOK] Sen