×¡×’×•×¨. ×”× ×” â€œ×”× ×—×™×™×ªÖ¾×¢×œâ€ ××—×ª, ××“×•×™×§×ª ×œ×”×“×‘×§×” ×œ×‘×•×˜ ×‘×¨×¤×œ×™×˜, ×œ×‘× ×•×ª ×Ö¾0 **××¡×š ×”×ª×—×‘×¨×•×ª ××§×¦×•×¢×™** (React ×‘×œ×‘×“) ×¢× **×©×›×—×ª×™ ×¡×™×¡××” + ××™×¤×•×¡ ×‘××™×™×œ**, RTL ××œ×, ××•×‘×™×™×œÖ¾×¤×¨×¡×˜, ×•×œ×•×’×™×§×ª API × ×§×™×™×”. ×™×© ×¤×” ×’× ××™×š ×©×–×” ×¦×¨×™×š ×œ×”×™×¨××•×ª ×•×™×–×•××œ×™×ª ×•×’× ×‘×“×™×•×§ ××” ×œ×‘× ×•×ª ×•××™×¤×”.

---

# ğŸ¯ ××” ×‘×•× ×™×

* **React + Vite + Tailwind** (Frontend ×‘×œ×‘×“)
* ×©×œ×•×©×” ××¡×›×™×: **Login**, **Forgot**, **Reset**
* RTL + ×¢×™×¦×•×‘ ××•×“×¨× ×™ (×›×¨×˜×™×¡ ×××•×¨×›×–, ×¨×§×¢ ×’×¨×“×™×× ×˜, ×˜×™×¤×•×’×¨×¤×™×” Heebo)
* ×•×œ×™×“×¦×™×” ×—×–×§×” (react-hook-form + zod)
* ×—×™×‘×•×¨ ×œÖ¾API (××•×’×“×¨ ×‘Ö¾`VITE_API_BASE`) ×¢× `credentials: "include"` (HttpOnly cookies)
* ×”×•×“×¢×•×ª ××¦×‘ (×©×’×™××”/×”×¦×œ×—×”), ××¦×‘×™ ×˜×¢×™× ×”, × ×’×™×©×•×ª

---

# ğŸ§± ×©×œ×‘ 1 â€” ×™×¦×™×¨×ª ×¤×¨×•×™×§×˜ ×‘×¨×¤×œ×™×˜

×‘Ö¾Replit â†’ Node.js (×¨×™×§). ×‘Ö¾Shell ×”×¨×¥:

```bash
# 1) ×™×¦×™×¨×ª Vite + React + TS
npm create vite@latest auth-frontend -- --template react-ts
cd auth-frontend

# 2) Tailwind
npm i -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

# 3) ×¡×¤×¨×™×•×ª UI/×•×œ×™×“×¦×™×”/× ×ª×‘
npm i react-router-dom react-hook-form zod classnames

# 4) ×¨×™×¦×” ××§×•××™×ª ×‘×¨×¤×œ×™×˜
echo 'web: npm run dev -- --host 0.0.0.0 --port 5173' > Procfile
```

×”×’×“×¨ ×‘Ö¾Replit Secrets:

* `VITE_API_BASE` = `https://ai-crmd.replit.app` (××• ×”×“×•××™×™×Ÿ ×©×œ×š)

---

# ğŸ¨ ×©×œ×‘ 2 â€” ×¢×™×¦×•×‘ ×•×ª×¦×•×¨×” (RTL, ×¤×•× ×˜, ×˜×•×§× ×™×)

**tailwind.config.cjs**

```js
export default {
  content: ["./index.html","./src/**/*.{ts,tsx}"],
  theme: {
    extend: {
      borderRadius: { '2xl': '1rem' },
      colors: {
        brand: { 900:"#0f172a", 600:"#374151", 100:"#f3f4f6" },
        accent: { 500:"#6366f1" }
      },
      boxShadow: { soft:"0 8px 28px rgba(0,0,0,.08)" }
    }
  },
  plugins: [],
}
```

**index.html** (×‘×¨×™×¨×ª ××—×“×œ Vite) â€” ×¢×“×›×Ÿ:

```html
<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>AgentLocator â€” ×”×ª×—×‘×¨×•×ª</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

**src/index.css**

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

:root { --safe-bottom: env(safe-area-inset-bottom); }
html, body, #root { height: 100%; font-family: Heebo, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Hebrew", Arial; }
```

---

# ğŸ—‚ï¸ ×©×œ×‘ 3 â€” ××‘× ×” ×§×‘×¦×™×

```
auth-frontend/
  src/
    components/
      ui/Button.tsx
      ui/Input.tsx
      ui/PasswordInput.tsx
      ui/Toast.tsx
      AuthCard.tsx
      Brand.tsx
    pages/
      Login.tsx
      Forgot.tsx
      Reset.tsx
    lib/
      api.ts
      validators.ts
    main.tsx
    index.css
```

---

# ğŸ§© ×©×œ×‘ 4 â€” ×§×•××¤×•× × ×˜×•×ª ×‘×¡×™×¡ (×œ×”×“×‘×§×”)

**src/components/ui/Button.tsx**

```tsx
import React from "react";
import cn from "classnames";

export default function Button(
  { children, className, loading, ...props }:
  React.ButtonHTMLAttributes<HTMLButtonElement> & {loading?: boolean}
){
  return (
    <button
      {...props}
      disabled={props.disabled || loading}
      className={cn(
        "w-full min-h-[44px] rounded-2xl px-4 py-2",
        "bg-brand-900 text-white hover:opacity-95 disabled:opacity-60",
        "transition shadow-soft focus:outline-none focus:ring-2 focus:ring-accent-500",
        className
      )}
    >
      {loading ? "×˜×•×¢×Ÿâ€¦" : children}
    </button>
  );
}
```

**src/components/ui/Input.tsx**

```tsx
import React from "react";
import cn from "classnames";

export default function Input(
  {label, error, ...props}:
  React.InputHTMLAttributes<HTMLInputElement> & {label?:string; error?:string}
){
  return (
    <div className="space-y-1">
      {label && <label className="text-sm">{label}</label>}
      <input
        {...props}
        className={cn(
          "w-full px-3 py-2 border rounded-xl min-h-[44px] bg-white",
          error ? "border-red-400" : "border-gray-300",
          "focus:outline-none focus:ring-2 focus:ring-accent-500"
        )}
      />
      {error && <div className="text-xs text-red-600">{error}</div>}
    </div>
  );
}
```

**src/components/ui/PasswordInput.tsx**

```tsx
import React, { useState } from "react";
import Input from "./Input";

export default function PasswordInput(
  props: React.InputHTMLAttributes<HTMLInputElement> & {label?:string; error?:string}
){
  const [show, setShow] = useState(false);
  return (
    <div className="relative">
      <Input {...props} type={show ? "text" : "password"} />
      <button type="button"
        onClick={()=>setShow(v=>!v)}
        className="absolute left-2 top-1/2 -translate-y-1/2 text-sm opacity-70">
        {show ? "×”×¡×ª×¨" : "×”×¦×’"}
      </button>
    </div>
  );
}
```

**src/components/ui/Toast.tsx**

```tsx
import React from "react";
export function Toast({ kind="info", children }:{kind?: "info"|"error"|"success"; children:React.ReactNode}){
  const map:any = { info:"bg-blue-50 text-blue-700", error:"bg-red-50 text-red-700", success:"bg-green-50 text-green-700" };
  return <div className={`p-2 rounded-xl text-sm ${map[kind]}`}>{children}</div>;
}
```

**src/components/Brand.tsx**

```tsx
export default function Brand(){
  return (
    <div className="flex items-center gap-2">
      <div className="h-9 w-9 rounded-xl bg-brand-900 text-white grid place-items-center font-bold">AL</div>
      <div className="font-semibold">AgentLocator</div>
    </div>
  );
}
```

**src/components/AuthCard.tsx**

```tsx
import React from "react";
import Brand from "./Brand";

export default function AuthCard({title, children}:{title:string; children:React.ReactNode}){
  return (
    <div className="min-h-screen grid place-items-center px-4"
         style={{ background: "radial-gradient(80% 60% at 50% -10%, #e0e7ff 0%, transparent 60%)" }}>
      <div className="w-full max-w-md bg-white rounded-2xl shadow-soft p-6 space-y-5">
        <div className="flex items-center justify-between">
          <Brand/>
          <div className="text-sm opacity-60">×›× ×™×¡×” ×œ××¢×¨×›×ª</div>
        </div>
        <div className="text-2xl font-bold">{title}</div>
        {children}
        <div className="text-[11px] opacity-60 text-center pt-2">Â© AgentLocator</div>
      </div>
    </div>
  );
}
```

---

# ğŸ”Œ ×©×œ×‘ 5 â€” ×©×›×‘×ª API (×›×•×œ×œ CSRF ××•×¤×¦×™×•× ×œ×™)

**src/lib/api.ts**

```ts
const BASE = import.meta.env.VITE_API_BASE ?? "";

async function post(url:string, body:any){
  const r = await fetch(`${BASE}${url}`, {
    method: "POST",
    headers: { "Content-Type":"application/json" },
    credentials: "include", // ×œ×¦×¨×£ ×§×•×§×™×•×ª HttpOnly ××”×©×¨×ª
    body: JSON.stringify(body)
  });
  const data = await r.json().catch(()=> ({}));
  if(!r.ok){ const msg = data?.error || "×©×’×™××ª ×©×¨×ª"; throw new Error(msg); }
  return data;
}

export const api = {
  login: (email:string, password:string)=> post("/api/auth/login", {email, password}),
  forgot: (email:string)=> post("/api/auth/forgot", {email}),
  reset: (token:string, password:string)=> post("/api/auth/reset", {token, password}),
};
```

**src/lib/validators.ts**

```ts
import { z } from "zod";

export const emailSchema = z.string().trim().toLowerCase().email("××™××™×™×œ ×œ× ×—×•×§×™");
export const passwordSchema = z.string().min(8, "×¡×™×¡××” ×—×™×™×‘×ª 8 ×ª×•×•×™× ×•××¢×œ×”");
```

---

# ğŸ“„ ×©×œ×‘ 6 â€” ×“×¤×™ Auth (×•×™×–×•××œ×™×” + ×œ×•×’×™×§×”)

**src/pages/Login.tsx**

```tsx
import React from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import AuthCard from "../components/AuthCard";
import Input from "../components/ui/Input";
import PasswordInput from "../components/ui/PasswordInput";
import Button from "../components/ui/Button";
import { Toast } from "../components/ui/Toast";
import { api } from "../lib/api";
import { Link } from "react-router-dom";

const schema = z.object({
  email: z.string().email("××™××™×™×œ ×œ× ×—×•×§×™"),
  password: z.string().min(8, "×¡×™×¡××” ×—×™×™×‘×ª 8+")
});

export default function Login(){
  const {register, handleSubmit, formState:{errors, isSubmitting}, setError} =
    useForm<{email:string; password:string}>({resolver: zodResolver(schema)});

  const onSubmit = async (v:{email:string; password:string})=>{
    try{
      const { user } = await api.login(v.email.trim().toLowerCase(), v.password);
      // × ×™×ª×•×‘ ×œ×¤×™ ×ª×¤×§×™×“
      const target = ["admin","superadmin"].includes(user?.role) ? "/app/admin" : "/app/biz";
      location.href = target;
    } catch(e:any){ setError("password", { message: e.message || "×¤×¨×˜×™ ×”×ª×—×‘×¨×•×ª ×©×’×•×™×™×" }); }
  };

  return (
    <AuthCard title="×”×ª×—×‘×¨×•×ª">
      <form onSubmit={handleSubmit(onSubmit)} className="space-y-3" dir="rtl">
        { (errors.email || errors.password) && <Toast kind="error">×‘×“×•×§ ××ª ×”×©×“×•×ª ×”××¡×•×× ×™×</Toast> }
        <Input label="××™××™×™×œ" dir="ltr" type="email" placeholder="name@example.com"
               error={errors.email?.message} {...register("email")} />
        <PasswordInput label="×¡×™×¡××”" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
               error={errors.password?.message} {...register("password")} />
        <Button loading={isSubmitting}>×”×ª×—×‘×¨</Button>
        <div className="flex justify-between text-sm">
          <Link to="/forgot" className="text-blue-600">×©×›×—×ª×™ ×¡×™×¡××”</Link>
          <a href="/" className="opacity-70">×“×£ ×”×‘×™×ª</a>
        </div>
      </form>
    </AuthCard>
  );
}
```

**src/pages/Forgot.tsx**

```tsx
import React, { useState } from "react";
import AuthCard from "../components/AuthCard";
import Input from "../components/ui/Input";
import Button from "../components/ui/Button";
import { Toast } from "../components/ui/Toast";
import { api } from "../lib/api";
import { Link } from "react-router-dom";

export default function Forgot(){
  const [email,setEmail] = useState("");
  const [sent,setSent] = useState(false);
  const [err,setErr] = useState<string|null>(null);
  const [loading,setLoading] = useState(false);

  const submit = async (e:React.FormEvent)=>{
    e.preventDefault(); setErr(null); setLoading(true);
    try{ await api.forgot(email.trim().toLowerCase()); setSent(true); }
    catch(e:any){ setErr("×©×’×™××” ×‘×©×œ×™×—×”, × ×¡×” ×©×•×‘"); }
    finally{ setLoading(false); }
  };

  return (
    <AuthCard title="×©×—×–×•×¨ ×¡×™×¡××”">
      <form onSubmit={submit} className="space-y-3" dir="rtl">
        {err && <Toast kind="error">{err}</Toast>}
        {sent
          ? <Toast kind="success">×× ×”××™××™×™×œ ×§×™×™× â€” × ×©×œ×— ×§×™×©×•×¨ ××™×¤×•×¡.</Toast>
          : <>
              <Input label="××™××™×™×œ" dir="ltr" type="email" placeholder="name@example.com"
                     value={email} onChange={e=>setEmail(e.target.value)} />
              <Button loading={loading}>×©×œ×— ×§×™×©×•×¨ ××™×¤×•×¡</Button>
            </>
        }
        <div className="text-sm text-center"><Link to="/login" className="text-blue-600">×—×–×¨×” ×œ×”×ª×—×‘×¨×•×ª</Link></div>
      </form>
    </AuthCard>
  );
}
```

**src/pages/Reset.tsx**

```tsx
import React, { useState } from "react";
import { useSearchParams, Link } from "react-router-dom";
import AuthCard from "../components/AuthCard";
import PasswordInput from "../components/ui/PasswordInput";
import Button from "../components/ui/Button";
import { Toast } from "../components/ui/Toast";
import { api } from "../lib/api";

export default function Reset(){
  const [sp] = useSearchParams();
  const token = sp.get("token") || "";
  const [p1,setP1] = useState(""); const [p2,setP2]=useState("");
  const [msg,setMsg] = useState<string|null>(null);
  const [err,setErr] = useState<string|null>(null);
  const [loading,setLoading] = useState(false);

  const submit = async (e:React.FormEvent)=>{
    e.preventDefault(); setErr(null);
    if(p1.length < 8) return setErr("×¡×™×¡××” ×—×™×™×‘×ª 8+");
    if(p1 !== p2) return setErr("×”×¡×™×¡×××•×ª ××™× ×Ÿ ×ª×•×××•×ª");
    setLoading(true);
    try{
      await api.reset(token, p1);
      setMsg("×”×¡×™×¡××” ×¢×•×“×›× ×”! ××¢×‘×™×¨ ×œ××¡×š ×”×ª×—×‘×¨×•×ªâ€¦");
      setTimeout(()=> location.href="/auth/login", 1200);
    }catch(e:any){ setErr(e.message || "×˜×•×§×Ÿ ×œ× ×ª×§×£/×¤×’"); }
    finally{ setLoading(false); }
  };

  return (
    <AuthCard title="××™×¤×•×¡ ×¡×™×¡××”">
      <form onSubmit={submit} className="space-y-3" dir="rtl">
        {msg && <Toast kind="success">{msg}</Toast>}
        {err && <Toast kind="error">{err}</Toast>}
        <PasswordInput label="×¡×™×¡××” ×—×“×©×”" value={p1} onChange={e=>setP1(e.target.value)} />
        <PasswordInput label="××™××•×ª ×¡×™×¡××”" value={p2} onChange={e=>setP2(e.target.value)} />
        <Button loading={loading}>×©××•×¨ ×¡×™×¡××” ×—×“×©×”</Button>
        <div className="text-sm text-center"><Link to="/login" className="text-blue-600">×—×–×¨×” ×œ×”×ª×—×‘×¨×•×ª</Link></div>
      </form>
    </AuthCard>
  );
}
```

**src/main.tsx**

```tsx
import React from "react";
import ReactDOM from "react-dom/client";
import { BrowserRouter, Routes, Route, Navigate } from "react-router-dom";
import Login from "./pages/Login";
import Forgot from "./pages/Forgot";
import Reset from "./pages/Reset";
import "./index.css";

ReactDOM.createRoot(document.getElementById("root")!).render(
  <React.StrictMode>
    <BrowserRouter basename="/auth">
      <Routes>
        <Route path="/" element={<Navigate to="/login" replace/>} />
        <Route path="/login" element={<Login/>} />
        <Route path="/forgot" element={<Forgot/>} />
        <Route path="/reset" element={<Reset/>} />
        <Route path="*" element={<Navigate to="/login" replace/>} />
      </Routes>
    </BrowserRouter>
  </React.StrictMode>
);
```

---

# ğŸ“¦ ×©×œ×‘ 7 â€” ×¨×™×¦×” ×•×”×’×©×” ×‘×¨×¤×œ×™×˜

×‘Ö¾Shell:

```bash
npm run dev -- --host 0.0.0.0 --port 5173
```

×¤×ª×— ××ª ×”Ö¾Webview. ××¡×œ×•×œ:

* **/auth/login**
* **/auth/forgot**
* **/auth/reset?token=XYZ**

> ×œÖ¾Production: `npm run build` ×•××– ×œ×©×¨×ª ×¡×˜×˜×™ (××• ×œ×—×‘×¨ ×œÖ¾Flask ×©×™×©×¨×ª ××ª `/static/auth`).

---

# ğŸ›¡ï¸ ×¦×™×¤×™×•×ª ××”Ö¾API (×›×“×™ ×©×–×” ×™×¢×‘×•×“ â€œ×××™×ª×™â€)

×‘×§×¦×” ×”×©×¨×ª (×©××™× ×• ×—×œ×§ ××”×¤×¨×•× ×˜), ×¦×¨×™×š ×œ×”×ª××™× ×œÖ¾×—×•×–×”:

* `POST /api/auth/login {email,password}` â†’ 200 `{user:{role}}` + ×§×‘×™×¢×ª Session HttpOnly
* `POST /api/auth/forgot {email}` â†’ 200 ×ª××™×“; ×©×•×œ×— ×§×™×©×•×¨ ××™×¤×•×¡ ×‘××™×™×œ
* `POST /api/auth/reset {token,password}` â†’ 200 ×× ×ª×§×™×Ÿ; 400 ×× ×¤×’/×©×•××©
* × ×™×•×•×˜ ×œ××—×¨ ×”×ª×—×‘×¨×•×ª ×œ×¤×™ `user.role`:

  * `admin/superadmin` â†’ `/app/admin`
  * ××—×¨×ª â†’ `/app/biz`

---

# âœ… Definition of Done (GO/NO-GO)

* RTL ××œ×, ×¤×•× ×˜ Heebo, ×¨×¡×¤×•× ×¡×™×‘×™, ×›×¤×ª×•×¨×™× â‰¥44px, safe-area ×‘×ª×—×ª×™×ª.
* ×•×œ×™×“×¦×™×”: ×”×•×“×¢×•×ª ×©×’×™××” ×‘×¢×‘×¨×™×ª, ××¦×‘ ×˜×¢×™× ×” ×¢×œ ×”×›×¤×ª×•×¨.
* Forgot ×ª××™×“ ××¦×™×’ ×”×¦×œ×—×” × ×™×˜×¨×œ×™×ª, ×‘×œ×™ ×œ×—×©×•×£ ×× ×”××™×™×œ ×§×™×™×.
* Reset ×‘×•×“×§ ××•×¨×š ×•×¡× ×›×¨×•×Ÿ ×¡×™×¡×××•×ª, ××¦×™×’ ×”×¦×œ×—×” ×•×× ×ª×‘ ×—×–×¨×” ×œÖ¾Login.
* ×›×œ ×‘×§×©×” ×™×•×¦××ª ××œ `VITE_API_BASE` ×¢× `credentials: "include"`.
* ××™×Ÿ ×§×•× ×¡×•×œ×•×ª/×©×’×™××•×ª, ××™×Ÿ ×§×™×©×•×¨×™× ×©×‘×•×¨×™×.

---

## ğŸ§­ ××™×š ×–×” ×¦×¨×™×š ×œ×”×™×¨××•×ª (×ª×§×¦×™×¨ UX)

* ×¨×§×¢ ×’×¨×“×™×× ×˜ ×¢×“×™×Ÿ (â€œ×”×™×œ×”â€ ×××—×•×¨×”), ×›×¨×˜×™×¡ ×œ×‘×Ÿ ×¢× **rounded-2xl**, ×¦×œ **shadow-soft**.
* ×›×•×ª×¨×ª ×¢×œ×™×•× ×”: ×œ×•×’×• â€œALâ€ + â€œAgentLocatorâ€.
* ×©×“×•×ª ×’×“×•×œ×™×, ×‘×¨×•×¨×™×, **dir="rtl"**, ××™××™×™×œ **dir="ltr"**.
* Toast×™× ×§×˜× ×™× ×œ×©×’×™××•×ª/×”×¦×œ×—×•×ª.
* ×›×¤×ª×•×¨ ×¨××©×™ ×›×”×” (brand-900), ×˜×§×¡×˜ ×œ×‘×Ÿ.
* ×§×™×©×•×¨×™×: ×›×—×•×œ 600 (â€œ×©×›×—×ª×™ ×¡×™×¡××”â€, â€œ×—×–×•×¨â€).
* ×‘××•×‘×™×™×œ: ×”×›×œ ××¨×›×–×™, ×œ×œ× ×’×œ×™×œ×” ××•×¤×§×™×ª, ××¨×•×•×—×™× × ×“×™×‘×™×.

---

×¨×•×¦×” ×©××›×™×Ÿ ×œ×š **Zip ×§×•×“ ××•×›×Ÿ** ×©×œ ×”×¤×¨×•× ×˜ (×‘×œ×™ ×©×¨×ª) ×©×ª×•×›×œ ×œ×”×¢×œ×•×ª ××—×“ ×œ××—×“ ×œ×¨×¤×œ×™×˜? ××• ×œ×”×•×¡×™×£ â€œ××¦×‘ Mockâ€ (MSW) ×›×“×™ ×œ×‘×“×•×§ ×‘×œ×™ API?
