  | ...
prosaas-backend  | ================================================================================
prosaas-backend  | ğŸ“… Today calculated as: 2025-12-05 (Friday)
prosaas-backend  | ğŸ“… Tomorrow calculated as: 2025-12-06
prosaas-backend  | ================================================================================
prosaas-backend  | 
prosaas-backend  | âœ… create_booking_agent RETURNED: True
prosaas-backend  | â±ï¸  AGENT_CREATION_TIME: 111ms
prosaas-backend  |   âœ… ×¤×¨×• ×¡××¡ (calls): 364ms
prosaas-backend  |   âœ… ×¤×¨×• ×¡××¡ (calls): 364ms
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (calls)
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (calls)
prosaas-backend  | ğŸ“‹ PROMPT LOADING: business_id=1, channel=whatsapp, custom_instructions provided=False
prosaas-backend  | ğŸ“‹ LOADING PROMPT: business_id=1, business_name=×¤×¨×• ×¡××¡
prosaas-backend  | âœ… Loaded whatsapp prompt from DB for business=1 (2856 chars)
prosaas-backend  | ğŸ“ PROMPT PREVIEW: You are the WhatsApp digital assistant of **ProSaaS**.  
prosaas-backend  | Although this prompt is written in English,...
prosaas-backend  | ğŸ”¨ CALLING create_booking_agent(business_id=1, channel=whatsapp)
prosaas-backend  | 
prosaas-backend  | âœ… Using DB prompt for ×¤×¨×• ×¡××¡ (2856 chars)
prosaas-backend  |    System rules: 4173 chars (prepended)
prosaas-backend  |    DB prompt: 2856 chars
prosaas-backend  |    = Total: 7029 chars
prosaas-backend  | 
prosaas-backend  | ================================================================================
prosaas-backend  | ğŸ“œ AGENT INSTRUCTIONS (first 500 chars):
prosaas-backend  | ================================================================================
prosaas-backend  | ğŸ”’ SYSTEM CONTEXT (READ BUT DON'T MENTION):
prosaas-backend  | TODAY: 2025-12-05 18:26 (Israel)
prosaas-backend  | TOMORROW: 2025-12-06
prosaas-backend  | APPOINTMENT INTERVALS: ×ª×•×¨×™× ×‘×¢×¡×§ ×”×–×” × ×™×ª× ×™× ×œ×§×‘×™×¢×” ×›×œ ×©×¢×” (60 ×“×§×•×ª)
prosaas-backend  | 
prosaas-backend  | âš ï¸ CRITICAL ANTI-HALLUCINATION RULES (BUILD 112):
prosaas-backend  | 1. NEVER say "×§×‘×¢×ª×™"/"×”×¤×’×™×©×” × ×§×‘×¢×”" UNLESS you called calendar_create_appointment() THIS turn and got ok:true
prosaas-backend  | 2. NEVER say "×ª×¤×•×¡"/"×¤× ×•×™"/"×™×© ×ª×•×¨" UNLESS you called calendar_find_slots() THIS turn
prosaas-backend  | 3. NEVER say "×©×œ×—×ª×™ ××™×©×•×¨" UNLESS you called whatsapp_send() THIS turn
prosaas-backend  | 4. ğŸ”¥ BUILD 112: 
prosaas-backend  | ...
prosaas-backend  | ================================================================================
prosaas-backend  | ğŸ“… Today calculated as: 2025-12-05 (Friday)
prosaas-backend  | ğŸ“… Tomorrow calculated as: 2025-12-06
prosaas-backend  | ================================================================================
prosaas-backend  | 
prosaas-backend  | âœ… create_booking_agent RETURNED: True
prosaas-backend  | â±ï¸  AGENT_CREATION_TIME: 428ms
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (whatsapp)
prosaas-backend  | 
prosaas-backend  | ğŸ‰ WARMUP COMPLETE: 4 agents ready in 2167ms
prosaas-backend  | âœ… Warmed: ×¤×¨×• ×¡××¡ (whatsapp)  âœ… ×¤×¨×• ×¡××¡ (whatsapp): 319ms
prosaas-backend  | 
prosaas-backend  | 
prosaas-backend  | ğŸ‰ WARMUP COMPLETE: 4 agents ready in 1860ms
prosaas-backend  |   âœ… ×¤×¨×• ×¡××¡ (whatsapp): 320ms
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (calls): 0ms
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (calls): 0ms
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (whatsapp): 0ms
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ğŸ”¥ğŸ”¥ WARMUP COMPLETE: 4/4 agents ready in 1222ms
prosaas-backend  | ğŸš€ System preheated - First AI response will be FAST!
prosaas-backend  | 
prosaas-backend  |   âœ… ×§×œ×™×‘×¨ (whatsapp): 0ms
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ğŸ”¥ğŸ”¥ WARMUP COMPLETE: 4/4 agents ready in 1221ms
prosaas-backend  | ğŸš€ System preheated - First AI response will be FAST!
prosaas-backend  | 
prosaas-backend  | âœ… Service warmup thread completed
prosaas-backend  | âœ… Service warmup thread completed
prosaas-backend  | âœ… DATA PROTECTION: 0 FAQs preserved (no deletions)
prosaas-backend  | âœ… DATA PROTECTION: 25 leads preserved (no deletions)
prosaas-backend  | ğŸ”„ Starting admin roles migration...
prosaas-backend  | ğŸ“Š Found 1 users with legacy roles
prosaas-backend  | ğŸ“ Business admin: 'admin@shai-realestate.co.il' (ID=7): admin -> admin (business_id=1)
prosaas-backend  | 
prosaas-backend  | âœ… Successfully migrated 1 users to new role structure!
prosaas-backend  | INFO:     172.18.0.5:33248 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:33260 - "GET /api/auth/me HTTP/1.1" 401 Unauthorized
prosaas-backend  | ğŸ‘¤ Admin exists (ID=8), resetting password to 'admin123'
prosaas-backend  | âœ… Admin password reset: admin@admin.com / admin123
prosaas-backend  | ğŸ”§ Starting database initialization...
prosaas-backend  | âœ… Business exists: ×¤×¨×• ×¡××¡ (ID: 1)
prosaas-backend  | âœ… System admin user exists: admin@admin.com (ID: 8, role: system_admin, business_id: None)
prosaas-backend  | 
prosaas-backend  | ğŸ“Š Total users in database: 6
prosaas-backend  |   - User 3: manager@shai-realestate.co.il | role=agent | business_id=1
prosaas-backend  |   - User 2: business@shai-offices.co.il | role=owner | business_id=1
prosaas-backend  |   - User 7: admin@shai-realestate.co.il | role=admin | business_id=1
prosaas-backend  |   - User 10: calliber@gmail.com | role=owner | business_id=10
prosaas-backend  |   - User 9: freezeb123@gmail.com | role=owner | business_id=1
prosaas-backend  |   - User 8: admin@admin.com | role=system_admin | business_id=None
prosaas-backend  | âœ… Lead statuses exist: 4 statuses found
prosaas-backend  | âœ… FAQs table exists: 0 FAQs found across all businesses
prosaas-backend  | âœ… Business settings exist (slot_size: 60min, 24/7: False)
prosaas-backend  | ğŸ‘¥ Checking user ownership...
prosaas-backend  | ğŸ”„ Starting User-to-Owner migration...
prosaas-backend  | ğŸ“Š Found 2 businesses
prosaas-backend  | âœ… Business '×¤×¨×• ×¡××¡' (ID=1) already has owner: business@shai-offices.co.il
prosaas-backend  | ğŸ” LOGIN ATTEMPT: email=calliber@gmail.com
prosaas-backend  | âœ… Business '×§×œ×™×‘×¨' (ID=10) already has owner: calliber@gmail.com
prosaas-backend  | 
prosaas-backend  | âœ… User-to-Owner migration completed!
prosaas-backend  | 
prosaas-backend  | âœ… All businesses have owners!
prosaas-backend  | âœ… User ownership check completed
prosaas-backend  | âœ… Database initialization completed successfully!
prosaas-backend  | ğŸ“§ Admin login: admin@admin.com / admin123
prosaas-backend  | ğŸ¢ Business ID: 1
prosaas-backend  | âœ“ Found user: id=10, email=calliber@gmail.com, role=owner
prosaas-backend  | âœ“ Password hash: scrypt:32768:8:1$NwJjYhcFJjcNjejm$9cc6e19d7dbac0ba...
prosaas-backend  | âœ“ Password verification result: True
prosaas-backend  | âœ… DATA PROTECTION: 0 FAQs preserved (no deletions)
prosaas-backend  | âœ… DATA PROTECTION: 25 leads preserved (no deletions)
prosaas-backend  | ğŸ”„ Starting admin roles migration...
prosaas-backend  | ğŸ“Š Found 1 users with legacy roles
prosaas-backend  | ğŸ“ Business admin: 'admin@shai-realestate.co.il' (ID=7): admin -> admin (business_id=1)
prosaas-backend  | 
prosaas-backend  | âœ… Successfully migrated 1 users to new role structure!
prosaas-backend  | ğŸ” LOGIN SUCCESS: user_id=10, email=calliber@gmail.com, role=owner, business_id=10
prosaas-backend  | INFO:     172.18.0.5:33268 - "POST /api/auth/login HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:33284 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:33298 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:51492 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ‘¤ Admin exists (ID=8), resetting password to 'admin123'
prosaas-backend  | âœ… Admin password reset: admin@admin.com / admin123
prosaas-backend  | ğŸ”§ Starting database initialization...
prosaas-backend  | âœ… Business exists: ×¤×¨×• ×¡××¡ (ID: 1)
prosaas-backend  | âœ… System admin user exists: admin@admin.com (ID: 8, role: system_admin, business_id: None)
prosaas-backend  | 
prosaas-backend  | ğŸ“Š Total users in database: 6
prosaas-backend  |   - User 3: manager@shai-realestate.co.il | role=agent | business_id=1
prosaas-backend  |   - User 2: business@shai-offices.co.il | role=owner | business_id=1
prosaas-backend  |   - User 7: admin@shai-realestate.co.il | role=admin | business_id=1
prosaas-backend  |   - User 9: freezeb123@gmail.com | role=owner | business_id=1
prosaas-backend  |   - User 10: calliber@gmail.com | role=owner | business_id=10
prosaas-backend  |   - User 8: admin@admin.com | role=system_admin | business_id=None
prosaas-backend  | âœ… Lead statuses exist: 4 statuses found
prosaas-backend  | INFO:     172.18.0.5:51494 - "GET /api/dashboard/stats?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | âœ… FAQs table exists: 0 FAQs found across all businesses
prosaas-backend  | âœ… Business settings exist (slot_size: 60min, 24/7: False)
prosaas-backend  | ğŸ‘¥ Checking user ownership...
prosaas-backend  | ğŸ”„ Starting User-to-Owner migration...
prosaas-backend  | ğŸ“Š Found 2 businesses
prosaas-backend  | âœ… Business '×¤×¨×• ×¡××¡' (ID=1) already has owner: business@shai-offices.co.il
prosaas-backend  | âœ… Business '×§×œ×™×‘×¨' (ID=10) already has owner: calliber@gmail.com
prosaas-backend  | 
prosaas-backend  | âœ… User-to-Owner migration completed!
prosaas-backend  | 
prosaas-backend  | âœ… All businesses have owners!
prosaas-backend  | âœ… User ownership check completed
prosaas-backend  | âœ… Database initialization completed successfully!
prosaas-backend  | ğŸ“§ Admin login: admin@admin.com / admin123
prosaas-backend  | ğŸ¢ Business ID: 1
prosaas-backend  | INFO:     172.18.0.5:51510 - "GET /api/dashboard/activity?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:51524 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:51528 - "GET /api/business/current HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:51540 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:51544 - "GET /api/business/current HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:51558 - "GET /api/business/current/prompt HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:52168 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA347d60ff712abfb15d0251de0f8d38fc
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA347d60ff712abfb15d0251de0f8d38fc
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA347d60ff712abfb15d0251de0f8d38fcğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | âœ… incoming_call: 1307ms - CA347d60ff712abf
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA347d60ff712abfb15d0251de0f8d38fc" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:42834 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:37526 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-28adf1d7
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764951993.116] WS_START sid=MZaf0db2ca9a68434ccec0f830bbe0bb39 call_sid=CA347d60ff712abfb15d0251de0f8d38fc from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA347d60 (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 812ms (T0+818ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1081ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1188ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA347d60ff712abfb15d0251de0f8d38fc
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764951994.306] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1190ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.1, threshold=108.0)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 375ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | âœ… Call log already exists for CA347d60ff712abfb15d0251de0f8d38fc
prosaas-backend  | âœ… Recording started for CA347d60ff712abfb15d0251de0f8d38fc: REebefcc3eec09bca796c3092093708259
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1075ms (total: 2262ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764951995.383
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 2262ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSvbav6HxVhnr5...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSvbav6HxVhnr5... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764951996.876 (duration: 1492ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (53ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1619ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.8s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (12ms, frames=0)
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=7c 7e fa 7e 78, rms=95, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=78 f6 78 fe fc, rms=74, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=6e f6 f8 6f f6, rms=142, consec_frames=5
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=142.0 > threshold=108.0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=127, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | INFO:     172.18.0.5:37534 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1055, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=123, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSvl52QZLbqUOm...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSvl52QZLbqUOm... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=11, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fe fd fd fd fd
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=11, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=cc bf c4 c5 c8
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=26)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥...' despite low RMS=12)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew_chars=30)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew=30, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.43s (147 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....' - processing as answer to greeting question
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¦×¨×™×š' (confidence=47%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: f6be4cd2...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=f6be4cd2...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764951996.875977}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952005.817923}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=bf bd 63 df 58
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 3 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.41s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (31ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 3.0s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=48320 | silence_ms=5779
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=247, reason=insufficient_consec_frames(1/3))
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=247.0 > threshold=108.0
prosaas-backend  | [PIPELINE STATUS] sent=148 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1324, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=21, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.3s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=21440 | silence_ms=510
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | INFO:     127.0.0.1:49646 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSvsNnkxU71k42...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSvsNnkxU71k42... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=36, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×¨×™×™×ª ×’×ª.' (len=9)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=29, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×¨×™×™×ª ×’×ª....' despite low RMS=28)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×§×¨×™×™×ª ×’×ª.' (hebrew_chars=7)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×¨×™×™×ª ×’×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×¨×™×™×ª ×’×ª.' (hebrew=7, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7737ms)
prosaas-backend  | [STT_FINAL] '×§×¨×™×™×ª ×’×ª.' (from raw: '×§×¨×™×™×ª ×’×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.18s (247 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×¨×™×™×ª ×’×ª.
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ×’×ª.
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª.'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=91.64705882352942
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª.', 'city_confidence': '91.64705882352942'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª.', 'city_confidence': '91.64705882352942', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×§×¨×™×™×ª ×’×ª' (confidence=92%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×¨×™×™×ª ×’×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×¨×™×™×ª ×’×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×§×¨×™×™×ª ×’×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 50036f95...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (f6be4cd2 â†’ 50036f95) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=50036f95...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×¨×™×™×ª ×’×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×§×¨×™×™×ª ×’×ª']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952005.817923}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952007.1502469}, {'speaker': 'user', 'text': '×§×¨×™×™×ª ×’×ª.', 'ts': 1764952013.5553887}]
prosaas-backend  | 
prosaas-backend  | âš ï¸ [AUDIO GAP] 6592ms gap between chunks #6 and #7 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=33, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ªâ€”××ª×” ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.47s (26 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (7ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×§×¨×™×™×ª ×’×ª.' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª.', 'city_confidence': '91.64705882352942', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª', 'city_confidence': '91.64705882352942', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª', 'city_confidence': '100.0', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×§×¨×™×™×ª ×’×ª' from ['×©×œ×•×!', '×¦×¨×™×š', '×¢×™×¨', '×§×¨×™×™×ª ×’×ª.', '×§×¨×™×™×ª ×’×ª']
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ªâ€”××ª×” ×¦×¨×™×š ×¤×¨×™×¦×ª ×“×œ×ª×•×ª...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | WS_STOP sid=MZaf0db2ca9a68434ccec0f830bbe0bb39 rx=1424 tx=597
prosaas-backend  | ğŸ“ [SES-28adf1d7] CALL ENDED - duration=28.3s, business_id=10, rx=1424, tx=597
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA347d60ff712abfb15d0251de0f8d38fc stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:56182 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | âœ… Found existing recording for CA347d60ff712abfb15d0251de0f8d38fc: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REebefcc3eec09bca796c3092093708259.json
prosaas-backend  | INFO:     172.18.0.5:56186 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CA347d60ff712abfb15d0251de0f8d38fc
prosaas-backend  | INFO:     connection closed
prosaas-backend  | [WA-SESSION] ğŸ“± Check #1: Found 0 stale sessions to process
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âœ… call_log created immediately for CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1243ms - CA1e1acd7b444cb4
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA1e1acd7b444cb4749b3d02dce41920c5" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:59864 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:59870 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-fb4779be
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952025.149] WS_START sid=MZ5b86d5e3cd2180bf6e7371476e6a99a5 call_sid=CA1e1acd7b444cb4749b3d02dce41920c5 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA1e1acd (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 465ms (T0+466ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1058ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1163ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764952026.314] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1165ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=15.2, threshold=115.2)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 702ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 0ms (total: 1167ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952026.317
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1167ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSw69K1Od7e5BV...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSw69K1Od7e5BV... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Call log already exists for CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Recording started for CA1e1acd7b444cb4749b3d02dce41920c5: REfabf89f46ac0e013739b5e5d220b7a92
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952027.690 (duration: 1373ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZaf0db2ca9a68434ccec0f830bbe0bb39 rx=1424 tx=597
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (49ms, frames=0)
prosaas-backend  | âœ… CALL FINALIZED: CA347d60ff712abfb15d0251de0f8d38fc
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×©×™×—×ª ×œ×§×•×— ×¢× ×©×™×¨×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª, ×‘×ª×—×•× ×”×× ×¢×•×œ×™× ×•×”××‘×˜×—×”.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | ×”×œ×§×•×— ×–×§×•×§ ×œ×©×™×¨×•×ª ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª. ×œ× × ××¡×¨×• ×¤×¨×˜×™× × ×•×¡×¤×™× ×œ×’×‘×™ ×¡×•×’ ×”×“×œ×ª ××• ×“×—×™×¤×•×ª ×”×©×™×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×©× ×”×œ×§×•×— ×œ× × ××¡×¨, ××š ×™×© ×œ×•×•×“× ××ª ×¤×¨×˜×™ ×”×”×ª×§×©×¨×•×ª ×‘×”××©×š.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - ×œ× × ×§×‘×¢×” ×¤×’×™×©×” ××• ×ª×•×¨ ×‘×©×™×—×” ×–×•.
prosaas-backend  | - ×“×—×™×¤×•×ª ×”×©×™×¨×•×ª ×œ× ×”×•×’×“×¨×”, ××š ×™×© ×œ×”× ×™×— ×©×”×™× ×’×‘×•×”×” ×œ××•×¨ ×”×‘×§×©×” ×œ×¤×¨×™×¦×ª ×“×œ×ª.
prosaas-backend  | - ×™×© ×¦×•×¨×š ×‘××¢×§×‘ ×œ×”×©×œ××ª ×”×¤×¨×˜×™× ×”×—×¡×¨×™× ×•×”×¦×¢×ª ××—×™×¨.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×—×©×•×‘ ×œ×•×•×“× ××ª ×¤×¨×˜×™ ×”×œ×§×•×— ×•×œ×‘×¨×¨ ××ª ×”×“×—×™×¤×•×ª ×”××“×•×™×§×ª ×©×œ ×”×©×™×¨×•×ª, ×›×“×™ ×œ×¡×¤×§ ××¢× ×” ××”×™×¨ ×•×™×¢×™×œ. ××•××œ×¥ ×’× ×œ×‘×“×•×§ ×× ×™×© ×¦×•×¨×š ×‘×©×™×¨×•×ª×™× × ×•×¡×¤×™× ×›××• ×”×—×œ×¤×ª ×× ×¢×•×œ ×œ××—×¨ ×”×¤×¨×™×¦×”.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×¨×™×¦×ª ×“×œ×ª×•×ª'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×™×ª ×’×ª', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA347d60ff712abfb15d0251de0f8d38fc, phone=+972504294724, city=×§×¨×™×™×ª ×’×ª, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×§×¨×™×™×ª ×’×ª, service=×¤×¨×™×¦×ª ×“×œ×ª×•×ª
prosaas-backend  | 
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1634ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (2ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.8s - now updating session
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=185.0 > threshold=115.2
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=f4 6c f2 f6 72, rms=161, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=fe 6f ea f6 74, rms=101, consec_frames=4
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | INFO:     172.18.0.5:59872 - "GET /api/business/current HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=21 26 2c 37 4a, rms=4612, consec_frames=3
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | INFO:     172.18.0.5:59888 - "GET /api/business/current/prompt HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ×’×ª, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSwCZuSTpQ0ZOT...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSwCZuSTpQ0ZOT... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18274ms gap between chunks #26 and #27 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | INFO:     172.18.0.5:59896 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=14, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 43 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.95s (44 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×¢×“×™×™×Ÿ' differs from locked '×§×¨×™×™×ª ×’×ª.'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×§×¨×™×™×ª ×’×ª.' (reason: user_said_×¢×“×™×™×Ÿ)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×§×¨×™×™×ª ×’×ª', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×¢×“×™' (confidence=90%)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 43 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=11, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=486.0 > threshold=115.2
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=7 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2911, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1234, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3034, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=157 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSwK1VDrirnnWx...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSwK1VDrirnnWx... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=369.0 > threshold=115.2
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=38, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.' (len=27)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.' (hebrew_chars=22)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.' (hebrew=22, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘....')
prosaas-backend  | ğŸ’° [COST] User utterance: 10.75s (182 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘....' - processing as answer to greeting question
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=104, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×× ×¢×•×œ×Ÿ' (confidence=59%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 4dd56fd8...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=4dd56fd8...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952027.690517}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.', 'ts': 1764952040.935751}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=ce c5 cb ce d8
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=ee ce cb c9 c6
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=b7 9a a6 bc a2
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 4268 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 3 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (33ms, frames=0)
prosaas-backend  | INFO:     127.0.0.1:49688 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=11, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=177, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=177.0 > threshold=115.2
prosaas-backend  | [PIPELINE STATUS] sent=200 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSwQ4Ae1l0VOF9...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSwQ4Ae1l0VOF9... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=13, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×©×¨×™×™×ª ××ª×¨.' (len=10)
prosaas-backend  | [STT_REPAIRED] '×©×¨×™×™×ª ××ª×¨.' â†’ '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.'
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨....' despite low RMS=11)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.' (hebrew_chars=13)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.' (hebrew=13, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6790ms)
prosaas-backend  | [STT_FINAL] '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.' (from raw: '×©×¨×™×™×ª ××ª×¨....')
prosaas-backend  | ğŸ’° [COST] User utterance: 5.16s (278 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=10, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×¨×™×™×ª' (confidence=81%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.', '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: f8433e31...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (4dd56fd8 â†’ f8433e31) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=f8433e31...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨....'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘.', 'ts': 1764952040.935751}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952041.8190367}, {'speaker': 'user', 'text': '×©×¨×™×™×ª ××ª×¨ ×§×œ×™×‘×¨.', 'ts': 1764952047.7256148}]
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 6351ms gap between chunks #6 and #7 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=13, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘ ×‘×¢×™×¨ ×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.04s (24 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (16ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=9, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [CITY] Auto-accepted: '×§×¨×™×™×ª ××ª×' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (23ms, frames=0)
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSwU7zXC5eZ48w...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSwU7zXC5eZ48w... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 17922ms gap between chunks #44 and #45 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 87 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?...'
prosaas-backend  | âš ï¸ [LOOP GUARD] Triggered by semantic_repetition!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Cleared TX queue
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Sent clear to Twilio
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.01s (63 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×¢×“×™×™×Ÿ' (majority 2/2)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['×©×œ×•×!', '×¦×¨×™×š', '×¢×™×¨', '×§×¨×™×™×ª ×’×ª.', '×§×¨×™×™×ª ×’×ª', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢×¦××š. ×××•×¨: '×œ× ×©××¢×ª×™ ×˜×•×‘, ××¤×©×¨ ×œ×—×–×•×¨?' ×•×ª××ª×™×Ÿ ×‘×©×§×˜.
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SERVER_EVENT:[SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=8, reason=noise)
prosaas-backend  | WS_STOP sid=MZ5b86d5e3cd2180bf6e7371476e6a99a5 rx=1449 tx=552
prosaas-backend  | ğŸ“ [SES-fb4779be] CALL ENDED - duration=29.0s, business_id=10, rx=1449, tx=552
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA1e1acd7b444cb4749b3d02dce41920c5 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:52348 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | INFO:     172.18.0.5:52362 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA1e1acd7b444cb4749b3d02dce41920c5: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REfabf89f46ac0e013739b5e5d220b7a92.json
prosaas-backend  | âœ… Recording queued for processing: CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | INFO:     connection closed
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âœ… CALL FINALIZED: CA1e1acd7b444cb4749b3d02dce41920c5
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×œ×§×•×— ××—×¤×© ×©×™×¨×•×ª×™ ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘ ×‘×¢×™×¨ ×§×¨×™×™×ª ××ª×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª**: ×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | - **××™×§×•×**: ×§×¨×™×™×ª ××ª×
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×©× ×”×œ×§×•×— ×œ× × ××¡×¨, ××š ×”×•× × ××¦× ×‘×¢×™×¨ ×§×¨×™×™×ª ××ª×.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×œ×§×‘×•×¢ ××•×¢×“ ×œ×¤×’×™×©×” ×¢× ×”×× ×¢×•×œ×Ÿ.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×œ× ×¦×•×™× ×” ×“×—×™×¤×•×ª, ××š ×™×© ×œ×”× ×™×— ×©×”×©×™×¨×•×ª × ×“×¨×© ×‘×”×§×“×.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××ª ×”×©×™×¨×•×ª ×‘××”×™×¨×•×ª ×”××¤×©×¨×™×ª, ×‘××™×•×—×“ ×× ××“×•×‘×¨ ×‘××¦×‘ ×—×™×¨×•× ×¢× ×¨×›×‘ × ×¢×•×œ. ××•××œ×¥ ×œ×¢×“×›×Ÿ ××ª ×”×œ×§×•×— ×¢×œ ×–××™× ×•×ª ×”×× ×¢×•×œ× ×™× ×‘×¢×™×¨ ×§×¨×™×™×ª ××ª×.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA1e1acd7b444cb4749b3d02dce41920c5, phone=+972504294724, city=×§×¨×™×™×ª ××ª×, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×§×¨×™×™×ª ××ª×, service=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ5b86d5e3cd2180bf6e7371476e6a99a5 rx=1449 tx=552
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:52376 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××ª×, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSwkWb9XJv7YHK...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSwkWb9XJv7YHK... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18615ms gap between chunks #24 and #25 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 731ms gap between chunks #35 and #36 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 43 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.43s (42 chunks)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×¢×“×™' (confidence=90%)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 43 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | INFO:     127.0.0.1:42624 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.3s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSx4AZXjXXrrgt...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSx4AZXjXXrrgt... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18535ms gap between chunks #42 and #43 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 85 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?...'
prosaas-backend  | âš ï¸ [LOOP GUARD] Triggered by semantic_repetition!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Cleared TX queue
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Sent clear to Twilio
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.88s (59 chunks)
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×¢×“×™×™×Ÿ' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'service_type': '×× ×¢×•×œ×Ÿ ×œ×¨×›×‘', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['×©×œ×•×!', '×× ×¢×•×œ×Ÿ', '×¢×™×¨', '×©×¨×™×™×ª', '×§×¨×™×™×ª ××ª×', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢×¦××š. ×××•×¨: '×œ× ×©××¢×ª×™ ×˜×•×‘, ××¤×©×¨ ×œ×—×–×•×¨?' ×•×ª××ª×™×Ÿ ×‘×©×§×˜.
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SERVER_EVENT:[SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:50192 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | INFO:     127.0.0.1:43772 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:51228 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:47184 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:47186 - "GET /api/auth/me HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:47194 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:47210 - "GET /api/business/current HTTP/1.1" 200 OK
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA5bd7447b8c3d8f191ecc7726032c5ba0
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA5bd7447b8c3d8f191ecc7726032c5ba0
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA5bd7447b8c3d8f191ecc7726032c5ba0ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | âœ… incoming_call: 1288ms - CA5bd7447b8c3d8f
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA5bd7447b8c3d8f191ecc7726032c5ba0" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:47226 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:47236 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-5c4f2486
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952130.335] WS_START sid=MZ9a7ff47fa5bfdc7b288b47b8463e3879 call_sid=CA5bd7447b8c3d8f191ecc7726032c5ba0 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA5bd744 (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 458ms (T0+461ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1072ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1178ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA5bd7447b8c3d8f191ecc7726032c5ba0
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764952131.514] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1180ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.0, threshold=108.0)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 721ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 0ms (total: 1180ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952131.517
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1180ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSxnSn8R4UE1gZ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSxnSn8R4UE1gZ... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | INFO:     127.0.0.1:43924 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Call log already exists for CA5bd7447b8c3d8f191ecc7726032c5ba0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Recording started for CA5bd7447b8c3d8f191ecc7726032c5ba0: REa3509a7f8742342b3c4dc6b86c7f5c61
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952133.023 (duration: 1505ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (23ms, frames=0)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×‘×¢×™×¨ ×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | ğŸ”‡ [SILENCE] Final chance already given - closing anyway
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] User has been silent )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1730ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (0ms, frames=0)
prosaas-backend  | 
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 2.1s - now updating session
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=11, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=225.0 > threshold=108.0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=74 49 2f 23 1f, rms=3471, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=2f 2e 32 3a 43, rms=3492, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=b2 b2 b0 b4 c3, rms=4251, consec_frames=5
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=4751, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=35, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=13, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSxzRZhfZvus69...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSxzRZhfZvus69... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=15, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=15, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=fe fd fe ff 7e
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=14, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=c5 b9 bf c6 cd
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=72 fd fa 5d 49
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (len=25)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' â†’ '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª...' despite low RMS=16)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew_chars=29)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew=29, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (from raw: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.35s (129 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....' - processing as answer to greeting question
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¦×¨×™×š' (confidence=47%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 20a3afe7...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=20a3afe7...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952133.022644}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952143.876439}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 1272ms gap between chunks #4 and #5 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.48s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (22ms, frames=0)
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #10
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=349.0 > threshold=108.0
prosaas-backend  | [PIPELINE STATUS] sent=130 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3031, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSy504O0OQ7fbi...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSy504O0OQ7fbi... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×¨×™×™×ª ×¢×ª×”.' (len=10)
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #20
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×¨×™×™×ª ×¢×ª×”....' despite low RMS=9)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×§×¨×™×™×ª ×¢×ª×”.' (hebrew_chars=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×¨×™×™×ª ×¢×ª×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×¨×™×™×ª ×¢×ª×”.' (hebrew=8, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7004ms)
prosaas-backend  | [STT_FINAL] '×§×¨×™×™×ª ×¢×ª×”.' (from raw: '×§×¨×™×™×ª ×¢×ª×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.31s (202 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×¨×™×™×ª ×¢×ª×”.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×§×¨×™×™×ª ×¢×ª×”.' (confidence=83%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×¨×™×™×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×¨×™×™×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×§×¨×™×™×ª ×¢×ª×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: f80cf250...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (20a3afe7 â†’ f80cf250) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=f80cf250...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×¨×™×™×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952143.876439}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952145.1368601}, {'speaker': 'user', 'text': '×§×¨×™×™×ª ×¢×ª×”.', 'ts': 1764952150.8808117}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 5935ms gap between chunks #6 and #7 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.46s (24 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (13ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '××•×•×“×' (confidence=51%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (20ms, frames=0)
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #30
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | INFO:     172.18.0.5:46308 - "GET /api/calls?search=&status=all&direction=all&limit=25&offset=0 HTTP/1.1" 200 OK
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=994.0 > threshold=108.0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | INFO:     172.18.0.5:46314 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | [PIPELINE STATUS] sent=203 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2152, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSyEx5H9MKWjVL...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSyEx5H9MKWjVL... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=20, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=22, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×›×Ÿ.' (len=3)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×›×Ÿ....' despite low RMS=13)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×›×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×›×Ÿ.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8510ms)
prosaas-backend  | [STT_FINAL] '×›×Ÿ.' (from raw: '×›×Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 1.88s (254 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×›×Ÿ.
prosaas-backend  | âœ… [BUILD 176] User CONFIRMED with '×›×Ÿ.' - verification_confirmed = True
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×›×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×›×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×§×¨×™×™×ª ×¢×ª×”.', '×›×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 4b9a20ff...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (f80cf250 â†’ 4b9a20ff) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=4b9a20ff...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×›×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city'] | Collected: ['service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.addedğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×§×¨×™×™×ª ×¢×ª×”.', 'ts': 1764952150.8808117}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?', 'ts': 1764952151.5267277}, {'speaker': 'user', 'text': '×›×Ÿ.', 'ts': 1764952159.3901675}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 7876ms gap between chunks #24 and #25 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=11, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.08s (50 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (7ms, frames=0)
prosaas-backend  | WS_STOP sid=MZ9a7ff47fa5bfdc7b288b47b8463e3879 rx=1522 tx=642
prosaas-backend  | ğŸ“ [SES-5c4f2486] CALL ENDED - duration=30.4s, business_id=10, rx=1522, tx=642
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CA5bd7447b8c3d8f191ecc7726032c5ba0 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:46316 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA5bd7447b8c3d8f191ecc7726032c5ba0: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REa3509a7f8742342b3c4dc6b86c7f5c61.json
prosaas-backend  | INFO:     172.18.0.5:46330 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CA5bd7447b8c3d8f191ecc7726032c5ba0
prosaas-backend  | INFO:     connection closed
prosaas-backend  | INFO:     127.0.0.1:33120 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×'}
prosaas-backend  | âŒ [CITY] Rejected '××œ×™×š' (confidence=84%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP] User confirmed all details - disconnecting
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (reason: user_verified)
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | âœ… CALL FINALIZED: CA5bd7447b8c3d8f191ecc7726032c5ba0
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×©×™×—×ª ×©×™×¨×•×ª ×œ×§×•×—×•×ª ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×¤×¨×™×¦×” - ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - ×¡×•×’ ×”×©×™×¨×•×ª: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘
prosaas-backend  | - ××™×§×•×: ×§×¨×™×™×ª ××ª×
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×œ×§×•×— ×¡×¤×¦×™×¤×™×™× (×©× ×•×××¦×¢×™ ×”×ª×§×©×¨×•×ª).
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - ×¤×¢×•×œ×”: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª.
prosaas-backend  | - ×“×—×™×¤×•×ª: ×’×‘×•×”×” (×”×œ×§×•×— ×–×§×•×§ ×œ×©×™×¨×•×ª ××™×™×“×™).
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×©×”×¤×•×¨×¥ ×”××™×•×¢×“ ×–××™×Ÿ ×‘××–×•×¨ ×§×¨×™×™×ª ××ª× ×•×™×›×•×œ ×œ×¡×¤×§ ×©×™×¨×•×ª ×‘××”×™×¨×•×ª. ××•××œ×¥ ×œ×¢×§×•×‘ ××—×¨×™ ×”×¤× ×™×™×” ×•×œ×•×•×“× ×©×”×œ×§×•×— ×§×™×‘×œ ××ª ×”×©×™×¨×•×ª ×”× ×“×¨×© ×‘×”×¦×œ×—×”.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ9a7ff47fa5bfdc7b288b47b8463e3879 rx=1522 tx=642
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×•×¨×¥ ×œ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×'}
prosaas-backend  |    â””â”€ City from transcript (fuzzy): ×ª×œ ××‘×™×‘ (confidence=90%)
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA5bd7447b8c3d8f191ecc7726032c5ba0, phone=+972504294724, city=×ª×œ ××‘×™×‘, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×ª×œ ××‘×™×‘, service=×¤×•×¨×¥ ×œ×¨×›×‘
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×× ×¢×•×œ×Ÿ ×œ×¨×›×‘
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | ğŸ”‡ [SILENCE] Final chance already given - closing anyway
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] User has been silent )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSyUNDYJdkD12E...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSyUNDYJdkD12E... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 15162ms gap between chunks #50 and #51 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 43 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?...'
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.95s (68 chunks)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×§×¨×™×™×ª ××ª×'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 43 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #10
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1293ms - CAc9b70416c4c172
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CAc9b70416c4c1720a851a4ea39efeefcf" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:43362 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:43374 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-3a6e9014
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952181.755] WS_START sid=MZ29f338b7716c7a099eed3102dc5f8398 call_sid=CAc9b70416c4c1720a851a4ea39efeefcf from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CAc9b704 (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 439ms (T0+441ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1042ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1145ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764952182.901] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1146ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.6, threshold=108.6)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 708ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 0ms (total: 1148ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952182.904
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1148ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSycvqvjHWJDS2...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSycvqvjHWJDS2... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=43, tx_q=285) retry #10
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Call log already exists for CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | âœ… Recording started for CAc9b70416c4c1720a851a4ea39efeefcf: RE34ee4f69ae829f04d4dc93bfe99e49d0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952184.284 (duration: 1381ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #20
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1846ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (0ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 2.1s - now updating session
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=185.0 > threshold=108.6
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=ea ea ed f0 f8, rms=71, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=7e 74 6f 6d 6e, rms=191, consec_frames=3
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=ea e7 e9 ef 7e, rms=264, consec_frames=4
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:39550 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=160, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.9s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=13760 | silence_ms=501
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=43, tx_q=285) retry #20
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=542
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSyjx7Nxk4APb8...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSyjx7Nxk4APb8... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=54, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=52, reason=insufficient_consec_frames(0/3))
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=450.0 > threshold=108.6
prosaas-backend  | [PIPELINE STATUS] sent=110 blocked=0 | active_response=resp_CjSyjx7Nxk... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=30)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×', '×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew_chars=38)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew=38, english=0)
prosaas-backend  | [STT_FINAL] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (from raw: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.20s (119 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....' - processing as answer to greeting question
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #30
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2947, voice_frames=0
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=981, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×—×›×, ×¤×•×¨×¥' (confidence=78%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: b9d1d33b...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=b9d1d33b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...[GOODBYE CHECK] No goodbye phrase: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952184.2854996}, {'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952190.4474149}]
prosaas-backend  | 
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=f1 f2 79 6f 68
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=5c 54 58 4f 4f
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | â›” [BARGE-IN] User started talking while AI speaking - HARD CANCEL!
prosaas-backend  |    active_response_id=resp_CjSyjx7Nxk4APb8...
prosaas-backend  |    is_ai_speaking=True
prosaas-backend  |    âœ… Sent response.cancel to OpenAI
prosaas-backend  | ğŸ§¹ [TX_FLUSH] Flushed 11 frames (was 11, reason=BARGE_IN)
prosaas-backend  |    âœ… [BARGE-IN] Response cancelled, guards cleared, queue flushed
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.01s (2 chunks)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=cancelled, output_count=1, details={'type': 'cancelled', 'reason': 'turn_detected'}
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | INFO:     127.0.0.1:57590 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âŒ [REALTIME] ERROR: {'type': 'invalid_request_error', 'code': 'response_cancel_not_active', 'message': 'Cancellation failed: no active response found', 'param': None, 'event_id': None}
prosaas-backend  | [REALTIME] event: error
prosaas-backend  | âŒ [REALTIME] Error event: Cancellation failed: no active response found
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 285 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=35, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=260 blocked=0 | active_response=None... | ai_speaking=False | barge_in=True
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=43, tx_q=285) retry #30
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | âœ… [BARGE-IN] User utterance completed - barge-in ended (duration=1.5s)
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSynNCX7qt0ZdE...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSynNCX7qt0ZdE... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=82, voice_frames=0
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (len=31)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' â†’ '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew_chars=34)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew=34, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (3616ms)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘...')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.01s (298 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=226.0 > threshold=108.6
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=36, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¦×¨×™×š' (confidence=47%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 5d77ec20...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (b9d1d33b â†’ 5d77ec20) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=5d77ec20...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952190.4474149}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨', 'ts': 1764952192.0577178}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952194.0633657}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=800, first5=db ce cd cb cb
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (8 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×¢×™×¨' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×™×¨ ×’× ×™×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×™×¨ ×’× ×™×'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×™×¨
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×™×¨ ×’× ×™×', 'raw_city': '×¢×™×¨'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×™×¨ ×’× ×™×', 'raw_city': '×¢×™×¨', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×™×¨ ×’× ×™×', 'raw_city': '×¢×™×¨', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×™×¨ ×’× ×™×' from ['×©×œ×•×!', '×—×›×, ×¤×•×¨×¥', '×¢×™×¨', '×¦×¨×™×š', '×¢×™×¨']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=299 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSyq707SDQnMPP...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSyq707SDQnMPP... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×œ×™×‘×¨, ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=37)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×§×œ×™×‘×¨, ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×§×œ×™×‘×¨, ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×', '×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×œ×™×‘×¨, ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›...' despite low RMS=8)
prosaas-backend  | [GIBBERISH] Detected: '×§×œ×™×‘×¨, ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' | Reason: repeated_pattern: '×× ×¢' x3 | Confidence: 70%
prosaas-backend  | [NOISE FILTER] âŒ REJECTED (gibberish): '×§×œ×™×‘×¨, ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 1786ms gap between chunks #8 and #9 - OpenAI delay!
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢, × ×›×•×Ÿ?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (0ms, frames=0)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.84s (26 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×‘×‘××¨ ×©×‘×¢,' differs from locked '×¢×™×¨'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×¢×™×¨' (reason: user_said_×‘×‘××¨ ×©×‘×¢,)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×‘××¨ ×©×‘×¢
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘××¨ ×©×‘×¢', 'raw_city': '×¢×™×¨', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×‘×‘××¨ ×©×‘×¢,
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘××¨ ×©×‘×¢', 'raw_city': '×‘×‘××¨ ×©×‘×¢,', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=89.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘××¨ ×©×‘×¢', 'raw_city': '×‘×‘××¨ ×©×‘×¢,', 'city_confidence': '89.0', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘××¨ ×©×‘×¢', 'raw_city': '×‘×‘××¨ ×©×‘×¢,', 'city_confidence': '89.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×‘××¨ ×©×‘×¢' (confidence=89%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘××¨ ×©×‘×¢', 'raw_city': '×‘×‘××¨ ×©×‘×¢,', 'city_confidence': '89.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 5.2s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=82880 | silence_ms=7419
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=2351.0 > threshold=108.6
prosaas-backend  | [PIPELINE STATUS] sent=368 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=13, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #3
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=1260
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #3
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=26, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSyywbNDjFxr3h...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSyywbNDjFxr3h... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×.' (len=3)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=23, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×....' despite low RMS=23)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (11787ms)
prosaas-backend  | [STT_FINAL] '×œ×.' (from raw: '×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 9.52s (418 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×.' - user is rejecting/correcting
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 7
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 42c641a0...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (5d77ec20 â†’ 42c641a0) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=42c641a0...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×‘××¨ ×©×‘×¢, service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | ğŸ” [NLP] Conversation history has 7 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952195.5987306}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢, × ×›×•×Ÿ?', 'ts': 1764952198.2270007}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1764952205.8504243}]
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 7634ms gap between chunks #26 and #27 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjSyywbNDjFxr3h...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=23, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.07s (32 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (13ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘××¨ ×©×‘×¢', 'raw_city': '×‘×‘××¨ ×©×‘×¢,', 'city_confidence': '89.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=400.0 > threshold=108.6
prosaas-backend  | [PIPELINE STATUS] sent=419 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.1s audio, conversation #4
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=17920 | silence_ms=518
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #4
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSz4usFeHo4SBN...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSz4usFeHo4SBN... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=21, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '××©×§×œ×•×Ÿ.' (len=7)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=32, voice_frames=0
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '××©×§×œ×•×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '××©×§×œ×•×Ÿ.' (hebrew=6, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (6214ms)
prosaas-backend  | [STT_FINAL] '××©×§×œ×•×Ÿ.' (from raw: '××©×§×œ×•×Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.51s (484 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ××©×§×œ×•×Ÿ.
prosaas-backend  | âœ… [LEAD STATE] Updated: city=××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '×‘×‘××¨ ×©×‘×¢,', 'city_confidence': '89.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××©×§×œ×•×Ÿ.
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '89.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.92307692307693
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '××©×§×œ×•×Ÿ' (confidence=91%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 9
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×œ×.', '××©×§×œ×•×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 5f99f6e0...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (42c641a0 â†’ 5f99f6e0) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=5f99f6e0...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××©×§×œ×•×Ÿ....'ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=××©×§×œ×•×Ÿ, service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] Conversation history has 9 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×.', 'ts': 1764952205.8504243}, {'speaker': 'ai', 'text': '××– ×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952205.9198494}, {'speaker': 'user', 'text': '××©×§×œ×•×Ÿ.', 'ts': 1764952212.0638556}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 6216ms gap between chunks #32 and #33 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=29, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ, × ×›×•×Ÿ?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=73% with: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢, × ×›×•×Ÿ?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.81s (50 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (17ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢'}
prosaas-backend  | âŒ [CITY] Rejected '××•×•×“×' (confidence=51%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (16ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=11, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:52008 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=475.0 > threshold=108.6
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=485 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=50, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.8s audio, conversation #5
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=13440 | silence_ms=506
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #5
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzDPsgyU3jaz8...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzDPsgyU3jaz8... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×' (len=2)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=27, voice_frames=0
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×œ×'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8380ms)
prosaas-backend  | [STT_FINAL] '×œ×' (from raw: '×œ×...')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.13s (537 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×' - user is rejecting/correcting
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 11
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×œ×.', '××©×§×œ×•×Ÿ.', '×œ×']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 23b08f6b...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (5f99f6e0 â†’ 23b08f6b) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=23b08f6b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=××©×§×œ×•×Ÿ, service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 11 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '××©×§×œ×•×Ÿ.', 'ts': 1764952212.0638556}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ, × ×›×•×Ÿ?', 'ts': 1764952212.9433072}, {'speaker': 'user', 'text': '×œ×', 'ts': 1764952220.444432}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 7510ms gap between chunks #50 and #51 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjSzDPsgyU3jaz8...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=31, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 1 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××– ×‘××™×–×” ×©×™×¨×•×ª ×‘×“×™×•×§ ××ª×” ×¦×¨×™×š ×¢×–×¨×”?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.31s (59 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (17ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=16, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '×©×™×¨×•×ª' (confidence=61%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××– ×‘××™×–×” ×©×™×¨×•×ª ×‘×“×™×•×§ ××ª×” ×¦×¨×™×š ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (1ms, frames=0)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | INFO:     127.0.0.1:44538 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 900 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=570.0 > threshold=108.6
prosaas-backend  | [PIPELINE STATUS] sent=538 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=45, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.4s audio, conversation #6
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=23040 | silence_ms=513
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #6
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzKIAHMNHgkNM...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzKIAHMNHgkNM... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=23, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¤×¨×™×¦×” ×œ×¨×›×‘?' (len=11)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=54, voice_frames=0
prosaas-backend  | [STT_REPAIRED] '×¤×¨×™×¦×” ×œ×¨×›×‘?' â†’ '×¤×•×¨×¥ ×“×œ×ª×•×ª?'
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×¤×•×¨×¥ ×“×œ×ª×•×ª?'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¤×•×¨×¥ ×“×œ×ª×•×ª?' (hebrew=9, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7325ms)
prosaas-backend  | [STT_FINAL] '×¤×•×¨×¥ ×“×œ×ª×•×ª?' (from raw: '×¤×¨×™×¦×” ×œ×¨×›×‘?...')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.92s (628 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¤×•×¨×¥ ×“×œ×ª×•×ª?
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '×“×œ×ª×•×ª?' (confidence=43%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¤×•×¨×¥ ×“×œ×ª×•×ª?...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¤×•×¨×¥ ×“×œ×ª×•×ª?...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 13
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×œ×.', '××©×§×œ×•×Ÿ.', '×œ×', '×¤×•×¨×¥ ×“×œ×ª×•×ª?']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: dd83b50e...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (23b08f6b â†’ dd83b50e) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=dd83b50e...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¤×•×¨×¥ ×“×œ×ª×•×ª?...'ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=××©×§×œ×•×Ÿ, service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 7257ms gap between chunks #59 and #60 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ” [NLP] Conversation history has 13 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×', 'ts': 1764952220.444432}, {'speaker': 'ai', 'text': '××– ×‘××™×–×” ×©×™×¨×•×ª ×‘×“×™×•×§ ××ª×” ×¦×¨×™×š ×¢×–×¨×”?', 'ts': 1764952220.7562263}, {'speaker': 'user', 'text': '×¤×•×¨×¥ ×“×œ×ª×•×ª?', 'ts': 1764952227.7693393}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [PIPELINE STATUS] sent=629 blocked=0 | active_response=resp_CjSzKIAHMN... | ai_speaking=True | barge_in=False
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=22, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 1 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ, × ×›×•×Ÿ?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=73% with: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘×‘××¨ ×©×‘×¢, × ×›×•×Ÿ?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.32s (77 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1000 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '××•×•×“×' (confidence=51%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (36ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #4 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=144.0 > threshold=108.6
prosaas-backend  | [PIPELINE STATUS] sent=633 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8073, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2522, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=736 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzUoWl3r0JlGZ...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzUoWl3r0JlGZ... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1200 frames (rms=12, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.' (len=17)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ....' despite low RMS=13)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.' (hebrew=14, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (9857ms)
prosaas-backend  | [STT_FINAL] '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.' (from raw: '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 9.61s (757 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 3.0s audio, conversation #7
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=48320 | silence_ms=2062
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #7
prosaas-backend  | âœ… [LEAD STATE] Updated: city=××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '90.92307692307693', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [CITY] Auto-accepted: '××©×§×œ×•×Ÿ' (confidence=100%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 15
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×œ×.', '××©×§×œ×•×Ÿ.', '×œ×', '×¤×•×¨×¥ ×“×œ×ª×•×ª?', '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 6891fb14...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (dd83b50e â†’ 6891fb14) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=6891fb14...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=××©×§×œ×•×Ÿ, service_type=×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 15 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×¤×•×¨×¥ ×“×œ×ª×•×ª?', 'ts': 1764952227.7693393}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ, × ×›×•×Ÿ?', 'ts': 1764952228.328694}, {'speaker': 'user', 'text': '×‘××©×§×œ×•×Ÿ, ×‘××©×§×œ×•×Ÿ.', 'ts': 1764952237.625845}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 9621ms gap between chunks #77 and #78 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=29, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.86s (103 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (11ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=163.0 > threshold=108.6
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1300 frames (rms=10, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '××œ×™×š' (confidence=84%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP BUILD 176] AI said goodbye with auto_end_on_goodbye=True + user interaction - disconnecting
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (reason: ai_goodbye_auto_end)
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 189 frames...
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (1ms, frames=0)
prosaas-backend  | [PIPELINE STATUS] sent=758 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | WS_STOP sid=MZ29f338b7716c7a099eed3102dc5f8398 rx=2995 tx=1464
prosaas-backend  | ğŸ“ [SES-3a6e9014] CALL ENDED - duration=59.8s, business_id=10, rx=2995, tx=1464
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CAc9b70416c4c1720a851a4ea39efeefcf stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:57778 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CAc9b70416c4c1720a851a4ea39efeefcf: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE34ee4f69ae829f04d4dc93bfe99e49d0.json
prosaas-backend  | INFO:     172.18.0.5:57780 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | INFO:     connection closed
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA45473d260e579bbbcfd256b4c4581d77
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA45473d260e579bbbcfd256b4c4581d77
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA45473d260e579bbbcfd256b4c4581d77ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1329ms - CA45473d260e579b
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA45473d260e579bbbcfd256b4c4581d77" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | INFO:     172.18.0.5:33084 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | INFO:     172.18.0.5:33098 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-a4fab27b
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952246.986] WS_START sid=MZ645ed9b49c43b6df125c8533f9dd5170 call_sid=CA45473d260e579bbbcfd256b4c4581d77 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA45473d (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | âœ… CALL FINALIZED: CAc9b70416c4c1720a851a4ea39efeefcf
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×©×™×—×ª ×œ×§×•×— ×¢× ×¢×¡×§ ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×”×× ×¢×•×œ× ×•×ª, ×‘××˜×¨×” ×œ×§×‘×œ ×©×™×¨×•×ª ×©×œ ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘
prosaas-backend  | - **××™×§×•×**: ××©×§×œ×•×Ÿ
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | - **×©× ×”×œ×§×•×—**: ×œ× × ××¡×¨
prosaas-backend  | - **×××¦×¢×™ ×”×ª×§×©×¨×•×ª**: ×œ× × ××¡×¨
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×”**: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×’×‘×•×”×”, ×”×œ×§×•×— ×–×§×•×§ ×œ×©×™×¨×•×ª ××™×™×“×™.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×”×œ×§×•×— ×œ× ×”×™×” ×‘×¨×•×¨ ×‘×ª×—×™×œ×” ×œ×’×‘×™ ×”××™×§×•×, ××š ×œ××—×¨ ××¡×¤×¨ ×©××œ×•×ª, ×”×•×‘×”×¨ ×›×™ ×”×•× ×–×§×•×§ ×œ×©×™×¨×•×ª ×‘××©×§×œ×•×Ÿ. ×™×© ×œ×•×•×“× ×©×”×× ×¢×•×œ×Ÿ ×”××•××œ×¥ × ××¦× ×‘××–×•×¨ ×•×™×›×•×œ ×œ×¡×¤×§ ××ª ×”×©×™×¨×•×ª ×‘×”×§×“× ×”××¤×©×¨×™.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 496ms (T0+497ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ29f338b7716c7a099eed3102dc5f8398 rx=2995 tx=1464
prosaas-backend  | INFO:     172.18.0.5:33092 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1044ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1147ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA45473d260e579bbbcfd256b4c4581d77
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764952248.135] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | 
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1149ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=11.8, threshold=111.8)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 654ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 0ms (total: 1151ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952248.138
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1151ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×¨×™×¦×” ×œ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CAc9b70416c4c1720a851a4ea39efeefcf, phone=+972504294724, city=××©×§×œ×•×Ÿ, direction=inbound
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=××©×§×œ×•×Ÿ, service=×¤×¨×™×¦×” ×œ×¨×›×‘
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzgh3auKc547i...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzgh3auKc547i... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Call log already exists for CA45473d260e579bbbcfd256b4c4581d77
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Recording started for CA45473d260e579bbbcfd256b4c4581d77: REef1b0b501284ac52f2a8416c22cf00da
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952249.528 (duration: 1390ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1618ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.8s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | INFO:     127.0.0.1:60782 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=142.0 > threshold=111.8
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=76 5e 58 5d 74, rms=561, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=74 6e 6e 6b 68, rms=342, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=f4 f6 f8 fa fc, rms=164, consec_frames=5
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzlcI7ykxeHu6...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzlcI7ykxeHu6... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=576
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=18, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzmrZf32Aarxm...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzmrZf32Aarxm... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 15563ms gap between chunks #103 and #104 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=7e 7d 7d 7c 7d
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=6a 63 66 60 5a
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=5933, frames=1/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=48 44 32 2f 47
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=30)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×', '×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew_chars=38)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew=38, english=0)
prosaas-backend  | [STT_FINAL] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (from raw: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 1.43s (45 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....' - processing as answer to greeting question
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=9723, frames=1/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=562, frames=1/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=4646, frames=1/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=827, frames=1/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 42 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.95s (120 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=3539, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=5464, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=240, frames=0/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=192, frames=0/5)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×—×›×, ×¤×•×¨×¥' (confidence=78%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: b9d1d33b...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=b9d1d33b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952249.5285056}, {'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952254.7819018}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 2811ms gap between chunks #3 and #4 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 2.86s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (36ms, frames=0)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=422.0 > threshold=111.8
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (11ms, frames=0)
prosaas-backend  | [PIPELINE STATUS] sent=46 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'city_needs_confirmation': 'True', 'service_type': '×¤×¨×™×¦×” ×œ×¨×›×‘ ×‘××©×§×œ×•×Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 42 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.6s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=9600 | silence_ms=677
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjSzra2rKe2msVR...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjSzra2rKe2msVR... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 2736ms gap between chunks #6 and #7 - OpenAI delay!
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (len=30)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª.' â†’ '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×', '×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª', '×“×œ×ª×•×ª': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥...' despite low RMS=8)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew_chars=38)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (hebrew=38, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (5632ms)
prosaas-backend  | [STT_FINAL] '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.' (from raw: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 1.47s (91 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=5359, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=7830, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=2609, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=913, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=11514, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=380, frames=1/5)
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=42, tx_q=170) retry #10
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×—×›×, ×¤×•×¨×¥' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×—×›×, ×¤×•×¨×¥
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×—×›×, ×¤×•×¨×¥
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×—×›×, ×¤×•×¨×¥' from ['×©×œ×•×!', '×—×›×, ×¤×•×¨×¥', '×¢×™×¨', '×—×›×, ×¤×•×¨×¥']
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 49814e72...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (b9d1d33b â†’ 49814e72) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=49814e72...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952254.7819018}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952257.5265396}, {'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952260.4139671}]
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×—×›×, ×¤×•×¨×¥']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 1717ms gap between chunks #9 and #10 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ ×‘× ×ª× ×™×”, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.78s (25 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (16ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=14, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×©×™×¨×•×ª' differs from locked '×—×›×, ×¤×•×¨×¥'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×—×›×, ×¤×•×¨×¥' (reason: user_said_×©×™×¨×•×ª)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×™×¨×•×ª' (confidence=61%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=92 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=42, tx_q=170) retry #20
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | [PIPELINE STATUS] sent=96 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=32, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=26, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1267.0 > threshold=111.8
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=27, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.9s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=15040 | silence_ms=521
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT01fwEL2jfRWg...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT01fwEL2jfRWg... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×¢×•×œ×Ÿ,' (len=7)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=23, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×× ×¢×•×œ×Ÿ,'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×¢×•×œ×Ÿ,' (hebrew=6, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (10068ms)
prosaas-backend  | [STT_FINAL] '×× ×¢×•×œ×Ÿ,' (from raw: '×× ×¢×•×œ×Ÿ,...')
prosaas-backend  | ğŸ’° [COST] User utterance: 6.49s (144 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×¢×•×œ×Ÿ,
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âŒ [CITY] Rejected '×× ×¢×•×œ×Ÿ,' (confidence=56%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×¢×•×œ×Ÿ,...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×¢×•×œ×Ÿ,...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ,']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 2abaa2b8...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (49814e72 â†’ 2abaa2b8) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=2abaa2b8...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×¢×•×œ×Ÿ,...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×—×›×, ×¤×•×¨×¥, service_type=×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 8567ms gap between chunks #25 and #26 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', 'ts': 1764952260.4139671}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ ×‘× ×ª× ×™×”, × ×›×•×Ÿ?', 'ts': 1764952262.0367012}, {'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ,', 'ts': 1764952270.4816573}]
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjT01fwEL2jfRWg...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=29, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××•×§×™×™, ××– ×‘××™×–×” ×ª×—×•× ×‘×“×™×•×§ ××ª×” ×¦×¨×™×š ×¢×–×¨×”?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.15s (37 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (17ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=210.0 > threshold=111.8
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=36, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=26, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=42, tx_q=170) retry #30
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âŒ [CITY] Rejected '××•×§×™×™,' (confidence=81%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××•×§×™×™, ××– ×‘××™×–×” ×ª×—×•× ×‘×“×™×•×§ ××ª×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=145 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (20ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 170 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=3396.0 > threshold=111.8
prosaas-backend  | [PIPELINE STATUS] sent=148 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12181, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=18, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.6s audio, conversation #3
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=25920 | silence_ms=506
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #3
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT09sSjZhPLv9f...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT09sSjZhPLv9f... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:37850 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¤×•×¨×¥ ×œ×¨×›×‘.' (len=10)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×¤×•×¨×¥ ×œ×¨×›×‘.' â†’ '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....' despite low RMS=16)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew=13, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7138ms)
prosaas-backend  | [STT_FINAL] '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (from raw: '×¤×•×¨×¥ ×œ×¨×›×‘....')
prosaas-backend  | ğŸ’° [COST] User utterance: 5.45s (228 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=21, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âŒ [CITY] Rejected '×“×œ×ª×•×ª' (confidence=46%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 8
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ,', '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 82104f10...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (2abaa2b8 â†’ 82104f10) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=82104f10...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 8 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×¢×•×œ×Ÿ,', 'ts': 1764952270.4816573}, {'speaker': 'ai', 'text': '××•×§×™×™, ××– ×‘××™×–×” ×ª×—×•× ×‘×“×™×•×§ ××ª×” ×¦×¨×™×š ×¢×–×¨×”?', 'ts': 1764952270.7571614}, {'speaker': 'user', 'text': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952277.619464}]
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×—×›×, ×¤×•×¨×¥, service_type=×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 7319ms gap between chunks #37 and #38 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=13, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 1 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.08s (43 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (36ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×—×›×, ×¤×•×¨×¥', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=25, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=186.0 > threshold=111.8
prosaas-backend  | [PIPELINE STATUS] sent=229 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=798, voice_frames=0
prosaas-backend  | INFO:     127.0.0.1:47980 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.3s audio, conversation #4
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=20480 | silence_ms=502
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #4
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT0FH6COmsdAWo...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT0FH6COmsdAWo... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=29, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=35, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 5569ms gap between chunks #43 and #44 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=26, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×¨×™×ª ×’×ª.' (len=8)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×¨×™×ª ×’×ª....' despite low RMS=25)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×¨×™×ª ×’×ª.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×¨×™×ª ×’×ª.' (hebrew=6, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7450ms)
prosaas-backend  | [STT_FINAL] '×§×¨×™×ª ×’×ª.' (from raw: '×§×¨×™×ª ×’×ª....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.40s (299 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×¨×™×ª ×’×ª.
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ×’×ª
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×—×›×, ×¤×•×¨×¥', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×ª ×’×ª.
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=91.33333333333334
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×§×¨×™×™×ª ×’×ª' (confidence=91%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×¨×™×ª ×’×ª....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×¨×™×ª ×’×ª....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 10
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª ×¤×•×¨×¥ ×“×œ×ª×•×ª.', '×× ×¢×•×œ×Ÿ,', '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×§×¨×™×ª ×’×ª.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 7428c5a7...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (82104f10 â†’ 7428c5a7) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=7428c5a7...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×¨×™×ª ×’×ª....'ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 10 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952277.619464}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952278.1519122}, {'speaker': 'user', 'text': '×§×¨×™×ª ×’×ª.', 'ts': 1764952285.0699513}]
prosaas-backend  | 
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ×’×ª, service_type=×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 1322ms gap between chunks #48 and #49 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 3 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘ ×‘×§×¨×™×™×ª ×’×ª, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.54s (63 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (34ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×”×—×œ×¤×ª ×× ×¢×•×œ', 'city_needs_confirmation': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¨×›×‘' (confidence=77%) - ask to repeat
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“××ª â€“ ××ª×” ×¦×¨×™×š ×©×™×¨×•×ª ×©×œ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (10ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 900 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1000 frames (rms=24, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=23, voice_frames=0
prosaas-backend  | WS_STOP sid=MZ645ed9b49c43b6df125c8533f9dd5170 rx=2200 tx=1122
prosaas-backend  | ğŸ“ [SES-a4fab27b] CALL ENDED - duration=44.0s, business_id=10, rx=2200, tx=1122
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA45473d260e579bbbcfd256b4c4581d77 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:56516 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA45473d260e579bbbcfd256b4c4581d77: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/REef1b0b501284ac52f2a8416c22cf00da.json
prosaas-backend  | INFO:     172.18.0.5:56520 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | âœ… Recording queued for processing: CA45473d260e579bbbcfd256b4c4581d77
prosaas-backend  | INFO:     connection closed
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA5e8cf9edf06b6d9eef7c6ef92da37f30
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA5e8cf9edf06b6d9eef7c6ef92da37f30
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA5e8cf9edf06b6d9eef7c6ef92da37f30ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1276ms - CA5e8cf9edf06b6d
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA5e8cf9edf06b6d9eef7c6ef92da37f30" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | INFO:     172.18.0.5:40032 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:40036 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-b22f423d
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952294.279] WS_START sid=MZ37b0e2cd6ac2652c0609087c0c35a87b call_sid=CA5e8cf9edf06b6d9eef7c6ef92da37f30 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA5e8cf9 (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 448ms (T0+449ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1041ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1143ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA5e8cf9edf06b6d9eef7c6ef92da37f30
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764952295.424] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1145ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.1, threshold=108.1)
prosaas-backend  | 
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 698ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | âœ… Call log already exists for CA5e8cf9edf06b6d9eef7c6ef92da37f30
prosaas-backend  | âœ… Recording started for CA5e8cf9edf06b6d9eef7c6ef92da37f30: RE658d90b6e687f0bf43fb737500b665d2
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1061ms (total: 2207ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952296.488
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 2207ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT0S2lkzTt8EAp...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT0S2lkzTt8EAp... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… CALL FINALIZED: CA45473d260e579bbbcfd256b4c4581d77
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×©×™×—×” ×–×• ××ª×™×™×—×¡×ª ×œ×©×™×¨×•×ª×™ ×× ×¢×•×œ× ×•×ª, ×‘××™×•×—×“ ×‘×ª×—×•× ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×•×¨×›×‘×™×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª×™× × ×“×¨×©×™×**: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘, ×”×—×œ×¤×ª ×× ×¢×•×œ ×—×›×.
prosaas-backend  | - **××™×§×•×**: ×§×¨×™×™×ª ×’×ª (×œ×¤×¨×™×¦×ª ×¨×›×‘) ×•× ×ª× ×™×” (×œ×”×—×œ×¤×ª ×× ×¢×•×œ).
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ×¦×¢×¨×™, ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×”×œ×§×•×— ×›××• ×©× ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×™×© ×œ×§×‘×•×¢ ××•×¢×“ ×œ×¤×’×™×©×” ×¢× ×”×œ×§×•×— ×œ×¦×•×¨×š ××ª×Ÿ ×”×©×™×¨×•×ª×™× ×”× ×“×¨×©×™×.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×œ× ×¦×•×™× ×” ×“×—×™×¤×•×ª, ××š ×™×© ×œ×”× ×™×— ×©×”×©×™×¨×•×ª×™× × ×“×¨×©×™× ×‘×”×§×“×.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×—×©×•×‘ ×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××ª ×”×©×™×¨×•×ª ×”××ª××™× ×œ×¤×™ ×”××™×§×•× ×•×”×¦×¨×›×™× ×©×œ×•. ×™×© ×œ×¢×§×•×‘ ××—×¨×™ ×”×œ×§×•×— ×›×“×™ ×œ×•×•×“× ×©×”×©×™×¨×•×ª×™× × ×™×ª× ×™× ×‘×–××Ÿ ×•×‘××™×›×•×ª ×’×‘×•×”×”.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ645ed9b49c43b6df125c8533f9dd5170 rx=2200 tx=1122
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952297.991 (duration: 1503ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (18ms, frames=1)
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ×’×ª', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA45473d260e579bbbcfd256b4c4581d77, phone=+972504294724, city=×§×¨×™×™×ª ×’×ª, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×§×¨×™×™×ª ×’×ª, service=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | 
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=360.0 > threshold=108.1
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=7e fc fc 7c 70, rms=207, consec_frames=3
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1857ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 2.0s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (12ms, frames=0)
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ×’×ª, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=572.0 > threshold=108.1
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=6b 6d 7e 7c e3, rms=1379, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=2 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=3d bc ad b4 c2, rms=3045, consec_frames=4
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT0Ztccglur2Ai...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT0Ztccglur2Ai... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=4104, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18769ms gap between chunks #63 and #64 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=3278, voice_frames=0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 44 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“ ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.19s (82 chunks)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=11, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT0ba3z6igqbjx...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT0ba3z6igqbjx... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=10, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘.' (len=19)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘.' â†’ '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....' despite low RMS=9)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew_chars=20)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew=20, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (from raw: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘....')
prosaas-backend  | ğŸ’° [COST] User utterance: 6.50s (124 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....' - processing as answer to greeting question
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 2.7s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=42560 | silence_ms=2491
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=207.0 > threshold=108.1
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×§×¨×™×ª ×’×ª.', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '91.33333333333334', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×¢×“×™' (confidence=90%)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)INFO:     172.18.0.5:58220 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=162, voice_frames=0
prosaas-backend  | 
prosaas-backend  | â³ [AUDIO] 44 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¦×¨×™×š' (confidence=47%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: a314c03b...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=a314c03b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×-××ª×¨ ×”-×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952297.9908204}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952306.3459935}]
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | [PIPELINE STATUS] sent=125 blocked=0 | active_response=resp_CjT0ba3z6i... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=e9 df e1 e1 e4
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=d2 c8 c9 c6 c3
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=cd be df ee 56
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6400 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 2 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (9 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (31ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=146.0 > threshold=108.1
prosaas-backend  | [PIPELINE STATUS] sent=130 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=16, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=23, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.7s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=27520 | silence_ms=514
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | INFO:     127.0.0.1:53996 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT0iJWkIhT8h7t...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT0iJWkIhT8h7t... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '××©×§×œ×•×Ÿ.' (len=7)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=17, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=19, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=238.0 > threshold=108.1
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=217 blocked=0 | active_response=resp_CjT0iJWkIh... | ai_speaking=False | barge_in=False
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '××©×§×œ×•×Ÿ....' despite low RMS=18)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '××©×§×œ×•×Ÿ.' (hebrew_chars=6)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '××©×§×œ×•×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '××©×§×œ×•×Ÿ.' (hebrew=6, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8358ms)
prosaas-backend  | [STT_FINAL] '××©×§×œ×•×Ÿ.' (from raw: '××©×§×œ×•×Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 6.87s (217 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ××©×§×œ×•×Ÿ.
prosaas-backend  | âœ… [LEAD STATE] Updated: city=××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××©×§×œ×•×Ÿ.
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.92307692307693
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '××©×§×œ×•×Ÿ' (confidence=91%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '××©×§×œ×•×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: a3f275b7...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (a314c03b â†’ a3f275b7) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=a3f275b7...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××©×§×œ×•×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=××©×§×œ×•×Ÿ']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952306.3459935}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952307.8328326}, {'speaker': 'user', 'text': '××©×§×œ×•×Ÿ.', 'ts': 1764952314.6984026}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 6930ms gap between chunks #9 and #10 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=12, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.32s (26 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (23ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '××©×§×œ×•×Ÿ.' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ.', 'city_confidence': '90.92307692307693', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '90.92307692307693', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '××©×§×œ×•×Ÿ' from ['×©×œ×•×!', '×¦×¨×™×š', '×¢×™×¨', '××©×§×œ×•×Ÿ.', '××©×§×œ×•×Ÿ']
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=239.0 > threshold=108.1
prosaas-backend  | [PIPELINE STATUS] sent=218 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=23, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.0s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=16320 | silence_ms=507
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | WS_STOP sid=MZ37b0e2cd6ac2652c0609087c0c35a87b rx=1370 tx=580
prosaas-backend  | ğŸ“ [SES-b22f423d] CALL ENDED - duration=27.4s, business_id=10, rx=1370, tx=580
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | STREAM_ENDED call=CA5e8cf9edf06b6d9eef7c6ef92da37f30 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:35188 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Found existing recording for CA5e8cf9edf06b6d9eef7c6ef92da37f30: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE658d90b6e687f0bf43fb737500b665d2.json
prosaas-backend  | INFO:     172.18.0.5:35192 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CA5e8cf9edf06b6d9eef7c6ef92da37f30
prosaas-backend  | INFO:     connection closed
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [WA-SESSION] ğŸ“± Check #2: Found 0 stale sessions to process
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT0tEsTZaKf1Xt...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT0tEsTZaKf1Xt... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 19266ms gap between chunks #82 and #83 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 88 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“ ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“ ×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×...'
prosaas-backend  | âš ï¸ [LOOP GUARD] Triggered by semantic_repetition!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Cleared TX queue
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Sent clear to Twilio
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.09s (101 chunks)
prosaas-backend  | âœ… CALL FINALIZED: CA5e8cf9edf06b6d9eef7c6ef92da37f30
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×œ×¨×›×‘. ×”×œ×§×•×— ××—×¤×© ×¤×•×¨×¥ ×“×œ×ª×•×ª ×‘×¢×™×¨ ××©×§×œ×•×Ÿ.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘
prosaas-backend  | - **××™×§×•×**: ××©×§×œ×•×Ÿ
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×©× ×”×œ×§×•×— ×œ× × ××¡×¨, ××š ×”×•× ×–×™×”×” ××ª ×¢×¦××• ×›××™ ×©×–×§×•×§ ×œ×©×™×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×” × ×“×¨×©×ª**: ×œ×§×‘×•×¢ ××•×¢×“ ×œ×¤×’×™×©×” ×¢× ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×’×‘×•×”×”, ×”×œ×§×•×— ×–×§×•×§ ×œ×©×™×¨×•×ª ×‘×”×§×“×.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×™×© ×œ×•×•×“× ×–××™× ×•×ª ×©×œ ×¤×•×¨×¦×™× ×‘××–×•×¨ ××©×§×œ×•×Ÿ ×•×œ×¡×¤×§ ×œ×œ×§×•×— ××¡×¤×¨ ××¤×©×¨×•×™×•×ª ×¢× ×–×× ×™ ×”×’×¢×” ×©×•× ×™×. ××•××œ×¥ ×œ×”×“×’×™×© ××ª ××§×¦×•×¢×™×•×ª ×”×©×™×¨×•×ª ×•×”×××™× ×•×ª ×©×œ ×× ×©×™ ×”××§×¦×•×¢ ×”××•×¦×¢×™×.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×¢×“×™×™×Ÿ' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘', 'city_needs_confirmation': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['×©×œ×•×!', '×—×›×, ×¤×•×¨×¥', '×¢×™×¨', '×—×›×, ×¤×•×¨×¥', '×©×™×¨×•×ª', '×× ×¢×•×œ×Ÿ,', '××•×§×™×™,', '×“×œ×ª×•×ª', '×¢×™×¨', '×§×¨×™×ª ×’×ª.', '×¨×›×‘', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“× â€“...'
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢×¦××š. ×××•×¨: '×œ× ×©××¢×ª×™ ×˜×•×‘, ××¤×©×¨ ×œ×—×–×•×¨?' ×•×ª××ª×™×Ÿ ×‘×©×§×˜.
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SERVER_EVENT:[SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZ37b0e2cd6ac2652c0609087c0c35a87b rx=1370 tx=580
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×•×¨×¥ ×œ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '××©×§×œ×•×Ÿ', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA5e8cf9edf06b6d9eef7c6ef92da37f30, phone=+972504294724, city=××©×§×œ×•×Ÿ, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=××©×§×œ×•×Ÿ, service=×¤×•×¨×¥ ×œ×¨×›×‘
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=××©×§×œ×•×Ÿ, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT12oIOgbcBAb8...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT12oIOgbcBAb8... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18242ms gap between chunks #26 and #27 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 48 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.20s (49 chunks)
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×¢×“×™×™×Ÿ' differs from locked '××©×§×œ×•×Ÿ.'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '××©×§×œ×•×Ÿ.' (reason: user_said_×¢×“×™×™×Ÿ)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '××©×§×œ×•×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=90.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×¢×“×™' (confidence=90%)
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 48 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:34670 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:35656 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT1LZ4F6p45oLj...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT1LZ4F6p45oLj... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18121ms gap between chunks #49 and #50 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 93 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.04s (69 chunks)
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×¢×“×™×™×Ÿ' (majority 2/2)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '90.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['×©×œ×•×!', '×¦×¨×™×š', '×¢×™×¨', '××©×§×œ×•×Ÿ.', '××©×§×œ×•×Ÿ', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 93 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT1fmq9pJHaxXn...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT1fmq9pJHaxXn... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 18160ms gap between chunks #69 and #70 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | INFO:     172.18.0.5:59118 - "GET /api/notifications HTTP/1.1" 401 Unauthorized
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | INFO:     127.0.0.1:50044 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 136 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”×¤×¨×˜×™× ×©××¡×¨×ª × ×›×•× ×™×?...'
prosaas-backend  | âš ï¸ [LOOP GUARD] Triggered by semantic_repetition!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] BLOCKING further responses until user speaks!
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Cleared TX queue
prosaas-backend  | ğŸ›‘ [LOOP GUARD] Sent clear to Twilio
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.98s (87 chunks)
prosaas-backend  | INFO:     172.18.0.5:43190 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:43194 - "GET /api/auth/me HTTP/1.1" 401 Unauthorized
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×¢×“×™
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×¢×“×™×™×Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×¢×“×™', 'raw_city': '×¢×“×™×™×Ÿ', 'city_confidence': '100.0', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'service_type': '×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×¢×“×™' from ['×©×œ×•×!', '×¦×¨×™×š', '×¢×™×¨', '××©×§×œ×•×Ÿ.', '××©×§×œ×•×Ÿ', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ', '×¢×“×™×™×Ÿ']
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××ª×” ×¢×“×™×™×Ÿ ×©×? ×¨×§ ×¨×¦×™×ª×™ ×œ×•×•×“×â€”×”...'
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢×¦××š. ×××•×¨: '×œ× ×©××¢×ª×™ ×˜×•×‘, ××¤×©×¨ ×œ×—×–×•×¨?' ×•×ª××ª×™×Ÿ ×‘×©×§×˜.
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SERVER_EVENT:[SERVER] ×–×™×”×™×ª×™ ×©××ª×” ×—×•×–×¨ ×¢×œ ×¢)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” LOGIN ATTEMPT: email=calliber@gmail.com
prosaas-backend  | âœ“ Found user: id=10, email=calliber@gmail.com, role=owner
prosaas-backend  | âœ“ Password hash: scrypt:32768:8:1$NwJjYhcFJjcNjejm$9cc6e19d7dbac0ba...
prosaas-backend  | âœ“ Password verification result: True
prosaas-backend  | ğŸ” LOGIN SUCCESS: user_id=10, email=calliber@gmail.com, role=owner, business_id=10
prosaas-backend  | INFO:     172.18.0.5:43200 - "POST /api/auth/login HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:43210 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:43218 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:43222 - "GET /api/dashboard/activity?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:43236 - "GET /api/dashboard/stats?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:43238 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | INFO:     172.18.0.5:39328 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:39330 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 1/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:53328 - "GET /api/calls?search=&status=all&direction=all&limit=25&offset=0 HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:53336 - "GET /api/calls/CA5e8cf9edf06b6d9eef7c6ef92da37f30/details HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:53348 - "GET /api/calls/CA5e8cf9edf06b6d9eef7c6ef92da37f30/details HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:53352 - "GET /api/dashboard/activity?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     127.0.0.1:49278 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:53360 - "GET /api/dashboard/stats?time_filter=today HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:53376 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | INFO:     172.18.0.5:38212 - "GET /api/auth/csrf HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | INFO:     172.18.0.5:38228 - "GET /api/admin/businesses?pageSize=1 HTTP/1.1" 403 Forbidden
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×©×™×¨×•×ª ×©×œ ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | ğŸ”‡ [SILENCE] Final chance already given - closing anyway
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] User has been silent )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #10
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #20
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #30
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | INFO:     127.0.0.1:46700 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ”‡ [SILENCE] Warning 2/2 after 16.0s silence
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×¢×“×™, service_type=×¤×•×¨×¥ ×œ×¨×›×‘ ×‘×¢×™×¨ ××©×§×œ×•×Ÿ
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded BUT lead not confirmed - sending final confirmation request
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×œ×§×•×— ×©×•×ª×§ ×•×˜×¨× ××™×©×¨ )
prosaas-backend  | ğŸ”‡ [SILENCE] Final chance already given - closing anyway
prosaas-backend  | ğŸ”‡ [SILENCE] Max warnings exceeded - initiating polite hangup
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] User has been silent )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ›‘ [RESPONSE GUARD] Loop guard engaged - blocking (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | INFO:     127.0.0.1:45240 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #10
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #20
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=0, tx_q=1) retry #30
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | INFO:     127.0.0.1:56728 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:58170 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:38170 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | âœ… call_log created immediately for CA9dda860f41e52ae90addbe203f3964f1
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA9dda860f41e52ae90addbe203f3964f1
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA9dda860f41e52ae90addbe203f3964f1ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | 
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | âš ï¸ incoming_call: 3818ms - CA9dda860f41e52a
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA9dda860f41e52ae90addbe203f3964f1" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:47606 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | INFO:     172.18.0.5:47618 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-e4455561
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952567.158] WS_START sid=MZfa1315cf34432547c5f5f5fd2f23ec89 call_sid=CA9dda860f41e52ae90addbe203f3964f1 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA9dda86 (FRESH SESSION)
prosaas-backend  | âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 445ms (T0+447ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1096ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1204ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA9dda860f41e52ae90addbe203f3964f1
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread startedğŸ¯ [T1=1764952568.363] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | 
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1206ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=22.1, threshold=122.1)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 762ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 0ms (total: 1207ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952568.367
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 1208ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT4q2Lf0dO3mKM...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT4q2Lf0dO3mKM... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | âœ… Recording started for CA9dda860f41e52ae90addbe203f3964f1: RE811312d0d3cd825e352af01156166541
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952569.768 (duration: 1402ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (47ms, frames=0)
prosaas-backend  | âœ… Call log already exists for CA9dda860f41e52ae90addbe203f3964f1
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1623ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 1.8s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=526.0 > threshold=122.1
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=6b 68 67 68 6d, rms=82, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=1420, voice_frames=0
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=50 4f 52 5b 78, rms=3355, consec_frames=3
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=a9 ae b4 ba c2, rms=3496, consec_frames=4
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1250, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=2852.0 > threshold=122.1
prosaas-backend  | [PIPELINE STATUS] sent=64 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=1616, voice_frames=0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT4zGfk5dagqYm...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT4zGfk5dagqYm... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=dd d5 d8 d9 db
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=ce c2 c6 c5 c9
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=9, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=55 40 41 37 32
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' (len=31)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.' â†’ '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (corrections: {'×× ×¢×•×œ': '×× ×¢×•×œ×Ÿ', '×—×›×': '×× ×¢×•×œ ×—×›×'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ...' despite low RMS=10)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (hebrew_chars=31)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (hebrew=31, english=0)
prosaas-backend  | [STT_FINAL] '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.' (from raw: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×...')
prosaas-backend  | ğŸ’° [COST] User utterance: 5.56s (164 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....' - processing as answer to greeting question
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×× ×¢×•×œ×Ÿ' (confidence=59%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 762c8f0d...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=762c8f0d...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...[GOODBYE CHECK] No goodbye phrase: '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952569.7684367}, {'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', 'ts': 1764952578.1679766}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 1347ms gap between chunks #4 and #5 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 2 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.50s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (31ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=168.0 > threshold=122.1
prosaas-backend  | [PIPELINE STATUS] sent=165 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=956, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | INFO:     127.0.0.1:57970 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT552L1HEPoqya...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT552L1HEPoqya... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 4816ms gap between chunks #6 and #7 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×’×¨×™×¢×ª ×¢×ª×”.' (len=10)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×’×¨×™×¢×ª ×¢×ª×”....' despite low RMS=8)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×’×¨×™×¢×ª ×¢×ª×”.' (hebrew_chars=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×’×¨×™×¢×ª ×¢×ª×”.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×’×¨×™×¢×ª ×¢×ª×”.' (hebrew=8, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8456ms)
prosaas-backend  | [STT_FINAL] '×’×¨×™×¢×ª ×¢×ª×”.' (from raw: '×’×¨×™×¢×ª ×¢×ª×”....')
prosaas-backend  | ğŸ’° [COST] User utterance: 4.49s (244 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×’×¨×™×¢×ª ×¢×ª×”.
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×’×¨×™×¢×ª' (confidence=51%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×’×¨×™×¢×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×’×¨×™×¢×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×’×¨×™×¢×ª ×¢×ª×”.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 17017be2...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (762c8f0d â†’ 17017be2) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=17017be2...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×’×¨×™×¢×ª ×¢×ª×”....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 2351ms gap between chunks #9 and #10 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', 'ts': 1764952578.1679766}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952579.5120885}, {'speaker': 'user', 'text': '×’×¨×™×¢×ª ×¢×ª×”.', 'ts': 1764952586.6244738}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 6 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 2.49s (26 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (28ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×˜×™×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×˜×™×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×”', 'raw_city': '×˜×™×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×”', 'raw_city': '×˜×™×¨×”', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [CITY] Auto-accepted: '×˜×™×¨×”' (confidence=100%)
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×”', 'raw_city': '×˜×™×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (14ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=194.0 > threshold=122.1
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=245 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5F4uLnR43Q0e...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5F4uLnR43Q0e... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×œ×.' (len=3)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×œ×....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×œ×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×œ×.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (8206ms)
prosaas-backend  | [STT_FINAL] '×œ×.' (from raw: '×œ×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.12s (302 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×œ×.
prosaas-backend  | âš ï¸ [BUILD 303] NEGATIVE ANSWER detected: '×œ×.' - user is rejecting/correcting
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×œ×.' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | ğŸ”„ [BUILD 168] User wants CORRECTION - resetting verification state
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×’×¨×™×¢×ª ×¢×ª×”.', '×œ×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 84a2ea07...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (17017be2 â†’ 84a2ea07) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=84a2ea07...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×œ×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×˜×™×¨×”, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”
prosaas-backend  | â³ [BUILD 172] Lead fields collected - waiting for customer confirmation
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×’×¨×™×¢×ª ×¢×ª×”.', 'ts': 1764952586.6244738}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”, × ×›×•×Ÿ?', 'ts': 1764952586.8165977}, {'speaker': 'user', 'text': '×œ×.', 'ts': 1764952594.8303275}]
prosaas-backend  | âš ï¸ [AUDIO GAP] 8015ms gap between chunks #26 and #27 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×— ×¢×“×™×™×Ÿ ×œ× ××™×©×¨! ×—×–×•×¨ ×¢×œ ×”×¤×¨×˜×™× ×•×©××œ '×”×× ×”×¤×¨×˜×™× × ×›×•× ×™×?' - ×”××ª×Ÿ ×œ××™×©×•×¨
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjT5F4uLnR43Q0e...) - skipping (SERVER_EVENT:[SYSTEM] ×¤×¨×˜×™× × ××¡×¤×• ××‘×œ ×”×œ×§×•×—)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××•×§×™×™, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×‘×××ª × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (36 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (21ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×˜×™×¨×”', 'raw_city': '×˜×™×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”'}
prosaas-backend  | âŒ [CITY] Rejected '××•×§×™×™,' (confidence=81%) - ask to repeatğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | 
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '××•×§×™×™, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×‘×××ª × ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (6ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=1074.0 > threshold=122.1
prosaas-backend  | [PIPELINE STATUS] sent=303 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=12474, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5NjRgclvSJ9D...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5NjRgclvSJ9D... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×§×¨×™×™×ª ××ª×.' (len=10)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=8, reason=noise)
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×§×¨×™×™×ª ××ª×....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×§×¨×™×™×ª ××ª×.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×§×¨×™×™×ª ××ª×.' (hebrew=8, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7737ms)
prosaas-backend  | [STT_FINAL] '×§×¨×™×™×ª ××ª×.' (from raw: '×§×¨×™×™×ª ××ª×....')
prosaas-backend  | ğŸ’° [COST] User utterance: 3.39s (409 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×§×¨×™×™×ª ××ª×.
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×˜×™×¨×”', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ××ª×.
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=91.89473684210526
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_confirmation=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”', 'city_needs_confirmation': 'True'}
prosaas-backend  | âš ï¸ [CITY] Needs confirmation: '×§×¨×™×™×ª ××ª×' (confidence=92%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×§×¨×™×™×ª ××ª×....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×§×¨×™×™×ª ××ª×....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 8
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×’×¨×™×¢×ª ×¢×ª×”.', '×œ×.', '×§×¨×™×™×ª ××ª×.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 39994f9b...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (84a2ea07 â†’ 39994f9b) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=39994f9b...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×§×¨×™×™×ª ××ª×....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××ª×, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.deltağŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 8 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×œ×.', 'ts': 1764952594.8303275}, {'speaker': 'ai', 'text': '××•×§×™×™, ××– ×‘××™×–×• ×¢×™×¨ ××ª×” ×‘×××ª × ××¦×?', 'ts': 1764952594.8353524}, {'speaker': 'user', 'text': '×§×¨×™×™×ª ××ª×.', 'ts': 1764952602.5666192}]
prosaas-backend  | 
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 7920ms gap between chunks #36 and #37 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=73% with: '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”, × ×›×•×Ÿ?...'
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.24s (57 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (37ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×§×¨×™×™×ª ××ª×.' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×.', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×§×¨×™×™×ª ××ª×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '91.89473684210526', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”', 'city_needs_confirmation': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×˜×™×¨×”', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×§×¨×™×™×ª ××ª×' from ['×©×œ×•×!', '×× ×¢×•×œ×Ÿ', '×¢×™×¨', '×’×¨×™×¢×ª', '×˜×™×¨×”', '××•×§×™×™,', '×§×¨×™×™×ª ××ª×.', '×§×¨×™×™×ª ××ª×']
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (46ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 8.5s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=135360 | silence_ms=5831
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=305.0 > threshold=122.1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 900 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [PIPELINE STATUS] sent=410 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=3980.0 > threshold=122.1
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=7514, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.8s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=12480 | silence_ms=507
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5W0zbokO2YZq...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5W0zbokO2YZq... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1000 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 8345ms gap between chunks #57 and #58 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=28, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×›×Ÿ' (len=2)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED Hebrew: '×›×Ÿ'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×›×Ÿ' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (9314ms)
prosaas-backend  | [STT_FINAL] '×›×Ÿ' (from raw: '×›×Ÿ...')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.00s (461 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×›×Ÿ
prosaas-backend  | âš ï¸ [BUILD 186] INCOHERENT: Response '×›×Ÿ' doesn't match city question
prosaas-backend  | ğŸ”„ [BUILD 186] Marked incoherent response - AI will ask for clarification
prosaas-backend  | âœ… [BUILD 176] User CONFIRMED with '×›×Ÿ' - verification_confirmed = True
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×›×Ÿ...'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×›×Ÿ...'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 10
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×× ×™ ×¦×¨×™×š ×‘×‘×§×©×” ×”×ª×§× ×ª ×× ×¢×•×œ×Ÿ ×× ×¢×•×œ ×—×›×.', '×’×¨×™×¢×ª ×¢×ª×”.', '×œ×.', '×§×¨×™×™×ª ××ª×.', '×›×Ÿ']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: c047a19c...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (39994f9b â†’ c047a19c) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=c047a19c...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×›×Ÿ...'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...âœ… [SMART HANGUP] All required fields collected: city=×§×¨×™×™×ª ××ª×, service_type=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | âœ… [BUILD 163] Lead captured AND confirmed - closing call
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (lead_captured + confirmed)
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | 
prosaas-backend  | ğŸ” [NLP] Conversation history has 10 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×§×¨×™×™×ª ××ª×.', 'ts': 1764952602.5666192}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“×â€”××ª×” ×¦×¨×™×š ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›× ×‘×¢×™×¨ ×§×¨×™×™×ª ××ª×, × ×›×•×Ÿ?', 'ts': 1764952602.9947584}, {'speaker': 'user', 'text': '×›×Ÿ', 'ts': 1764952611.8804233}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] âœ… ×”×œ×§×•×— ××™×©×¨ ××ª ×”×¤×¨×˜×™×! ×¡×™×™× ×‘×¦×•×¨×” ×× ×•××¡×ª - ×”×•×“×” ×œ×œ×§×•×— ×•×××•×¨ ×œ×”×ª×¨××•×ª.
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjT5W0zbokO2YZq...) - skipping (SERVER_EVENT:[SERVER] âœ… ×”×œ×§×•×— ××™×©×¨ ××ª ×”×¤×¨×˜×™)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | â° [FALLBACK] Starting 10s timer for lead_captured_confirmed...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 7468 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 1 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 1.53s (83 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (26ms, frames=0)
prosaas-backend  | INFO:     127.0.0.1:59690 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'confirm', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 1.0}
prosaas-backend  | âœ… [LEAD STATE] Updated: name=null
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | âœ… [NLP] Saved customer name to temporary cache: null
prosaas-backend  | ğŸ¯ [NLP] âœ… Detected action=confirm, date=null, time=null, name=null, confidence=1.0
prosaas-backend  | ğŸ” [DEBUG] No CRM context exists yet
prosaas-backend  | 
prosaas-backend  | ================================================================================
prosaas-backend  | ğŸ¯ [APPOINTMENT FLOW] ========== CONFIRM ACTION TRIGGERED ==========
prosaas-backend  | ================================================================================
prosaas-backend  | âš ï¸ [APPOINTMENT FLOW] BLOCKED - Calendar scheduling is DISABLED for this business!
prosaas-backend  | âš ï¸ [APPOINTMENT FLOW] Informing AI to redirect customer to human representative
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: âš ï¸ ×§×‘×™×¢×ª ×ª×•×¨×™× ××•×©×‘×ª×ª. ×”×¡×‘×¨ ×œ×œ×§×•×— ×©× ×¦×™×’ ×™×—×–×•×¨ ××œ×™×• ×‘×”×§×“× ×œ×§×‘×™×¢×ª ×¤×’×™×©×”.
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (APPOINTMENT:âš ï¸ ×§×‘×™×¢×ª ×ª×•×¨×™× ××•×©×‘×ª×ª. ×”×¡×‘×¨ ×œ×œ)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '××œ×™×š' differs from locked '×§×¨×™×™×ª ××ª×.'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×§×¨×™×™×ª ××ª×.' (reason: user_said_××œ×™×š)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×§×¨×™×™×ª ××ª×', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | âŒ [CITY] Rejected '××œ×™×š' (confidence=84%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP] Lead captured + confirmed + auto_end=True - disconnecting
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5Z8DllBI1GIY...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5Z8DllBI1GIY... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 2404ms gap between chunks #83 and #84 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×”×§×“× ×œ×§×‘×™×¢×ª ×¤×’×™×©×”. ×ª×•×“×” ×¨×‘×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.00s (106 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (7ms, frames=0)
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '××œ×™×š' (majority 2/2)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=××œ×™×š
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '×§×¨×™×™×ª ××ª×', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=××œ×™×š
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '××œ×™×š' from ['×©×œ×•×!', '×× ×¢×•×œ×Ÿ', '×¢×™×¨', '×’×¨×™×¢×ª', '×˜×™×¨×”', '××•×§×™×™,', '×§×¨×™×™×ª ××ª×.', '×§×¨×™×™×ª ××ª×', '××œ×™×š', '××œ×™×š']
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×”×§...'
prosaas-backend  | âœ… [HANGUP] User said goodbye, AI responded politely - disconnecting
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 338 frames...
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 338 frames...
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 338 frames...
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (5ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 287 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 287 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 287 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 1200 frames (rms=8, reason=noise)
prosaas-backend  | WS_STOP sid=MZfa1315cf34432547c5f5f5fd2f23ec89 rx=2615 tx=1398
prosaas-backend  | ğŸ“ [SES-e4455561] CALL ENDED - duration=52.2s, business_id=10, rx=2615, tx=1398
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA9dda860f41e52ae90addbe203f3964f1 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:41294 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | âœ… Found existing recording for CA9dda860f41e52ae90addbe203f3964f1: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE811312d0d3cd825e352af01156166541.json
prosaas-backend  | INFO:     172.18.0.5:41300 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CA9dda860f41e52ae90addbe203f3964f1
prosaas-backend  | INFO:     connection closed
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | âœ… [FALLBACK] pending_hangup already set - normal flow working
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | âœ… Resolved business_id=10 from to_number=+97233762734 (Business: ×§×œ×™×‘×¨)
prosaas-backend  | [WA-SESSION] ğŸ“± Check #3: Found 0 stale sessions to process
prosaas-backend  | âœ… call_log created immediately for CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Starting thread to create lead for +972504294724, call_sid=CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | ğŸ”µ CREATE_LEAD_FROM_CALL - Starting for +972504294724, call_sid=CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | ğŸŸ¢ INCOMING_CALL - Thread started successfully
prosaas-backend  | âœ… incoming_call: 1327ms - CA3097a94d833defğŸ”µ CREATE_LEAD_FROM_CALL - App context created
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ TWIML_HOST=prosaas.pro
prosaas-backend  | ğŸ”¥ TWIML_WS=wss://prosaas.pro/ws/twilio-media
prosaas-backend  | ğŸ”¥ TWIML_FULL=<?xml version="1.0" encoding="UTF-8"?><Response><Connect action="https://prosaas.pro/webhook/stream_ended"><Stream url="wss://prosaas.pro/ws/twilio-media"><Parameter name="CallSid" value="CA3097a94d833defefa7a93813a4bf1412" /><Parameter name="To" value="+97233762734" /></Stream></Connect></Response>
prosaas-backend  | INFO:     172.18.0.5:45446 - "POST /webhook/incoming_call HTTP/1.1" 200 OK
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZfa1315cf34432547c5f5f5fd2f23ec89 rx=2615 tx=1398
prosaas-backend  | âœ… CALL FINALIZED: CA9dda860f41e52ae90addbe203f3964f1
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×”×¤× ×™×™×” ×”×™× ×‘×ª×—×•× ×©×™×¨×•×ª×™ ×”×× ×¢×•×œ× ×•×ª, ×‘××™×•×—×“ ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | - **××™×§×•×**: ×§×¨×™×™×ª ××ª×
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | - **×©× ×”×œ×§×•×—**: ×œ× × ××¡×¨
prosaas-backend  | - **×××¦×¢×™ ×”×ª×§×©×¨×•×ª**: ×œ× × ××¡×¨
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×”**: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×”×§×“× ×œ×§×‘×™×¢×ª ×¤×’×™×©×”.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×‘×™× ×•× ×™×ª (×”×œ×§×•×— ××¢×•× ×™×™×Ÿ ×‘×©×™×¨×•×ª ×‘×”×§×“×).
prosaas-backend  | - **×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª**: ×™×© ×œ×•×•×“× ×©×”×‘×¢×œ ××§×¦×•×¢ ×™×™×¦×•×¨ ×§×©×¨ ×¢× ×”×œ×§×•×— ×‘×”×§×“×.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×—×©×•×‘ ×œ×•×•×“× ×©×”×œ×§×•×— ××§×‘×œ ××ª ×”×©×™×¨×•×ª ×”× ×“×¨×© ×‘×–××Ÿ, ×•×œ×‘×¨×¨ ×× ×™×© ×“×¨×™×©×•×ª × ×•×¡×¤×•×ª ××• ×©××œ×•×ª ×‘× ×•×’×¢ ×œ×× ×¢×•×œ ×”×—×›×.
prosaas-backend  | ğŸ¯ Intent: meeting_request
prosaas-backend  | ğŸ“Š Next Action: ×ª×™××•× ×¤×’×™×©×” ×“×—×•×£
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | INFO:     172.18.0.5:45458 - "WebSocket /ws/twilio-media" [accepted]
prosaas-backend  | INFO:     connection open
prosaas-backend  | ğŸ¯ AI CONVERSATION STARTED
prosaas-backend  | ğŸ”µ [CALL] run() started - waiting for START event...
prosaas-backend  | ğŸ¯ [CALL DEBUG] START EVENT RECEIVED! session=SES-8b28a6b1
prosaas-backend  | 
prosaas-backend  | ğŸ“ START EVENT (customParameters path):
prosaas-backend  |    customParams.From: None
prosaas-backend  |    customParams.CallFrom: None
prosaas-backend  |    âœ… self.phone_number set to: 'None'
prosaas-backend  |    âœ… self.to_number set to: '+97233762734'
prosaas-backend  | ğŸ¯ [T0=1764952625.574] WS_START sid=MZb881b5f120afc72864aa055f400c92f3 call_sid=CA3097a94d833defefa7a93813a4bf1412 from=None to=+97233762734 mode=AI
prosaas-backend  | ğŸš€ [PARALLEL] Starting OpenAI at T0+0ms (BEFORE DB query!)
prosaas-backend  | ğŸš€ [REALTIME] Thread started for call CA3097a9 (FRESH SESSION)âš¡ ULTRA-FAST: ×–×™×”×•×™ ×¢×¡×§ + ×‘×¨×›×” + ×”×’×“×¨×•×ª ×‘×©××™×œ×ª×” ××—×ª: to_number=+97233762734
prosaas-backend  | 
prosaas-backend  | ğŸš€ [REALTIME] Async loop starting - connecting to OpenAI IMMEDIATELY
prosaas-backend  | â±ï¸ [PARALLEL] Client created in 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â±ï¸ [PARALLEL] OpenAI connected in 473ms (T0+474ms)
prosaas-backend  | â³ [PARALLEL] Waiting for business info from DB query...
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA9dda860f41e52ae90addbe203f3964f1, phone=+972504294724, city=××œ×™×š, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=××œ×™×š, service=×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×
prosaas-backend  | 
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | âœ… ××¦× ×¢×¡×§: ×§×œ×™×‘×¨ (id=10)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] is_playing_greeting=True (early, blocking audio input)
prosaas-backend  | âš¡ BUILD 172: CallConfig loaded in 1049ms
prosaas-backend  |    bot_speaks_first=True, auto_end_goodbye=True
prosaas-backend  |    auto_end_lead=True, silence_timeout=15s
prosaas-backend  | ğŸ” [CONFIG] required_lead_fields=['city', 'service_type']
prosaas-backend  | ğŸ” [CONFIG] smart_hangup_enabled=True
prosaas-backend  | âš¡ DB QUERY: business_id=10 in 1153ms
prosaas-backend  | ğŸ”§ DB_URL_AT_WRITE: driver=postgresql, BIZ=10, SID=CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | ğŸ”Š TX_LOOP_START: Audio transmission thread started
prosaas-backend  | ğŸ¯ [T1=1764952626.729] STORING GREETING FOR REALTIME!
prosaas-backend  | âœ… [REALTIME] Greeting stored: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...' (len=50)
prosaas-backend  | ğŸš€ [PARALLEL] Signaling business info ready at T0+1155ms
prosaas-backend  | ğŸ›¡ï¸ [GREETING PROTECT] Blocking audio ENQUEUE - greeting in progress
prosaas-backend  | ğŸ›ï¸ VAD CALIBRATED (noise=8.3, threshold=108.3)
prosaas-backend  | âœ… [PARALLEL] Business info ready! Wait time: 683ms
prosaas-backend  | â±ï¸ [PARALLEL] Using greeting: '×©×œ×•×! ×–×” ×-××ª×¨  ×”-×× ×¢×•×œ×Ÿ ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š ?...'
prosaas-backend  | ğŸ¤ [VOICE] Using voice=ash for entire call (business=10)
prosaas-backend  | ğŸ¤ [GREETING] max_tokens=4096 for greeting length=50 chars (direction=inbound)
prosaas-backend  | âœ… Call log already exists for CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | âœ… Recording started for CA3097a94d833defefa7a93813a4bf1412: RE33b6238cc99863854769a4069019c4d9
prosaas-backend  | ğŸ¤ [BUILD 204] Dynamic STT prompt: '×ª××œ×œ ×¢×‘×¨×™×ª ×‘×©×™×—×” ×˜×œ×¤×•× ×™×ª. ×¢×¡×§: ×§×œ×™×‘×¨. ××™×œ×™×: ×× ×¢×•×œ×Ÿ, ×× ×¢×•×œ ×—×›×, ×¤×•×¨×¥ ×“×œ×ª×•×ª. ×¨×§ ×ª××œ×œ, ×œ× ×œ×”×•×¡×™×£.' (95 chars)
prosaas-backend  | â±ï¸ [PHASE 1] Session configured in 1086ms (total: 2243ms)
prosaas-backend  | âœ… [REALTIME] FAST CONFIG: greeting prompt ready, voice=ash
prosaas-backend  | ğŸ¤ [GREETING] Bot speaks first - triggering greeting at 1764952627.818
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (GREETING)
prosaas-backend  | ğŸ¯ [BUILD 200] GREETING response.create sent! OpenAI time: 2243ms
prosaas-backend  | âš ï¸ [CRM] No customer phone or lead_id - skipping lead creation
prosaas-backend  | [PIPELINE] LIVE AUDIO PIPELINE ACTIVE: Twilio â†’ realtime_audio_in_queue â†’ send_audio_chunk (single path)
prosaas-backend  | ğŸ“¥ [REALTIME] Audio receiver started
prosaas-backend  | ğŸ“ [REALTIME] Text sender started
prosaas-backend  | âœ… CustomerIntelligence SUCCESS: customer_id=7, lead_id=79, was_created=False
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5ntp79xrwsZD...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5ntp79xrwsZD... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | [TX_LOOP] Frame 0: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 1: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | [TX_LOOP] Frame 2: type=None, event=media, has_media=True
prosaas-backend  | [TX_LOOP] Sent Realtime format: success=True
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ“ [PROMPT] Final length: 2367 chars
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | âœ… Updated call_log with customer_id=7
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | â³ [PHASE 2] Waiting for greeting to finish before session.update...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | [GREETING] Passing greeting audio to caller (greeting_sent=True, user_has_spoken=False)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ¤ [GREETING] Greeting finished at 1764952629.428 (duration: 1610ms)
prosaas-backend  | âœ… [GREETING] Barge-in now ENABLED for rest of call
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Greeting completed - hangup blocked for 3000ms
prosaas-backend  | â³ [BUILD 303] Waiting for user's first response to greeting...
prosaas-backend  | ğŸ“ [STATE] Transitioned WARMUP â†’ ACTIVE (greeting done)
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ, ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (30ms, frames=0)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5pEdlxyvtYFH...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5pEdlxyvtYFH... status=in_progress modalities=['text', 'audio'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 15150ms gap between chunks #106 and #107 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Ignoring AI goodbye - only 1643ms since greeting
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ, ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.doneğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | 
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”‡ [SILENCE] Monitor started (timeout=15s, max_warnings=2)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [PHASE 2] Greeting finished after 2.0s - now updating session
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (15ms, frames=0)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 40 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.80s (121 chunks)
prosaas-backend  | ğŸ“ [INBOUND] session.update with max_tokens=4096
prosaas-backend  | âœ… [PHASE 2] Session updated: 2367 chars, voice=ash, max_tokens=4096, stt=gpt-4o-transcribe+Hebrew
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=40, tx_q=249) retry #10
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '×©×œ×•×!' differs from locked '××œ×™×š'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '××œ×™×š' (reason: user_said_×©×œ×•×!)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '××œ×™×š', 'raw_city': '××œ×™×š', 'city_confidence': '100.0', 'service_type': '×”×ª×§× ×ª ×× ×¢×•×œ ×—×›×', 'city_needs_confirmation': 'True', 'city_autocorrected': 'True', 'name': 'null'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ. ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [AUDIO] 40 frames still in queue - letting them play (NO TRUNCATION)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 100 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=9, voice_frames=0
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=40, tx_q=249) retry #20
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 200 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=False, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=4271.0 > threshold=108.3
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#1, Î¼-law bytes=160, first5=be b3 ad a8 a5, rms=9931, consec_frames=3
prosaas-backend  | [PIPELINE STATUS] sent=1 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#2, Î¼-law bytes=160, first5=22 20 23 2c 4c, rms=5577, consec_frames=4
prosaas-backend  | [REALTIME] sending audio TO OpenAI: chunk#3, Î¼-law bytes=160, first5=cc c3 bd b7 b6, rms=3278, consec_frames=5
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #1 (prevents 5min timeout)
prosaas-backend  | ğŸ›¡ï¸ [PROTECTION] Waiting for audio (ai=False, oai_q=40, tx_q=249) retry #30
prosaas-backend  | âš ï¸ [BUILD 178] Max hangup retries exceeded - forcing hangup
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2315, voice_frames=0
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.5s audio, conversation #0
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=23680 | silence_ms=501
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT5wU7EggFdhrs...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT5wU7EggFdhrs... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×¤×•×¨×¥ ×œ×¨×›×‘.' (len=10)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×¤×•×¨×¥ ×œ×¨×›×‘.' â†’ '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (corrections: {'×¤×•×¨×¥': '×¤×•×¨×¥ ×“×œ×ª×•×ª'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....' despite low RMS=8)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #1: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew_chars=13)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (hebrew=13, english=0)
prosaas-backend  | [STT_FINAL] '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.' (from raw: '×¤×•×¨×¥ ×œ×¨×›×‘....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.04s (85 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.
prosaas-backend  | âœ… [BUILD 303] First post-greeting utterance: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....' - processing as answer to greeting question
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×“×œ×ª×•×ª' (confidence=46%) - ask to repeat
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 2
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: 88821b8e...
prosaas-backend  | ğŸ” [DEBUG] First NLP run - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=88821b8e...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['city', 'service_type'] | Collected: []
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 2 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'ai', 'text': '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ, ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?', 'ts': 1764952629.42831}, {'speaker': 'user', 'text': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952637.269807}]
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#1, bytes=800, first5=e6 dd de de e0
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#2, bytes=1200, first5=4c 4a 4c 49 49
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=9, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | [REALTIME] got audio chunk from OpenAI: chunk#3, bytes=2000, first5=c0 bd c5 f9 b3
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.24s (6 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (64ms, frames=0)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True'}
prosaas-backend  | âŒ [CITY] Rejected '×¢×™×¨' (confidence=54%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 300 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=864.0 > threshold=108.3
prosaas-backend  | [PIPELINE STATUS] sent=86 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=9947, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=24, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 1.4s audio, conversation #1
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=21760 | silence_ms=515
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #1
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT62WgQHVzVtEw...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT62WgQHVzVtEw... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 4652ms gap between chunks #6 and #7 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=29, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×‘×™×ª ×©××Ÿ.' (len=8)
prosaas-backend  | ğŸ”§ [BUILD 204] Vocabulary fix: '×‘×™×ª ×©××Ÿ.' â†’ '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.' (corrections: {'×‘×™×ª': '×‘×™×ª ×©××Ÿ', '×©××Ÿ': '×‘×™×ª ×©××Ÿ'})
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ....' despite low RMS=28)
prosaas-backend  | âœ… [BUILD 303 PATIENCE] Bypassing gibberish check for utterance #2: '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.' (hebrew_chars=12)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.' (hebrew=12, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (5397ms)
prosaas-backend  | [STT_FINAL] '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.' (from raw: '×‘×™×ª ×©××Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.04s (164 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | INFO:     127.0.0.1:50802 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×‘×™×ª ×©××Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×‘×™×ª ×©××Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×™×ª ×©××Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [CITY] Auto-accepted: '×‘×™×ª ×©××Ÿ' (confidence=100%)
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 4
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: ff07d534...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (88821b8e â†’ ff07d534) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=ff07d534...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | â³ [SMART HANGUP] Still missing fields: ['service_type'] | Collected: ['city=×‘×™×ª ×©××Ÿ']
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | ğŸ” [NLP] Conversation history has 4 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', 'ts': 1764952637.269807}, {'speaker': 'ai', 'text': '×•×‘××™×–×• ×¢×™×¨ ××ª×” × ××¦×?', 'ts': 1764952637.9714782}, {'speaker': 'user', 'text': '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.', 'ts': 1764952642.6665797}]
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | âš ï¸ [AUDIO GAP] 683ms gap between chunks #8 and #9 - OpenAI delay!
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 6936 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ, × ×›×•×Ÿ?
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.92s (21 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (24ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 0.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | 
prosaas-backend  | ğŸ”’ [CONSISTENCY] City locked to '×‘×™×ª ×©××Ÿ' (majority 2/3)
prosaas-backend  | âœ… [LEAD STATE] Updated: city=×‘×™×ª ×©××Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: raw_city=×‘×‘×™×ª ×©××Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_confidence=100.0
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0'}
prosaas-backend  | âœ… [LEAD STATE] Updated: city_autocorrected=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True'}
prosaas-backend  | ğŸ”’ [CITY] Majority locked: '×‘×™×ª ×©××Ÿ' from ['×©×œ×•×!', '×“×œ×ª×•×ª', '×¢×™×¨', '×‘×™×ª ×©××Ÿ', '×‘×‘×™×ª ×©××Ÿ']
prosaas-backend  | âœ… [LEAD STATE] Updated: service_type=×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ'}
prosaas-backend  | âœ… [LEAD STATE] Extracted service_type from confirmation: ×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×ª ×¨×›×‘ ...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (17ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 400 frames (rms=8, reason=noise)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 249 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=399.0 > threshold=108.3
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #2 (prevents 5min timeout)
prosaas-backend  | [PIPELINE STATUS] sent=165 blocked=0 | active_response=None... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=2851, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_started
prosaas-backend  | ğŸ¤ [REALTIME] User started speaking - setting user_has_spoken=True
prosaas-backend  | âœ… [LOOP GUARD] User started speaking - resetting consecutive counter (1 -> 0)
prosaas-backend  | ğŸ¤ [BUILD 166] Noise gate BYPASSED - sending ALL audio to OpenAI
prosaas-backend  | ğŸ¤ END OF UTTERANCE: 0.8s audio, conversation #2
prosaas-backend  | ğŸ§  STATE -> PROCESSING | len=13440 | silence_ms=509
prosaas-backend  | â­ï¸ [REALTIME] Skipping Google STT/TTS - using Realtime API only
prosaas-backend  | âœ… Processing complete for conversation #2
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [REALTIME] event: input_audio_buffer.speech_stopped
prosaas-backend  | ğŸ¤ [BUILD 166] Speech ended - noise gate RE-ENABLED
prosaas-backend  | [REALTIME] event: input_audio_buffer.committed
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT69ieMzUP4qOc...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT69ieMzUP4qOc... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 500 frames (rms=8, reason=noise)
prosaas-backend  | [REALTIME] event: conversation.item.input_audio_transcription.completed
prosaas-backend  | [STT_RAW] '×›×Ÿ.' (len=3)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | [SILENCE GATE] âœ… TRUSTED (OpenAI heard '×›×Ÿ....' despite low RMS=8)
prosaas-backend  | âœ… [NOISE FILTER] ALLOWED (has Hebrew): '×›×Ÿ.'
prosaas-backend  | [NOISE FILTER] âœ… ACCEPTED: '×›×Ÿ.' (hebrew=2, english=0)
prosaas-backend  | ğŸ“ [SEGMENT MERGE] FLUSH - long pause (7671ms)
prosaas-backend  | [STT_FINAL] '×›×Ÿ.' (from raw: '×›×Ÿ....')
prosaas-backend  | ğŸ’° [COST] User utterance: 2.09s (220 chunks total)
prosaas-backend  | ğŸ‘¤ [REALTIME] User said: ×›×Ÿ.
prosaas-backend  | âœ… [BUILD 176] User CONFIRMED with '×›×Ÿ.' - verification_confirmed = True
prosaas-backend  | ğŸ” [DEBUG] Calling NLP after user transcript: '×›×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] _check_appointment_confirmation called with transcript: '×›×Ÿ....'
prosaas-backend  | ğŸ” [DEBUG] Conversation history length: 6
prosaas-backend  | ğŸ” [DEBUG] User messages for hash: ['×¤×•×¨×¥ ×“×œ×ª×•×ª ×œ×¨×›×‘.', '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.', '×›×Ÿ.']
prosaas-backend  | ğŸ” [DEBUG] Current conversation hash: e8642455...
prosaas-backend  | ğŸ” [DEBUG] Hash changed (ff07d534 â†’ e8642455) - processing
prosaas-backend  | ğŸ” [NLP] âœ… WILL PROCESS new conversation state (hash=e8642455...)
prosaas-backend  | ğŸ” [DEBUG] CRM context exists: False
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×›×Ÿ....'ğŸ” [NLP] â–¶ï¸ Analyzing conversation for appointment intent...
prosaas-backend  | 
prosaas-backend  | ğŸ” [DEBUG] _check_lead_captured: required_fields from self = ['city', 'service_type']
prosaas-backend  | âœ… [SMART HANGUP] All required fields collected: city=×‘×™×ª ×©××Ÿ, service_type=×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ
prosaas-backend  | ğŸ” [NLP] Conversation history has 6 messages
prosaas-backend  | ğŸ” [NLP] Last 3 messages: [{'speaker': 'user', 'text': '×‘×™×ª ×©××Ÿ ×‘×™×ª ×©××Ÿ.', 'ts': 1764952642.6665797}, {'speaker': 'ai', 'text': '×¨×§ ××•×•×“× â€“ ××ª×” ×¦×¨×™×š ×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ, × ×›×•×Ÿ?', 'ts': 1764952643.5406744}, {'speaker': 'user', 'text': '×›×Ÿ.', 'ts': 1764952650.338038}]
prosaas-backend  | âœ… [BUILD 163] Lead captured AND confirmed - closing call
prosaas-backend  | ğŸ“ [STATE] Transitioning ACTIVE â†’ CLOSING (lead_captured + confirmed)
prosaas-backend  | [SAFETY] Transcription successful (total failures: 0)
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 6806ms gap between chunks #21 and #22 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”‡ [SERVER_EVENT] Sent SILENTLY to AI: [SERVER] âœ… ×”×œ×§×•×— ××™×©×¨ ××ª ×”×¤×¨×˜×™×! ×¡×™×™× ×‘×¦×•×¨×” ×× ×•××¡×ª - ×”×•×“×” ×œ×œ×§×•×— ×•×××•×¨ ×œ×”×ª×¨××•×ª.
prosaas-backend  | â¸ï¸ [RESPONSE GUARD] Active response in progress (resp_CjT69ieMzUP4qOc...) - skipping (SERVER_EVENT:[SERVER] âœ… ×”×œ×§×•×— ××™×©×¨ ××ª ×”×¤×¨×˜×™)
prosaas-backend  | â¸ï¸ [SERVER_EVENT] Response blocked by trigger_response guards
prosaas-backend  | â° [FALLBACK] Starting 10s timer for lead_captured_confirmed...
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=8, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5868 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ××œ×™×š ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª. ×ª×•×“×” ×•×œ×”×ª×¨××•×ª.
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.93s (45 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (16ms, frames=0)
prosaas-backend  | ğŸ” [NLP] â—€ï¸ NLP result: {'action': 'none', 'date': 'null', 'time': 'null', 'name': 'null', 'phone': 'null', 'confidence': 1.0}
prosaas-backend  | ğŸ“­ [NLP] No appointment action detected (action=none)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 600 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ”„ [CONSISTENCY] User correction detected: '××œ×™×š' differs from locked '×‘×™×ª ×©××Ÿ'
prosaas-backend  | ğŸ”“ [CONSISTENCY] City UNLOCKED from '×‘×™×ª ×©××Ÿ' (reason: user_said_××œ×™×š)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '××œ×™×š' (confidence=84%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] Clear goodbye detected: '××¦×•×™×Ÿ, ×§×™×‘×œ×ª×™. ×‘×¢×œ ××§×¦×•×¢ ××ª××™×...'
prosaas-backend  | âœ… [HANGUP] Lead captured + confirmed + auto_end=True - disconnecting
prosaas-backend  | ğŸ“ [BUILD 163] Pending hangup set - will disconnect after audio finishes playing
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 159 frames...
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (11ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 108 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 58 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 700 frames (rms=8, reason=noise)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 7 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 3200ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 800 frames (rms=8, reason=noise)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | ğŸ“ [BUILD 163] Audio playback complete - triggering polite hangup now
prosaas-backend  | ğŸ“ [BUILD 303] SMART HANGUP - Scheduling goodbye before disconnect...
prosaas-backend  | ğŸ¯ [BUILD 200] response.create triggered (SILENCE_HANDLER:[SYSTEM] ×”×©×™×—×” ××¡×ª×™×™××ª. ×××•×¨: )
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.created: id=resp_CjT6JhsFqGy3GNn...
prosaas-backend  | ğŸ¯ [RESPONSE.CREATED] id=resp_CjT6JhsFqGy3GNn... status=in_progress modalities=['audio', 'text'] output_format=g711_ulaw
prosaas-backend  | ğŸ’“ WS_KEEPALIVE #3 (prevents 5min timeout)
prosaas-backend  | ğŸ™ï¸ REAL_VOICE: rms=154.0 > threshold=108.3
prosaas-backend  | [PIPELINE STATUS] sent=221 blocked=0 | active_response=resp_CjT6JhsFqG... | ai_speaking=False | barge_in=False
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.added
prosaas-backend  | [REALTIME] event: conversation.item.created
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.added
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1068 bytes
prosaas-backend  | ğŸ”Š [REALTIME] AI started speaking (audio.delta)
prosaas-backend  | âš ï¸ [AUDIO GAP] 8196ms gap between chunks #45 and #46 - OpenAI delay!
prosaas-backend  | ğŸ”§ [GAP RECOVERY] Inserted 25 silence frames (500ms)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking audio - AI speaking (rms=12, frames=0/5)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 1600 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.delta
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 2668 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.delta: 5336 bytes
prosaas-backend  | ğŸ”Š [REALTIME] response.audio.done
prosaas-backend  | ğŸ”‡ [REALTIME] AI stopped speaking (response.audio.done)
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | ğŸ”Š [REALTIME] response.audio_transcript.done
prosaas-backend  | ğŸ¤– [REALTIME] AI said: ×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ, ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?
prosaas-backend  | âš ï¸ [LOOP DETECT] AI repeating! Similarity=100% with: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ, ××™×–×” ×¡×•×’ ×©×™×¨×•×ª ××ª×” ×¦×¨×™×š?...'
prosaas-backend  | â­ï¸ [LOOP GUARD] Skipped - call is ending (closing=True, hangup=False)
prosaas-backend  | ğŸ’° [COST] AI utterance: 0.83s (60 chunks)
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (27ms, frames=0)
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=14, voice_frames=0
prosaas-backend  | ğŸ”‡ [AUDIO GATE] Blocked 900 frames (rms=8, reason=noise)
prosaas-backend  | âœ… [LEAD STATE] Updated: city_needs_retry=True
prosaas-backend  | ğŸ“‹ [LEAD STATE] Current state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ'}
prosaas-backend  | âŒ [CITY] Rejected '×©×œ×•×!' (confidence=70%) - ask to repeat
prosaas-backend  | [GOODBYE CHECK] No goodbye phrase: '×©×œ×•×! ×–×” ×××ª×¨ ×”×× ×¢×•×œ×Ÿ, ××™×–×” ×¡×•...'
prosaas-backend  | ğŸ”Š [REALTIME] response.content_part.done
prosaas-backend  | ğŸ”Š [REALTIME] response.output_item.done
prosaas-backend  | ğŸ”¥ [BUILD 171] AI finished speaking - cooldown started (800ms)
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 89 frames...
prosaas-backend  | â³ [POLITE HANGUP] Starting wait for audio to finish...
prosaas-backend  | âœ… [POLITE HANGUP] OpenAI queue empty after 0ms
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 89 frames...
prosaas-backend  | ğŸ”Š [REALTIME] response.done: status=completed, output_count=1, details=None
prosaas-backend  |    output[0]: type=message, content_types=['audio']
prosaas-backend  | [REALTIME] event: rate_limits.updated
prosaas-backend  | âœ… [FALLBACK] pending_hangup already set - normal flow working
prosaas-backend  | ğŸ›¡ï¸ [ECHO GATE] Blocking - echo decay (9ms, frames=0)
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 38 frames...
prosaas-backend  | â³ [POLITE HANGUP] TX queue still has 38 frames...
prosaas-backend  | ğŸ” [BARGE-IN DEBUG] is_ai_speaking=False, user_has_spoken=True, waiting_for_dtmf=False, rms=8, voice_frames=0
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 1800ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | âœ… [POLITE HANGUP] Twilio TX queue empty after 1800ms
prosaas-backend  | â³ [POLITE HANGUP] Queues empty, waiting 2s for network...
prosaas-backend  | WS_STOP sid=MZb881b5f120afc72864aa055f400c92f3 rx=1913 tx=1037
prosaas-backend  | ğŸ“ [SES-8b28a6b1] CALL ENDED - duration=38.2s, business_id=10, rx=1913, tx=1037
prosaas-backend  | ğŸ“¤ [REALTIME] Audio sender ended
prosaas-backend  | ğŸ“ [REALTIME] Text sender ended
prosaas-backend  | STREAM_ENDED call=CA3097a94d833defefa7a93813a4bf1412 stream=N/A status=N/A
prosaas-backend  | INFO:     172.18.0.5:53124 - "POST /webhook/stream_ended HTTP/1.1" 204 No Content
prosaas-backend  | ğŸ“ [SMART HANGUP] === CALL ENDING ===
prosaas-backend  | ğŸ“ [SMART HANGUP] Reason: AI finished speaking politely
prosaas-backend  | ğŸ“ [SMART HANGUP] Lead captured: True
prosaas-backend  | ğŸ“ [SMART HANGUP] Goodbye detected: True
prosaas-backend  | ğŸ“ [SMART HANGUP] Lead state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ'}
prosaas-backend  | ğŸ“ [SMART HANGUP] Required fields: ['city', 'service_type']
prosaas-backend  | ğŸ“ [SMART HANGUP] ===================
prosaas-backend  | âœ… [BUILD 163] Call CA3097a9... hung up successfully: AI finished speaking politely
prosaas-backend  | âœ… Found existing recording for CA3097a94d833defefa7a93813a4bf1412: /2010-04-01/Accounts/ACcd09431f076a309088b18ed1f286f32e/Recordings/RE33b6238cc99863854769a4069019c4d9.json
prosaas-backend  | ğŸ§¹ Waiting for 5 background threads...
prosaas-backend  | INFO:     172.18.0.5:53132 - "POST /webhook/call_status HTTP/1.1" 204 No Content
prosaas-backend  | âœ… Recording queued for processing: CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | INFO:     connection closed
prosaas-backend  | âš ï¸ Background thread 0 still running after timeout
prosaas-backend  | âœ… CALL FINALIZED: CA3097a94d833defefa7a93813a4bf1412
prosaas-backend  | ğŸ“ Summary: ### ×¡×•×’ ×”×¤× ×™×™×” ×•×”×ª×—×•×:
prosaas-backend  | ×œ×§×•×— ×¤× ×” ×œ×©×™×¨×•×ª×™ ×¤×¨×™×¦×ª ×“×œ×ª×•×ª ×œ×¨×›×‘, ×‘×ª×—×•× ×”×× ×¢×•×œ× ×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™× ×¡×¤×¦×™×¤×™×™×:
prosaas-backend  | - **×©×™×¨×•×ª × ×“×¨×©**: ×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | - **××™×§×•×**: ×‘×™×ª ×©××Ÿ
prosaas-backend  | 
prosaas-backend  | ### ×¤×¨×˜×™ ×”×œ×§×•×—:
prosaas-backend  | ×œ× × ××¡×¨×• ×¤×¨×˜×™ ×œ×§×•×— ×›××• ×©× ××• ×××¦×¢×™ ×”×ª×§×©×¨×•×ª.
prosaas-backend  | 
prosaas-backend  | ### ×¡×˜×˜×•×¡ ×•××¢×§×‘:
prosaas-backend  | - **×¤×¢×•×œ×”**: ×‘×¢×œ ××§×¦×•×¢ ××ª××™× ×™×—×–×•×¨ ×œ×œ×§×•×— ×‘×“×§×•×ª ×”×§×¨×•×‘×•×ª.
prosaas-backend  | - **×“×—×™×¤×•×ª**: ×’×‘×•×”×”, ×¢×§×‘ ×”×¦×•×¨×š ×”××™×™×“×™ ×‘×¤×¨×™×¦×ª ×¨×›×‘.
prosaas-backend  | 
prosaas-backend  | ### ×”×¢×¨×•×ª ×—×©×•×‘×•×ª:
prosaas-backend  | ×—×©×•×‘ ×œ×•×•×“× ×©×”×× ×¢×•×œ×Ÿ ×”××’×™×¢ ×œ×‘×™×ª ×©××Ÿ ××¦×•×™×“ ×‘×›×œ×™× ×”× ×“×¨×©×™× ×œ×¤×¨×™×¦×ª ×¨×›×‘×™×, ×•×œ×•×•×“× ×©×”×©×™×¨×•×ª ×™×™× ×ª×Ÿ ×‘××”×™×¨×•×ª ×”××¤×©×¨×™×ª ×›×“×™ ×œ×¡×¤×§ ×œ×œ×§×•×— ×¤×ª×¨×•×Ÿ ××™×™×“×™.
prosaas-backend  | ğŸ¯ Intent: general_inquiry
prosaas-backend  | ğŸ“Š Next Action: ××¢×§×‘ ×ª×•×š 24 ×©×¢×•×ª
prosaas-backend  | â„¹ï¸ Appointment handling: Managed by Agent during call (BUILD 119)
prosaas-backend  | ğŸ“± [WEBHOOK] Phone extraction debug:
prosaas-backend  |    - self.phone_number: None
prosaas-backend  |    - self.customer_phone_dtmf: NOT_SET
prosaas-backend  | âš ï¸ Background thread 4 still running after timeout
prosaas-backend  | âœ… All background threads cleanup complete
prosaas-backend  | WS_DONE sid=MZb881b5f120afc72864aa055f400c92f3 rx=1913 tx=1037
prosaas-backend  |    - call_log.from_number: +972504294724
prosaas-backend  |    - crm_context.customer_phone: NO_CRM
prosaas-backend  |    âœ“ Using CallLog from_number: +972504294724
prosaas-backend  | ğŸ¯ [WEBHOOK] Extracted SPECIFIC service from AI confirmation: '×¤×¨×™×¦×ª ×¨×›×‘'
prosaas-backend  | ğŸ“‹ [WEBHOOK] Lead capture state: {'city_needs_retry': 'True', 'city': '×‘×™×ª ×©××Ÿ', 'raw_city': '×‘×‘×™×ª ×©××Ÿ', 'city_confidence': '100.0', 'city_autocorrected': 'True', 'service_type': '×¤×¨×™×¦×ª ×¨×›×‘ ×‘×‘×™×ª ×©××Ÿ'}
prosaas-backend  | [WEBHOOK] ğŸ“¦ Payload built: call_id=CA3097a94d833defefa7a93813a4bf1412, phone=+972504294724, city=×‘×™×ª ×©××Ÿ, direction=inbound
prosaas-backend  | [WEBHOOK] Sending call.completed to http://prosaas.pro/n8n/webhook/prosaas-call-comple... (attempt 1)
prosaas-backend  | âœ… [WEBHOOK] Call completed webhook queued: phone=+972504294724, city=×‘×™×ª ×©××Ÿ, service=×¤×¨×™×¦×ª ×¨×›×‘
prosaas-backend  | [WEBHOOK] ğŸ”€ Following redirect to: https://prosaas.pro/n8n/webhook/prosaas-call-completed
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 2)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] Retrying in 3s...
prosaas-backend  | INFO:     127.0.0.1:48136 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | [WEBHOOK] Sending call.completed to https://prosaas.pro/n8n/webhook/prosaas-call-compl... (attempt 3)
prosaas-backend  | [WEBHOOK] âš ï¸ Response 404: {"code":404,"message":"The requested webhook \"POST prosaas-call-completed\" is not registered.","hint":"The workflow must be active for a production URL to run successfully. You can activate the work
prosaas-backend  | [WEBHOOK] âŒ Failed after 3 attempts
prosaas-backend  | INFO:     127.0.0.1:58054 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:58646 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:49378 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | ğŸ” AUTH DEBUG: user_id=10, role=owner, business_id=10, computed_tenant=10, impersonating=False
prosaas-backend  | ğŸ”” /api/notifications - tenant_id=10, g.tenant=10
prosaas-backend  | ğŸ”” Querying reminders for tenant_id=10, is_system_admin=False
prosaas-backend  | ğŸ”” Found 0 reminders
prosaas-backend  | INFO:     172.18.0.5:46304 - "GET /api/notifications HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:43770 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:35096 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:48474 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:46314 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:58510 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | [WA-SESSION] ğŸ“± Check #4: Found 0 stale sessions to process
prosaas-backend  | INFO:     127.0.0.1:59072 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:43840 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:59852 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:43110 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:48060 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:36378 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:45568 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:40154 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:54068 - "GET /health HTTP/1.1" 200 OK
prosaas-backend  | INFO:     127.0.0.1:46462 - "GET /health HTTP/1.1" 200 OK
p