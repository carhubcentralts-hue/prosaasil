17:57:33 system    | web.1 started (pid=2912)
17:57:33 system    | baileys.1 started (pid=2911)
17:57:33 web.1     | [2025-10-05 17:57:33 +0000] [2912] [INFO] Starting gunicorn 21.2.0
17:57:33 web.1     | [2025-10-05 17:57:33 +0000] [2912] [INFO] Listening at: http://0.0.0.0:5000 (2912)
17:57:33 web.1     | [2025-10-05 17:57:33 +0000] [2912] [INFO] Using worker: eventlet
17:57:33 web.1     | [2025-10-05 17:57:33 +0000] [2945] [INFO] Booting worker wi17:57:33 baileys.1 | [BOOT] Baileys listening on 127.0.0.1:3300 pid=2911 (internal only for security)
17:57:33 web.1     | ğŸ”§ GCP credentials converted from JSON to file
17:57:33 web.1     | ğŸ”§ FE_DIST=/home/runner/workspace/server/../client/dist
17:57:33 web.1     | ğŸ”§ APP_SHA=06500b4
17:57:33 web.1     | ğŸš© APP_START {'build': 59, 'sha': '06500b4', 'fe': 'client/dist', 'time': '2025-10-05 17:57:33', 'app': 'AgentLocator-Complete', 'commit': '06500b4', 'startup_ts': 1759687053}
17:57:34 web.1     | âœ… Auth blueprints registered
17:57:34 web.1     | ğŸ”§ WebSocket: EventLet Composite WSGI + Flask WebSocket fallback
17:57:34 web.1     | ğŸ”§ REGISTERING TEST ROUTES...
17:57:34 web.1     | ğŸ”§ WebSocket routes removed from Flask - handled by wsgi.py composite
17:57:34 web.1     | ğŸ”§ TEST ROUTE REGISTERED
17:57:34 web.1     | ğŸ”§ WebSocket routes handled by EventLet WebSocketWSGI in wsgi.py
17:57:34 web.1     | ğŸ“ /ws/twilio-media â†’ EventLet WebSocketWSGI with audio.twilio.com
17:57:34 web.1     | âœ… WebSocket test route added: /test-websocket-version
17:57:34 web.1     | ğŸ” ALL REGISTERED ROUTES:
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /<path:filename>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/business/<tenant>/prompts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/admin/businesses/<int:business_id>/prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/business/current/prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt/history
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt/history
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/statuses
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/statuses
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/statuses/<int:status_id>
17:57:34 web.1     |   {'DELETE', 'OPTIONS'} /api/statuses/<int:status_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/statuses/reorder
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/statuses/initialize/<int:business_id>
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/auth/csrf
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/login
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/forgot
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/reset
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/logout
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/auth/me
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/auth/current
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/businesses
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/revenue
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/tenants
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads/stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/phone-numbers
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/prompts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/support/profile
17:57:34 web.1     |   {'GET', 'PUT', 'OPTIONS', 'HEAD'} /api/admin/support/prompt
17:57:34 web.1     |   {'GET', 'PUT', 'OPTIONS', 'HEAD'} /api/admin/support/phones
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads/<thread_id>/messages
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/customers
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/active
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/history
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/contracts
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/contracts
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/payments/create
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/success
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/cancel
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/success
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/fail
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/invoices/<invoice_number>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/contracts/sign
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/deals
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/deals
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/business/<int:business_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/business
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/admin/business/<int:business_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/business/<int:business_id>/change-password
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/user
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/user/<int:user_id>
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/admin/user/<int:user_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/user/<int:user_id>/change-password
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/user/<int:user_id>/toggle-status
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/businesses/<int:business_id>/impersonate
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/impersonate/exit
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/business/current
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/business/current/settings
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /webhook/incoming_call_preview
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/incoming_call
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/stream_ended
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/handle_recording
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/stream_status
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/call_status
17:57:34 web.1     |   {'GET', 'POST', 'OPTIONS', 'HEAD'} /webhook/test
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /webhook/test_media_streams_1756667590
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/calendar/appointments
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments/<int:appointment_id>
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id>
17:57:34 web.1     |   {'DELETE', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id>
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calendar/stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads/<int:lead_id>/status
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/activities
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads/<int:lead_id>/reminders
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/move
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders/<int:reminder_id>
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/reminders/<int:reminder_id>
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/reminders/due
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/bulk
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads/<int:lead_id>/message/whatsapp
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/details
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/download
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/calls/cleanup
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/stats
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/receipts
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/contracts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/view
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/download
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/view
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/download
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/status
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/qr
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/start
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/reset
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/disconnect
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/contacts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/messages
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/stats
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/prompts/<int:business_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/send
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/whatsapp/incoming
17:57:34 web.1     |   {'POST', 'OPTIONS'} /webhook/whatsapp/status
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/customers
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/activity
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /healthz
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /readyz
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /version
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /livez
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /app/admin
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /app/biz
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/admin/overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/admin/switch_business
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/admin/tenants/new
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/admin/users/new
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/admin/tenants
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/admin/users
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/whatsapp/threads
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/whatsapp/messages
17:57:34 web.1     |   {'POST', 'OPTIONS'} /ui/whatsapp/send
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/calls/active
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/calls/history
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/biz/contacts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/biz/contacts/new
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/biz/users/new
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /ui/biz/users
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/ui/login
17:57:34 web.1     |   {'GET', 'POST', 'OPTIONS', 'HEAD'} /api/ui/logout
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/tenants
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/users
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/biz/users
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/contacts
17:57:34 web.1     |   {'POST', 'OPTIONS'} /admin/impersonate/<int:business_id>
17:57:34 web.1     |   {'POST', 'OPTIONS'} /admin/stop-impersonate
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /biz/invoices
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /biz/contracts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /logout
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /unauthorized
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /test-websocket-version
17:57:34 web.1     | ğŸ” Route registration complete
17:57:34 web.1     | ğŸ”§ WebSocket routes removed from Flask - handled by wsgi.py composite
17:57:34 web.1     | âœ… Health routes handled by health_endpoints.py blueprint
17:57:34 web.1     | âœ… Factory debug route registered: /debug-factory-http
17:57:34 web.1     | âœ… /healthz route added directly to app_factory
17:57:34 web.1     | ğŸ†˜ Emergency healthz-direct route added
17:57:34 web.1     | âœ… WhatsApp routes removed - using unified only
17:57:34 web.1     | âœ… Baileys proxy routes: 0 /wa/* endpoints
17:57:34 web.1     | âœ… Legacy proxy routes: 0 /api/wa-proxy/* endpoints
17:57:34 web.1     | FE_DIST = /home/runner/workspace/client/dist mtime = 1759681679.9120133
17:57:34 web.1     | ğŸ”§ Database migrations skipped (set RUN_MIGRATIONS_ON_START=1 to enable)
17:57:34 web.1     | ğŸ”§ Server will start immediately without blocking on DB operations
17:57:34 web.1     | ğŸ”§ Warmup disabled for debugging
17:57:34 web.1     | 
17:57:34 web.1     | === URL MAP ===
17:57:34 web.1     |   {'POST', 'OPTIONS'} /admin/impersonate/<int:business_id> -> ui.admin_impersonate_business
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/business -> business_management.create_business
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/business/<int:business_id> -> business_management.get_business
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/admin/business/<int:business_id> -> business_management.update_business
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/business/<int:business_id>/change-password -> business_management.change_business_password
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses -> admin_bp.api_admin_businesses
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses -> api_adapter.admin_businesses
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/businesses/<int:business_id>/impersonate -> business_management.impersonate_business
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/overview -> admin_bp.get_business_overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt -> ai_prompt.get_business_prompt
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/admin/businesses/<int:business_id>/prompt -> ai_prompt.update_business_prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/<int:business_id>/prompt/history -> ai_prompt.get_prompt_history
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/businesses/prompts -> admin_bp.admin_businesses_prompts
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/calls -> admin_bp.api_admin_calls
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/impersonate/exit -> business_management.exit_impersonation
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/businesses -> admin_bp.api_kpis_businesses
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls -> admin_bp.api_kpis_calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/calls -> admin_bp.api_admin_kpis_calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/overview -> admin_bp.api_admin_kpis_overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/revenue -> admin_bp.api_kpis_revenue
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp -> admin_bp.api_kpis_whatsapp
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/kpis/whatsapp -> admin_bp.api_admin_kpis_whatsapp
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads -> admin_bp.admin_leads
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/leads/stats -> admin_bp.admin_leads_stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/overview -> admin_bp.api_overview
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/phone-numbers -> admin_bp.admin_phone_numbers
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/run-migrations -> run_migrations_endpoint
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/stats -> api_adapter.admin_stats
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/statuses/initialize/<int:business_id> -> status_management.initialize_default_statuses
17:57:34 web.1     |   {'GET', 'PUT', 'OPTIONS', 'HEAD'} /api/admin/support/phones -> admin_bp.admin_support_phones
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/support/profile -> admin_bp.admin_support_profile
17:57:34 web.1     |   {'GET', 'PUT', 'OPTIONS', 'HEAD'} /api/admin/support/prompt -> admin_bp.admin_support_prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/tenants -> admin_bp.api_tenants
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/tenants -> ui.api_admin_tenants_create
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/user -> business_management.create_user
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/admin/user/<int:user_id> -> business_management.get_user
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/admin/user/<int:user_id> -> business_management.update_user
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/user/<int:user_id>/change-password -> business_management.change_user_password
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/user/<int:user_id>/toggle-status -> business_management.toggle_user_status
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/admin/users -> ui.api_admin_users_create
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/auth/csrf -> auth_api.get_csrf
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/auth/current -> auth_api.get_current_user_legacy
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/forgot -> auth_api.forgot_password
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/login -> auth_api.login
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/logout -> auth_api.logout
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/auth/me -> auth_api.get_current_user
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/auth/reset -> auth_api.reset_password
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/download -> receipts_contracts.download_contract
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/contract/<contract_id>/view -> receipts_contracts.view_contract
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/download -> receipts_contracts.download_invoice
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/billing/invoice/<invoice_id>/view -> receipts_contracts.view_invoice
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/biz/users -> ui.api_biz_users_create
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/business/<tenant>/prompts -> ai_prompt.save_prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/business/current -> business_management.get_current_business
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt -> ai_prompt.get_current_business_prompt
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/business/current/prompt -> ai_prompt.update_current_business_prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/business/current/prompt/history -> ai_prompt.get_current_prompt_history
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/business/current/settings -> business_management.update_current_business_settings
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments -> calendar.get_appointments
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/calendar/appointments -> calendar.create_appointment
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calendar/appointments/<int:appointment_id> -> calendar.get_appointment
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id> -> calendar.update_appointment
17:57:34 web.1     |   {'DELETE', 'OPTIONS'} /api/calendar/appointments/<int:appointment_id> -> calendar.delete_appointment
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calendar/stats -> calendar.get_calendar_stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls -> calls.list_calls
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/details -> calls.get_call_details
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/<call_sid>/download -> calls.download_recording
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/active -> crm_bp.api_active_calls
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/calls/cleanup -> calls.cleanup_old_recordings
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/history -> crm_bp.api_call_history
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/calls/stats -> calls.get_calls_stats
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/contracts -> receipts_contracts.create_contract
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/contacts -> ui.api_crm_contacts_create
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/contracts -> crm_bp.get_contracts
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/contracts -> crm_bp.create_contract
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/contracts/sign -> crm_bp.contract_sign
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/customers -> crm_bp.api_customers
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/deals -> crm_bp.list_deals
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/deals -> crm_bp.create_deal
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/invoices/<invoice_number> -> crm_bp.get_invoice
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments -> crm_bp.get_payments
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/crm/payments/create -> crm_bp.payments_create
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/cancel -> crm_bp.paypal_cancel
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/paypal/return/success -> crm_bp.paypal_success
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/fail -> crm_bp.tranzila_fail
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/payments/tranzila/return/success -> crm_bp.tranzila_success
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads -> crm_bp.api_threads
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/crm/threads/<thread_id>/messages -> crm_bp.api_thread_messages
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/activity -> api_adapter.dashboard_activity
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/dashboard/stats -> api_adapter.dashboard_stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/customers -> intelligence.get_intelligent_customers
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/intelligence/stats -> intelligence.get_intelligence_stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads -> leads_bp.list_leads
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads -> leads_bp.create_lead
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id> -> leads_bp.get_lead_detail
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id> -> leads_bp.update_lead
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/activities -> leads_bp.get_lead_activities
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads/<int:lead_id>/message/whatsapp -> leads_bp.send_whatsapp_message
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/move -> leads_bp.move_lead_in_kanban
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders -> leads_bp.get_lead_reminders
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads/<int:lead_id>/reminders -> leads_bp.create_reminder
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/leads/<int:lead_id>/reminders/<int:reminder_id> -> leads_bp.get_reminder
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/<int:lead_id>/reminders/<int:reminder_id> -> leads_bp.update_reminder
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/leads/<int:lead_id>/status -> leads_bp.update_lead_status
17:57:34 web.1     |   {'PATCH', 'OPTIONS'} /api/leads/bulk -> leads_bp.bulk_update_leads
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/receipts -> receipts_contracts.create_receipt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/reminders/due -> leads_bp.get_due_reminders
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/statuses -> status_management.get_business_statuses
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/statuses -> status_management.create_status
17:57:34 web.1     |   {'PUT', 'OPTIONS'} /api/statuses/<int:status_id> -> status_management.update_status
17:57:34 web.1     |   {'DELETE', 'OPTIONS'} /api/statuses/<int:status_id> -> status_management.delete_status
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/statuses/reorder -> status_management.reorder_statuses
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/ui/login -> ui.api_login
17:57:34 web.1     |   {'GET', 'POST', 'OPTIONS', 'HEAD'} /api/ui/logout -> ui.api_logout
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/contacts -> whatsapp.api_wa_contacts
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/disconnect -> whatsapp.disconnect
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/messages -> whatsapp.api_wa_messages
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/prompts/<int:business_id> -> whatsapp.save_whatsapp_prompt
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/qr -> whatsapp.qr
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/reset -> whatsapp.reset
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/send -> whatsapp.send_manual_message
17:57:34 web.1     |   {'POST', 'OPTIONS'} /api/whatsapp/start -> whatsapp.start
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/stats -> whatsapp.api_wa_stats
17:57:34 web.1     |   {'GET', 'OPTIONS', 'HEAD'} /api/whatsapp/status -> whatsapp.status
17:57:34 web.1     | ================
17:57:34 web.1     | âœ… Simple SPA routes registered (no blueprint)
17:57:34 web.1     | âœ… Flask app context initialized successfully
17:57:34 web.1     | âœ… EventLet Composite WSGI ready
17:57:34 web.1     | ğŸ“ /ws/twilio-media â†’ EventLet WebSocketWSGI with audio.twilio.com
17:57:34 web.1     | ğŸŒ All other routes â†’ Flask app
17:57:52 web.1     | ğŸ” WSGI Route: GET /
17:57:52 web.1     | ğŸŒ Routing to Flask app: /
17:57:52 web.1     | ğŸ” WSGI Route: GET /assets/index-BjZJWB8C.css
17:57:52 web.1     | ğŸŒ Routing to Flask app: /assets/index-BjZJWB8C.css
17:57:52 web.1     | ğŸ” WSGI Route: GET /assets/index-CJpz_Cln.js
17:57:52 web.1     | ğŸŒ Routing to Flask app: /assets/index-CJpz_Cln.js
17:57:53 web.1     | ğŸ” WSGI Route: GET /api/auth/csrf
17:57:53 web.1     | ğŸŒ Routing to Flask app: /api/auth/csrf
17:57:53 web.1     | ğŸ” WSGI Route: GET /api/auth/me
17:57:53 web.1     | ğŸŒ Routing to Flask app: /api/auth/me
17:58:03 web.1     | ğŸ” WSGI Route: POST /api/auth/login
17:58:03 web.1     | ğŸŒ Routing to Flask app: /api/auth/login
17:58:08 web.1     | ğŸ” WSGI Route: GET /api/auth/csrf
17:58:08 web.1     | ğŸŒ Routing to Flask app: /api/auth/csrf
17:58:09 web.1     | ğŸ” WSGI Route: GET /api/admin/businesses
17:58:09 web.1     | ğŸŒ Routing to Flask app: /api/admin/businesses
17:58:09 web.1     | ğŸ” WSGI Route: GET /api/admin/leads
17:58:09 web.1     | ğŸŒ Routing to Flask app: /api/admin/leads
17:58:09 web.1     | ğŸ” WSGI Route: GET /api/admin/leads/stats
17:58:09 web.1     | ğŸŒ Routing to Flask app: /api/admin/leads/stats
17:58:09 web.1     | ğŸ” WSGI Route: GET /api/admin/phone-numbers
17:58:09 web.1     | ğŸŒ Routing to Flask app: /api/admin/phone-numbers
17:58:09 web.1     | ğŸ” WSGI Route: GET /api/admin/overview
17:58:09 web.1     | ğŸŒ Routing to Flask app: /api/admin/overview
17:58:11 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:11 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:12 web.1     | ğŸ” WSGI Route: GET /api/business/current/prompt
17:58:12 web.1     | ğŸŒ Routing to Flask app: /api/business/current/prompt
17:58:12 web.1     | CSRF-DBG cookie= kZOUFtGuo9SNbGNxYgZOpyAiEgrgXDLwq7FhQZ9dJRo header= None ct= None
17:58:12 web.1     | ğŸ” WSGI Route: GET /api/crm/threads
17:58:12 web.1     | ğŸŒ Routing to Flask app: /api/crm/threads
17:58:15 web.1     | ğŸ” WSGI Route: POST /api/whatsapp/start
17:58:15 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/start
17:58:15 baileys.1 | [business_1] ğŸš€ startSession called
17:58:15 baileys.1 | [authDir] tenant=business_1 -> normalized=business_1 -> path=/home/runner/workspace/storage/whatsapp/business_1/auth
17:58:15 baileys.1 | [business_1] ğŸ”§ Using Baileys version: [ 2, 3000, 1023223821 ]
17:58:15 baileys.1 | [business_1] ğŸ’¾ Session stored in memory with stable browser settings
17:58:15 baileys.1 | [update] business_1: { connection: 'connecting', hasQr: false, reason: undefined }
17:58:15 baileys.1 | {"level":30,"time":"2025-10-05T17:58:15.418Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","browser":["AgentLocator","Chrome","10.0"],"helloMsg":{"clientHello":{"ephemeral":{"type":"Buffer","data":[117,16,24,151,84,252,76,252,180,71,149,128,8,204,35,14,70,242,3,37,150,54,33,128,207,228,251,90,117,77,118,91]}}},"msg":"connected to WA"}
17:58:15 baileys.1 | {"level":30,"time":"2025-10-05T17:58:15.593Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","node":{"shards":[],"connectType":1,"connectReason":1,"userAgent":{"appVersion":{"primary":2,"secondary":3000,"tertiary":1023223821},"platform":14,"releaseChannel":0,"osVersion":"0.1","device":"Desktop","osBuildNumber":"0.1","localeLanguageIso6391":"en","mnc":"000","mcc":"000","localeCountryIso31661Alpha2":"US"},"webInfo":{"webSubPlatform":0},"passive":false,"pull":true,"username":972504294724,"device":47},"msg":"logging in..."}
17:58:15 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:15 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:16 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:16 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:18 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:18 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:18 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:18 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:18 baileys.1 | {"level":30,"time":"2025-10-05T17:58:18.936Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","trace":"Error: Connection Failure\n    at WebSocketClient.<anonymous> (file:///home/runner/workspace/services/whatsapp/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:730:13)\n    at WebSocketClient.emit (node:events:524:28)\n    at file:///home/runner/workspace/services/whatsapp/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:417:35\n    at Object.decodeFrame (file:///home/runner/workspace/services/whatsapp/node_modules/@whiskeysockets/baileys/lib/Utils/noise-handler.js:141:17)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","msg":"connection errored"}
17:58:18 baileys.1 | [update] business_1: { connection: 'close', hasQr: false, reason: 401 }
17:58:18 baileys.1 | [business_1] âŒ Disconnected. Reason: 401
17:58:21 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:21 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:21 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:21 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:23 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:23 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:23 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:23 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:26 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:26 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:26 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:26 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:28 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:28 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:28 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:28 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:29 web.1     | ğŸ” WSGI Route: POST /api/whatsapp/disconnect
17:58:29 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/disconnect
17:58:29 web.1     | [2025-10-05 17:58:29,615] WARNING in flask_seasurf: Forbidden (CSRF token missing or incorrect.): /api/whatsapp/disconnect
17:58:29 web.1     | ğŸ” WSGI Route: GET /api/auth/csrf
17:58:29 web.1     | ğŸŒ Routing to Flask app: /api/auth/csrf
17:58:29 web.1     | ğŸ” WSGI Route: POST /api/whatsapp/disconnect
17:58:29 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/disconnect
17:58:29 baileys.1 | [business_1] ğŸ”Œ disconnectSession called - permanent disconnect
17:58:29 baileys.1 | [business_1] ğŸ“¤ Sending logout to WhatsApp
17:58:29 baileys.1 | [business_1] âš ï¸ Logout command failed (OK if not connected): Connection Closed
17:58:29 baileys.1 | [business_1] ğŸ”š Closing socket
17:58:29 baileys.1 | [business_1] sock.end() failed TypeError: s.sock.removeAllListeners is not a function
17:58:29 baileys.1 |     at disconnectSession (/home/runner/workspace/services/whatsapp/baileys_service.js:232:14)
17:58:29 baileys.1 |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
17:58:29 baileys.1 |     at async /home/runner/workspace/services/whatsapp/baileys_service.js:85:5
17:58:29 baileys.1 | [authDir] tenant=business_1 -> normalized=business_1 -> path=/home/runner/workspace/storage/whatsapp/business_1/auth
17:58:29 baileys.1 | [business_1] ğŸ—‘ï¸ Removing all auth files from: /home/runner/workspace/storage/whatsapp/business_1/auth
17:58:29 baileys.1 | [business_1] âœ… WhatsApp disconnected and cleaned up
17:58:32 web.1     | ğŸ” WSGI Route: POST /api/whatsapp/start
17:58:32 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/start
17:58:32 baileys.1 | [business_1] ğŸš€ startSession called
17:58:32 baileys.1 | [authDir] tenant=business_1 -> normalized=business_1 -> path=/home/runner/workspace/storage/whatsapp/business_1/auth
17:58:32 baileys.1 | [business_1] ğŸ”§ Using Baileys version: [ 2, 3000, 1023223821 ]
17:58:32 baileys.1 | [business_1] ğŸ’¾ Session stored in memory with stable browser settings
17:58:32 baileys.1 | [update] business_1: { connection: 'connecting', hasQr: false, reason: undefined }
17:58:32 baileys.1 | {"level":30,"time":"2025-10-05T17:58:32.371Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","browser":["AgentLocator","Chrome","10.0"],"helloMsg":{"clientHello":{"ephemeral":{"type":"Buffer","data":[76,106,98,235,136,250,168,175,166,0,121,17,47,145,120,252,237,183,57,110,54,18,138,74,19,223,117,176,6,167,109,123]}}},"msg":"connected to WA"}
17:58:32 baileys.1 | {"level":30,"time":"2025-10-05T17:58:32.420Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","node":{"shards":[],"connectType":1,"connectReason":1,"userAgent":{"appVersion":{"primary":2,"secondary":3000,"tertiary":1023223821},"platform":14,"releaseChannel":0,"osVersion":"0.1","device":"Desktop","osBuildNumber":"0.1","localeLanguageIso6391":"en","mnc":"000","mcc":"000","localeCountryIso31661Alpha2":"US"},"webInfo":{"webSubPlatform":0},"passive":false,"pull":false,"devicePairingData":{"buildHash":{"type":"Buffer","data":[115,217,80,121,67,37,77,218,204,172,136,191,249,135,15,136]},"deviceProps":{"type":"Buffer","data":[10,12,65,103,101,110,116,76,111,99,97,116,111,114,24,1,32,0]},"eRegid":{"0":0,"1":0,"2":0,"3":213},"eKeytype":{"type":"Buffer","data":[5]},"eIdent":{"type":"Buffer","data":[162,184,209,9,225,155,97,77,237,187,124,234,0,249,80,118,133,41,236,226,60,221,129,141,35,77,129,66,110,179,73,97]},"eSkeyId":{"0":0,"1":0,"2":1},"eSkeyVal":{"type":"Buffer","data":[74,206,169,122,226,244,5,28,232,65,70,76,70,140,175,183,91,49,29,237,43,242,218,18,214,168,43,95,236,140,111,64]},"eSkeySig":{"type":"Buffer","data":[255,210,73,196,254,245,209,6,88,163,82,2,41,227,191,100,216,100,246,222,202,177,79,157,177,240,218,237,230,34,6,139,104,203,138,86,3,202,90,255,209,216,114,245,14,29,10,220,47,73,147,73,168,109,180,223,82,110,166,206,229,71,238,141]}}},"msg":"not logged in, attempting registration..."}
17:58:32 baileys.1 | [update] business_1: { connection: undefined, hasQr: true, reason: undefined }
17:58:32 baileys.1 | [business_1] ğŸ“± QR generated successfully
17:58:32 baileys.1 | [business_1] ğŸ’¾ QR saved to /home/runner/workspace/storage/whatsapp/business_1/auth/qr_code.txt
17:58:32 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:32 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:33 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:33 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:35 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:35 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:35 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:35 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:38 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:38 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:38 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:38 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:39 baileys.1 | {"level":30,"time":"2025-10-05T17:58:39.300Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","me":{"id":"972504294724:48@s.whatsapp.net","lid":"87621728518253:48@lid"},"platform":"iphone","msg":"pairing configured successfully, expect to restart the connection..."}
17:58:39 baileys.1 | [update] business_1: { connection: undefined, hasQr: false, reason: undefined }
17:58:39 baileys.1 | {"level":50,"time":"2025-10-05T17:58:39.712Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","node":{"tag":"stream:error","attrs":{"code":"515"}},"msg":"stream errored out"}
17:58:39 baileys.1 | [update] business_1: { connection: 'close', hasQr: false, reason: 515 }
17:58:39 baileys.1 | [business_1] âŒ Disconnected. Reason: 515
17:58:39 baileys.1 | [business_1] ğŸ”„ Will retry in 2 seconds...
17:58:39 baileys.1 | {"level":30,"time":"2025-10-05T17:58:39.712Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","trace":"Error: Stream Errored (restart required)\n    at WebSocketClient.<anonymous> (file:///home/runner/workspace/services/whatsapp/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:725:13)\n    at WebSocketClient.emit (node:events:524:28)\n    at file:///home/runner/workspace/services/whatsapp/node_modules/@whiskeysockets/baileys/lib/Socket/socket.js:417:35\n    at Object.decodeFrame (file:///home/runner/workspace/services/whatsapp/node_modules/@whiskeysockets/baileys/lib/Utils/noise-handler.js:141:17)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)","msg":"connection errored"}
17:58:40 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:40 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:40 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:40 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:41 baileys.1 | [business_1] ğŸš€ startSession called
17:58:43 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:43 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:43 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:43 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:45 baileys.1 | {"level":40,"time":"2025-10-05T17:58:45.185Z","pid":2911,"hostname":"3572cc25f02f","class":"baileys","msg":"Buffer timeout reached, auto-flushing"}
17:58:45 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:45 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:45 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:45 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:48 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:48 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:48 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:48 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:50 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:50 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:50 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:50 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:53 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:53 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:53 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:53 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:55 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:55 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:55 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:55 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:58:58 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:58:58 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:58:58 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:58:58 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:00 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:00 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:00 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:00 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:03 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:03 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:03 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:03 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:05 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:05 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:05 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:05 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:08 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:08 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:08 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:08 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:10 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:10 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:10 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:10 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:13 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:13 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:13 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:13 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:15 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:15 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:15 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:15 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:18 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:18 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:18 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:18 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:20 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:20 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:20 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:20 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:23 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:23 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:23 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:23 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:25 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:25 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:25 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:25 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:28 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:28 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:28 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:28 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:30 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:30 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:30 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:30 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:33 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:33 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:33 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:33 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:35 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:35 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:35 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:35 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:38 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:38 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:38 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:38 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:40 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:40 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:40 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:40 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:43 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:43 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:43 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:43 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B17:59:45 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:45 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
^[[B^[[B^[[B17:59:45 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:45 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B17:59:48 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:48 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
^[[B^[[B17:59:48 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:48 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B17:59:50 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:50 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:50 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:50 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B17:59:53 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:53 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:53 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:53 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B17:59:55 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:55 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:55 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:55 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
17:59:58 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
17:59:58 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
17:59:58 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
17:59:58 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
18:00:00 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
18:00:00 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
18:00:00 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
18:00:00 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B18:00:03 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
18:00:03 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
^[[B^[[B18:00:03 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
18:00:03 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B18:00:05 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
18:00:05 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
^[[B^[[B18:00:05 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
18:00:05 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B18:00:08 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
18:00:08 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
18:00:08 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
18:00:08 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
18:00:10 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status
18:00:10 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/status
18:00:10 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/qr
18:00:10 web.1     | ğŸŒ Routing to Flask app: /api/whatsapp/qr
18:00:13 web.1     | ğŸ” WSGI Route: GET /api/whatsapp/status